(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15452,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566),l=e.i(54858),r=e.i(47163),n=e.i(932);function i(e){let t,a,l,r,i,c,d,o,x,m,h,f=(0,n.c)(23),{friendRequestsCount:p,showFriendRequests:u,setShowFriendRequests:b,handleLogout:g,onOpenLeaderboard:j,onOpenTutorial:N}=e;return f[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("h1",{className:"text-2xl font-black text-white tracking-tighter italic",children:["Á≤æÈùàË™û ",(0,s.jsx)("span",{className:"text-indigo-500",children:"Â∞çÊà∞"})]})}),f[0]=t):t=f[0],f[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("span",{className:"text-2xl",children:"üéì"}),f[1]=a):a=f[1],f[2]!==N?(l=(0,s.jsx)("button",{onClick:N,className:"px-3 py-2 text-slate-300 hover:text-white transition-colors flex items-center gap-2",title:"ÈÅäÊà≤ÊïôÂ≠∏",children:a}),f[2]=N,f[3]=l):l=f[3],f[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)("span",{className:"text-2xl",children:"üìä"}),f[4]=r):r=f[4],f[5]!==j?(i=(0,s.jsx)("button",{onClick:j,className:"px-3 py-2 text-slate-300 hover:text-white transition-colors flex items-center gap-2",title:"ÊéíË°åÊ¶ú",children:r}),f[5]=j,f[6]=i):i=f[6],f[7]!==b||f[8]!==u?(c=()=>b(!u),f[7]=b,f[8]=u,f[9]=c):c=f[9],f[10]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)("span",{className:"text-2xl",children:"üîî"}),f[10]=d):d=f[10],f[11]!==p?(o=p>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center font-bold",children:p}),f[11]=p,f[12]=o):o=f[12],f[13]!==c||f[14]!==o?(x=(0,s.jsxs)("button",{onClick:c,className:"relative px-3 py-2 text-slate-300 hover:text-white transition-colors",children:[d,o]}),f[13]=c,f[14]=o,f[15]=x):x=f[15],f[16]!==g?(m=(0,s.jsx)("button",{onClick:g,className:"px-4 py-2 text-sm font-medium text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:"ÁôªÂá∫"}),f[16]=g,f[17]=m):m=f[17],f[18]!==m||f[19]!==l||f[20]!==i||f[21]!==x?(h=(0,s.jsxs)("nav",{className:"h-16 border-b border-slate-800 bg-[#1e293b]/80 backdrop-blur-md flex items-center justify-between px-6 flex-shrink-0 z-50",children:[t,(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[l,i,x,m]})]}),f[18]=m,f[19]=l,f[20]=i,f[21]=x,f[22]=h):h=f[22],h}var c=e.i(85333);function d(e){let t,a,l=(0,n.c)(9),{user:i,selectedAvatar:d,setShowAvatarPicker:o,openProfileEdit:x,startMatching:m,isMatching:h}=e;return l[0]!==h||l[1]!==x||l[2]!==d||l[3]!==o||l[4]!==m||l[5]!==i?(t=i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"relative group",children:(0,s.jsx)("div",{className:"w-28 h-28 bg-gradient-to-tr from-indigo-600 to-purple-400 rounded-full border-4 border-slate-900 overflow-hidden shadow-2xl transition-transform group-hover:scale-105 cursor-pointer",onClick:()=>o(!0),children:(0,s.jsx)("img",{src:d||`https://api.dicebear.com/7.x/avataaars/svg?seed=${r.AVATAR_OPTIONS[0]}`,alt:i.username,className:"w-full h-full object-cover"})})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white tracking-tight",children:i.username}),(0,s.jsx)("button",{onClick:x,className:"text-slate-500 hover:text-indigo-400 transition-colors",title:"Á∑®ËºØÂÄã‰∫∫Ë≥áÊñô",children:"‚úèÔ∏è"})]}),i.bio&&(0,s.jsx)("p",{className:"text-sm text-slate-400 mt-1 italic",children:i.bio}),(0,s.jsx)("div",{className:"mt-3 flex flex-col items-center",children:i.games_played<10?(0,s.jsxs)("div",{className:"flex items-center gap-1 relative group",children:[(0,s.jsx)("p",{className:"text-sm text-amber-400",children:"ÂÆöÁ¥ö‰∏≠"}),(0,s.jsx)("span",{className:"text-xs text-amber-500 cursor-help",children:"‚ìò"}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-3 px-4 py-2.5 bg-slate-900 text-slate-100 text-xs rounded-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap pointer-events-none z-10 shadow-xl border border-slate-700",children:(0,s.jsxs)("div",{className:"relative",children:["ÂÆåÊàê 10 Â†¥ÂÆöÁ¥öË≥ΩÂæåÂç≥ÂèØÊü•ÁúãÂàÜÊï∏",(0,s.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-px",children:(0,s.jsx)("div",{className:"border-4 border-transparent border-t-slate-900"})})]})})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,s.jsx)(c.default,{rating:i.rating||1500,size:64}),(0,s.jsxs)("p",{className:"text-sm text-slate-300",children:["Rating: ",(0,s.jsx)("span",{className:"text-amber-400 font-bold",children:i.rating||1500})]})]})}),(0,s.jsxs)("div",{className:"w-full mt-6 space-y-4",children:[(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-amber-400 mb-3 uppercase tracking-wider",children:"Á©çÂàÜÂ∞çÊà∞"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Âãù"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:i.ranked_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Êïó"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(i.ranked_games_played||0)-(i.ranked_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Á∏Ω"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:i.ranked_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Áéá"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[i.ranked_games_played>0?Math.round(i.ranked_games_won/i.ranked_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-pink-400 mb-3 uppercase tracking-wider",children:"Âç≥ÊôÇÊà∞Áï• (RTS)"}),(0,s.jsxs)("div",{className:"flex justify-center mb-2",children:[(0,s.jsx)("span",{className:"text-xs text-slate-400 mr-2",children:"Rating:"}),(0,s.jsx)("span",{className:"text-xs font-bold text-pink-400",children:i.rts_rating||"Unranked"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Âãù"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:i.rts_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Êïó"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(i.rts_games_played||0)-(i.rts_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Á∏Ω"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:i.rts_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Áéá"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[i.rts_games_played>0?Math.round(i.rts_games_won/i.rts_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-blue-400 mb-3 uppercase tracking-wider",children:"‰∏ÄËà¨Â∞çÊà∞"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Âãù"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:i.casual_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Êïó"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(i.casual_games_played||0)-(i.casual_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Á∏Ω"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:i.casual_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Áéá"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[i.casual_games_played>0?Math.round(i.casual_games_won/i.casual_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-purple-400 mb-3 uppercase tracking-wider",children:"Â•ΩÂèãÂ∞çÊà∞"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Âãù"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:i.custom_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Êïó"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(i.custom_games_played||0)-(i.custom_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Á∏Ω"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:i.custom_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Áéá"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[i.custom_games_played>0?Math.round(i.custom_games_won/i.custom_games_played*100):0,"%"]})]})]})]})]}),(0,s.jsxs)("div",{className:"w-full mt-4 space-y-3",children:[(0,s.jsxs)("button",{onClick:()=>m("ranked"),disabled:h,className:"w-full bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"üèÜ"})," Á©çÂàÜÂ∞çÊà∞"]}),(0,s.jsxs)("button",{onClick:()=>m("ranked_rts"),disabled:h,className:"w-full bg-gradient-to-r from-pink-500 to-rose-600 hover:from-pink-600 hover:to-rose-700 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"‚ö°"})," Âç≥ÊôÇÊà∞Áï• (RTS)"]}),(0,s.jsxs)("button",{onClick:()=>m("casual"),disabled:h,className:"w-full bg-slate-700 hover:bg-slate-600 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"üéÆ"})," ‰∏ÄËà¨Â∞çÊà∞"]})]})]}),l[0]=h,l[1]=x,l[2]=d,l[3]=o,l[4]=m,l[5]=i,l[6]=t):t=l[6],l[7]!==t?(a=(0,s.jsx)("section",{className:"w-80 bg-[#1e293b] border-r border-slate-800 flex flex-col p-6 flex-shrink-0 overflow-y-auto",children:(0,s.jsx)("div",{className:"flex flex-col items-center flex-1",children:t})}),l[7]=t,l[8]=a):a=l[8],a}function o(e){let t,a,l,i,c,d,o,x,m,h=(0,n.c)(23),{friends:f,onlineUsers:p,openChat:u,viewUserDetail:b,sendFriendRequest:g}=e;return h[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("span",{children:"üë•"}),h[0]=t):t=h[0],h[1]!==f.length?(a=(0,s.jsxs)("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[t," ÊàëÁöÑÂ•ΩÂèã (",f.length,")"]}),h[1]=f.length,h[2]=a):a=h[2],h[3]!==f||h[4]!==u||h[5]!==b?(l=0===f.length?(0,s.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,s.jsx)("p",{children:"ÈÇÑÊ≤íÊúâÂ•ΩÂèã"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"Âæû‰∏ãÊñπÁöÑÁ∑ö‰∏äÁî®Êà∂‰∏≠Ê∑ªÂä†Â•ΩÂèãÂêßÔºÅ"})]}):(0,s.jsx)("div",{className:"space-y-2",children:f.map(e=>(0,s.jsxs)("div",{onClick:()=>b(e.id),className:"bg-slate-800/50 p-3 rounded-xl border border-slate-700/50 hover:border-indigo-500/50 transition-all cursor-pointer relative group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-10 h-10 rounded-full border-2 border-indigo-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium text-white",children:e.username}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:e.seconds_offline<30?(0,s.jsx)("span",{className:"text-green-400",children:"‚óè Á∑ö‰∏ä"}):(0,r.formatLastOnline)(e.seconds_offline)})]})]}),(0,s.jsx)("button",{onClick:s=>{s.stopPropagation(),u(e)},className:"absolute top-2 right-2 p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-full transition-colors",title:"ËÅäÂ§©",children:"üí¨"})]},e.id))}),h[3]=f,h[4]=u,h[5]=b,h[6]=l):l=h[6],h[7]!==a||h[8]!==l?(i=(0,s.jsxs)("div",{className:"mb-8",children:[a,l]}),h[7]=a,h[8]=l,h[9]=i):i=h[9],h[10]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)("span",{children:"üåê"}),h[10]=c):c=h[10],h[11]!==p.length?(d=(0,s.jsxs)("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[c," Á∑ö‰∏äÁé©ÂÆ∂ (",p.length,")"]}),h[11]=p.length,h[12]=d):d=h[12],h[13]!==p||h[14]!==g||h[15]!==b?(o=0===p.length?(0,s.jsx)("div",{className:"text-center py-8 text-slate-500",children:(0,s.jsx)("p",{children:"ÁõÆÂâçÊ≤íÊúâÂÖ∂‰ªñÁ∑ö‰∏äÁé©ÂÆ∂"})}):(0,s.jsx)("div",{className:"space-y-2",children:p.map(e=>(0,s.jsxs)("div",{className:"w-full bg-slate-800/30 p-3 rounded-xl flex items-center gap-3 border border-slate-700/30",children:[(0,s.jsxs)("button",{onClick:()=>b(e.id),className:"flex items-center gap-3 flex-1 hover:opacity-80 transition-opacity",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-10 h-10 rounded-full border-2 border-slate-600"}),(0,s.jsxs)("div",{className:"flex-1 text-left",children:[(0,s.jsx)("p",{className:"font-medium text-white",children:e.username}),(0,s.jsx)("p",{className:"text-xs text-green-400",children:"‚óè Á∑ö‰∏ä"})]})]}),(0,s.jsx)("button",{onClick:s=>{s.stopPropagation(),g(e.id)},className:"px-3 py-1 bg-indigo-500 hover:bg-indigo-600 text-white text-sm rounded-lg transition-colors flex-shrink-0",children:"Âä†Â•ΩÂèã"})]},e.id))}),h[13]=p,h[14]=g,h[15]=b,h[16]=o):o=h[16],h[17]!==d||h[18]!==o?(x=(0,s.jsxs)("div",{children:[d,o]}),h[17]=d,h[18]=o,h[19]=x):x=h[19],h[20]!==i||h[21]!==x?(m=(0,s.jsxs)("section",{className:"w-80 flex flex-col bg-[#0f172a] p-6 overflow-y-auto border-l border-slate-800 flex-shrink-0",children:[i,x]}),h[20]=i,h[21]=x,h[22]=m):m=h[22],m}function x({user:e}){let r=(0,a.useRouter)(),[n,i]=(0,t.useState)([]);async function c(){try{let e=await (0,l.api)("/api/matchmaking/active");e.ok&&i(await e.json())}catch(e){console.error("Failed to fetch active battles:",e)}}(0,t.useEffect)(()=>{c();let e=setInterval(c,1e4);return()=>clearInterval(e)},[]);let d=n.filter(s=>e&&(s.player1_id===e.id||s.player2_id===e.id)),o=n.filter(s=>!e||s.player1_id!==e.id&&s.player2_id!==e.id),x=({battle:e,isMyBattle:t})=>(0,s.jsxs)("div",{className:`bg-slate-800/50 rounded-xl p-3 border transition-all cursor-pointer group ${t?"border-indigo-500/50 hover:border-indigo-400 hover:bg-indigo-900/20":"border-slate-700/50 hover:border-indigo-500/30 hover:bg-slate-800"}`,onClick:()=>r.push(`/battle?id=${e.id}`),children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:`text-xs px-2 py-0.5 rounded-full ${"ranked"===e.mode?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-blue-500/20 text-blue-400 border border-blue-500/30"}`,children:"ranked"===e.mode?"Á©çÂàÜÂ∞çÊà∞":"‰∏ÄËà¨Â∞çÊà∞"}),t&&(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full bg-green-500/20 text-green-400 border border-green-500/30 animate-pulse",children:"ÈÄ≤Ë°å‰∏≠"})]}),(0,s.jsx)("span",{className:"text-xs text-slate-500",children:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,s.jsx)("img",{src:e.player1_avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.player1_name}`,alt:e.player1_name,className:"w-8 h-8 rounded-full bg-slate-700"}),(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-slate-200 truncate",children:e.player1_name}),(0,s.jsx)("div",{className:"text-xs text-slate-500",children:e.player1_rating?`Rating: ${e.player1_rating}`:"Unranked"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-slate-600 font-bold text-sm",children:"VS"}),!t&&(0,s.jsx)("span",{className:"text-[10px] text-indigo-400 opacity-0 group-hover:opacity-100 transition-opacity",children:"ËßÄÊà∞"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0 justify-end text-right",children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-slate-200 truncate",children:e.player2_name}),(0,s.jsx)("div",{className:"text-xs text-slate-500",children:e.player2_rating?`Rating: ${e.player2_rating}`:"Unranked"})]}),(0,s.jsx)("img",{src:e.player2_avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.player2_name}`,alt:e.player2_name,className:"w-8 h-8 rounded-full bg-slate-700"})]})]})]});return(0,s.jsxs)("div",{className:"flex-1 bg-slate-900/50 border-x border-slate-800 flex flex-col min-w-0",children:[d.length>0&&(0,s.jsxs)("div",{className:"flex-shrink-0",children:[(0,s.jsx)("div",{className:"p-4 border-b border-slate-800 bg-indigo-900/10",children:(0,s.jsxs)("h2",{className:"text-lg font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{children:"‚öîÔ∏è"})," ÊàëÁöÑÂ∞çÊà∞"]})}),(0,s.jsx)("div",{className:"p-4 space-y-3 border-b border-slate-800",children:d.map(e=>(0,s.jsx)(x,{battle:e,isMyBattle:!0},e.id))})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,s.jsx)("div",{className:"p-4 border-b border-slate-800",children:(0,s.jsxs)("h2",{className:"text-lg font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),"Ê≠£Âú®ÈÄ≤Ë°åÁöÑÂ∞çÊà∞"]})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:0===o.length?(0,s.jsx)("div",{className:"text-center py-12 text-slate-500",children:(0,s.jsx)("p",{children:"ÁõÆÂâçÊ≤íÊúâÂÖ∂‰ªñÊ≠£Âú®ÈÄ≤Ë°åÁöÑÂ∞çÊà∞"})}):o.map(e=>(0,s.jsx)(x,{battle:e,isMyBattle:!1},e.id))})]})]})}function m(e){let t,a,i,c,d,o,x=(0,n.c)(14),{showAvatarPicker:m,setShowAvatarPicker:h,currentAvatar:f,onUpdate:p}=e;x[0]!==p||x[1]!==h?(t=async function(e){let s=`https://api.dicebear.com/7.x/avataaars/svg?seed=${e}`;try{let e=await (0,l.api)("/api/users/me",{method:"PATCH",body:JSON.stringify({avatar_url:s})});if(e.ok){let s=await e.json();p(s),h(!1)}}catch(e){console.error("Failed to update avatar:",e)}},x[0]=p,x[1]=h,x[2]=t):t=x[2];let u=t;return m?(x[3]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"ÈÅ∏Êìá‰Ω†ÁöÑÈ†≠ÂÉè"}),x[3]=a):a=x[3],x[4]!==h?(i=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[a,(0,s.jsx)("button",{onClick:()=>h(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),x[4]=h,x[5]=i):i=x[5],x[6]!==f||x[7]!==u?(c=r.AVATAR_OPTIONS.map(e=>{let t=`https://api.dicebear.com/7.x/avataaars/svg?seed=${e}`,a=f===t;return(0,s.jsxs)("button",{onClick:()=>u(e),className:`relative w-full aspect-square rounded-xl overflow-hidden border-4 transition-all hover:scale-105 ${a?"border-indigo-500 shadow-lg shadow-indigo-500/50":"border-slate-700 hover:border-slate-500"}`,children:[(0,s.jsx)("img",{src:t,alt:e,className:"w-full h-full object-cover bg-gradient-to-br from-indigo-600 to-purple-400"}),a&&(0,s.jsx)("div",{className:"absolute inset-0 bg-indigo-500/20 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-3xl",children:"‚úì"})})]},e)}),x[6]=f,x[7]=u,x[8]=c):c=x[8],x[9]!==c?(d=(0,s.jsx)("div",{className:"grid grid-cols-5 gap-4 max-h-96 overflow-y-auto p-2",children:c}),x[9]=c,x[10]=d):d=x[10],x[11]!==i||x[12]!==d?(o=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-2xl border border-slate-700 shadow-2xl",children:[i,d]})}),x[11]=i,x[12]=d,x[13]=o):o=x[13],o):null}function h({showProfileEdit:e,setShowProfileEdit:a,user:r,onUpdate:n}){let[i,c]=(0,t.useState)(""),[d,o]=(0,t.useState)("");async function x(){try{let e=await (0,l.api)("/api/users/me",{method:"PATCH",body:JSON.stringify({username:i,bio:d})});if(e.ok){let s=await e.json();n(s),a(!1)}else{let s=await e.json();alert(s.error||"Êõ¥Êñ∞Â§±Êïó")}}catch(e){console.error("Failed to update profile:",e),alert("Êõ¥Êñ∞Â§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶")}}return((0,t.useEffect)(()=>{e&&r&&(c(r.username||""),o(r.bio||""))},[e,r]),e)?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-md border border-slate-700 shadow-2xl",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"Á∑®ËºØÂÄã‰∫∫Ë≥áÊñô"}),(0,s.jsx)("button",{onClick:()=>a(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"‰ΩøÁî®ËÄÖÂêçÁ®±"}),(0,s.jsx)("input",{type:"text",value:i,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-indigo-500 transition-colors",placeholder:"Ëº∏ÂÖ•‰ΩøÁî®ËÄÖÂêçÁ®±",maxLength:20})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"ÂÄã‰∫∫Á∞°‰ªã"}),(0,s.jsx)("textarea",{value:d,onChange:e=>o(e.target.value),className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-indigo-500 transition-colors resize-none",placeholder:"ÂØ´ÈªûÈóúÊñºËá™Â∑±ÁöÑ‰∫ãÊÉÖ...",rows:3,maxLength:100}),(0,s.jsxs)("p",{className:"text-xs text-slate-500 mt-1 text-right",children:[d.length," / 100"]})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)("button",{onClick:()=>a(!1),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"ÂèñÊ∂à"}),(0,s.jsx)("button",{onClick:x,className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-medium transition-colors",children:"ÂÑ≤Â≠ò"})]})]})}):null}function f(e){let t,a,l,i,d,o,x,m,h,f,u,b,g,j,N,v,w,y,_,k=(0,n.c)(60),{showUserDetail:S,setShowUserDetail:C,selectedUser:$,addFriend:I,removeFriend:R,onChallenge:T}=e;if(!S||!$)return null;let O=p;k[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"Áé©ÂÆ∂Ë≥áÊñô"}),k[0]=t):t=k[0],k[1]!==C?(a=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[t,(0,s.jsx)("button",{onClick:()=>C(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),k[1]=C,k[2]=a):a=k[2];let P=$.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${$.username}`;k[3]!==$.username||k[4]!==P?(l=(0,s.jsx)("img",{src:P,alt:$.username,className:"w-24 h-24 rounded-full border-4 border-indigo-500 mb-4"}),k[3]=$.username,k[4]=P,k[5]=l):l=k[5],k[6]!==$.username?(i=(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:$.username}),k[6]=$.username,k[7]=i):i=k[7],k[8]!==$.seconds_offline?(d=$.seconds_offline<300?(0,s.jsx)("p",{className:"text-green-400 text-sm mt-1",children:"‚óè Á∑ö‰∏ä"}):(0,s.jsxs)("p",{className:"text-slate-400 text-sm mt-1",children:["Èõ¢Á∑ö ",(0,r.formatLastOnline)($.seconds_offline)]}),k[8]=$.seconds_offline,k[9]=d):d=k[9],k[10]!==$.bio?(o=$.bio&&(0,s.jsx)("p",{className:"text-slate-300 text-sm mt-3 text-center italic",children:$.bio}),k[10]=$.bio,k[11]=o):o=k[11],k[12]!==$.rating?(x=$.rating&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(c.default,{rating:$.rating,size:64})}),k[12]=$.rating,k[13]=x):x=k[13],k[14]!==T||k[15]!==$.id||k[16]!==$.is_friend?(m=$.is_friend&&T&&(0,s.jsxs)("button",{onClick:()=>T($.id),className:"px-6 py-2 bg-amber-600 hover:bg-amber-500 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[(0,s.jsx)("span",{children:"‚öîÔ∏è"})," Á¥ÑÊà∞"]}),k[14]=T,k[15]=$.id,k[16]=$.is_friend,k[17]=m):m=k[17],k[18]!==I||k[19]!==R||k[20]!==$.id||k[21]!==$.is_friend||k[22]!==C?(h=$.is_friend?R&&(0,s.jsx)("button",{onClick:()=>{confirm("Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄô‰ΩçÂ•ΩÂèãÂóéÔºü")&&(R($.id),C(!1))},className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-medium transition-colors",children:"Âà™Èô§Â•ΩÂèã"}):(0,s.jsx)("button",{onClick:()=>I($.id),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-medium transition-colors",children:"Âä†ÁÇ∫Â•ΩÂèã"}),k[18]=I,k[19]=R,k[20]=$.id,k[21]=$.is_friend,k[22]=C,k[23]=h):h=k[23],k[24]!==h||k[25]!==m?(f=(0,s.jsxs)("div",{className:"flex gap-3 mt-4 w-full justify-center",children:[m,h]}),k[24]=h,k[25]=m,k[26]=f):f=k[26],k[27]!==f||k[28]!==l||k[29]!==i||k[30]!==d||k[31]!==o||k[32]!==x?(u=(0,s.jsxs)("div",{className:"flex flex-col items-center mb-6",children:[l,i,d,o,x,f]}),k[27]=f,k[28]=l,k[29]=i,k[30]=d,k[31]=o,k[32]=x,k[33]=u):u=k[33],k[34]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)("h4",{className:"text-xs font-bold text-amber-400 mb-3 uppercase tracking-wider",children:"Á©çÂàÜÂ∞çÊà∞"}),k[34]=b):b=k[34],k[35]!==$.ranked_games_played||k[36]!==$.ranked_games_won||k[37]!==$.rating?(g=(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl",children:[b,$.ranked_games_played<5?(0,s.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,s.jsx)("p",{className:"text-sm text-amber-400 text-center font-medium",children:"ÂÆöÁ¥ö‰∏≠"}),(0,s.jsx)("p",{className:"text-xs text-slate-400 text-center mt-2",children:"ÂÆåÊàê 5 Â†¥ÂÆöÁ¥öË≥ΩÂæåÂ∞áÈ°ØÁ§∫ÊÆµ‰Ωç"}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"Â∑≤ÂÆåÊàê"}),(0,s.jsxs)("span",{className:"font-bold text-white",children:[$.ranked_games_played,"/5"]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÂãùÂ†¥"}),(0,s.jsx)("span",{className:"font-bold text-green-400",children:$.ranked_games_won})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs block",children:"ÊÆµ‰Ωç"}),(0,s.jsx)("span",{className:`font-bold text-lg ${(0,r.getRankInfo)($.rating).color}`,children:(0,r.getRankInfo)($.rating).nameZh})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs block",children:"Rating"}),(0,s.jsx)("span",{className:"font-bold text-lg text-amber-400",children:$.rating})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÂãùÂ†¥"}),(0,s.jsx)("span",{className:"font-bold text-green-400",children:$.ranked_games_won})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÊïóÂ†¥"}),(0,s.jsx)("span",{className:"font-bold text-red-400",children:$.ranked_games_played-$.ranked_games_won})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"Á∏ΩÂ†¥Ê¨°"}),(0,s.jsx)("span",{className:"font-bold text-white",children:$.ranked_games_played})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÂãùÁéá"}),(0,s.jsxs)("span",{className:"font-bold text-emerald-400",children:[$.ranked_games_played>0?Math.round($.ranked_games_won/$.ranked_games_played*100):0,"%"]})]})]})]})]}),k[35]=$.ranked_games_played,k[36]=$.ranked_games_won,k[37]=$.rating,k[38]=g):g=k[38];let F=$.casual_games_played||0,E=$.casual_games_won||0;k[39]!==F||k[40]!==E?(j=O("‰∏ÄËà¨Â∞çÊà∞",F,E,"text-blue-400"),k[39]=F,k[40]=E,k[41]=j):j=k[41];let M=$.custom_games_played||0,A=$.custom_games_won||0;return k[42]!==M||k[43]!==A?(N=O("Â•ΩÂèãÂ∞çÊà∞",M,A,"text-purple-400"),k[42]=M,k[43]=A,k[44]=N):N=k[44],k[45]!==g||k[46]!==j||k[47]!==N?(v=(0,s.jsxs)("div",{className:"space-y-4 mb-6",children:[g,j,N]}),k[45]=g,k[46]=j,k[47]=N,k[48]=v):v=k[48],k[49]!==$.ranked_games_played||k[50]!==$.rating?(w=$.ranked_games_played>=10&&(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl mb-6",children:[(0,s.jsx)("h4",{className:"text-sm font-bold text-white mb-3",children:"Rating ÂàÜ‰Ωà"}),(0,s.jsxs)("div",{className:"relative pt-6 pb-2",children:[(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 flex justify-between text-[10px] text-slate-500",children:[(0,s.jsx)("span",{style:{left:"0%"},className:"absolute",children:"0"}),(0,s.jsx)("span",{style:{left:"14%"},className:"absolute",children:"800"}),(0,s.jsx)("span",{style:{left:"28%"},className:"absolute",children:"1200"}),(0,s.jsx)("span",{style:{left:"42%"},className:"absolute",children:"1500"}),(0,s.jsx)("span",{style:{left:"57%"},className:"absolute",children:"1800"}),(0,s.jsx)("span",{style:{left:"71%"},className:"absolute",children:"2200"}),(0,s.jsx)("span",{style:{left:"85%"},className:"absolute",children:"2500"})]}),(0,s.jsxs)("div",{className:"relative h-4 bg-slate-800 rounded-full overflow-hidden mt-1",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-slate-600 via-amber-700 via-slate-400 via-yellow-500 via-cyan-500 via-blue-600 to-purple-600 opacity-50"}),(0,s.jsx)("div",{className:"absolute top-0 bottom-0 w-1 bg-white shadow-[0_0_10px_rgba(255,255,255,0.8)] z-10",style:{left:`${Math.min(Math.max($.rating/3e3*100,0),100)}%`},children:(0,s.jsx)("div",{className:"absolute -top-7 left-1/2 transform -translate-x-1/2 bg-slate-800 text-white text-xs font-bold px-2 py-0.5 rounded border border-slate-600 whitespace-nowrap",children:$.rating})})]}),(0,s.jsxs)("div",{className:"flex justify-between items-start mt-2 px-1",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-500",children:"Èêµ"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"0-800"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-amber-700",children:"ÈäÖ"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"800+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-300",children:"ÈäÄ"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"1200+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-yellow-500",children:"Èáë"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"1500+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-cyan-400",children:"ÁôΩÈáë"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"1800+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-blue-400",children:"ÈëΩÁü≥"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"2200+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-purple-400",children:"Â§ßÂ∏´"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"2500+"})]})]})]})]}),k[49]=$.ranked_games_played,k[50]=$.rating,k[51]=w):w=k[51],k[52]!==C?(y=(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("button",{onClick:()=>C(!1),className:"w-full px-4 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-medium transition-colors",children:"ÈóúÈñâ"})}),k[52]=C,k[53]=y):y=k[53],k[54]!==u||k[55]!==a||k[56]!==v||k[57]!==w||k[58]!==y?(_=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-lg border border-slate-700 shadow-2xl max-h-[90vh] overflow-y-auto",children:[a,u,v,w,y]})}),k[54]=u,k[55]=a,k[56]=v,k[57]=w,k[58]=y,k[59]=_):_=k[59],_}function p(e,t,a,l){let r=t>0?Math.round(a/t*100):0;return(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:`text-xs font-bold ${l} mb-3 uppercase tracking-wider`,children:e}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÂãùÂ†¥"}),(0,s.jsx)("span",{className:"font-bold text-green-400",children:a})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÊïóÂ†¥"}),(0,s.jsx)("span",{className:"font-bold text-red-400",children:t-a})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"Á∏ΩÂ†¥Ê¨°"}),(0,s.jsx)("span",{className:"font-bold text-white",children:t})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÂãùÁéá"}),(0,s.jsxs)("span",{className:"font-bold text-emerald-400",children:[r,"%"]})]})]})]})}function u(e){let t,a,l,i,c,d=(0,n.c)(16),{showFriendRequests:o,setShowFriendRequests:x,friendRequests:m,acceptFriendRequest:h,rejectFriendRequest:f,battleInvites:p,acceptBattleInvite:u,rejectBattleInvite:b}=e;d[0]!==p?(t=void 0===p?[]:p,d[0]=p,d[1]=t):t=d[1];let g=t;if(!o)return null;let j=m.length>0||g.length>0;return d[2]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"ÈÄöÁü•‰∏≠ÂøÉ"}),d[2]=a):a=d[2],d[3]!==x?(l=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[a,(0,s.jsx)("button",{onClick:()=>x(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),d[3]=x,d[4]=l):l=d[4],d[5]!==u||d[6]!==h||d[7]!==g||d[8]!==m||d[9]!==j||d[10]!==b||d[11]!==f?(i=j?(0,s.jsxs)("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[g.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-bold text-amber-400 mb-3 uppercase tracking-wider",children:"Â∞çÊà∞ÈÇÄË´ã"}),(0,s.jsx)("div",{className:"space-y-3",children:g.map(e=>(0,s.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-xl border border-amber-500/30",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-12 h-12 rounded-full border-2 border-amber-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("p",{className:"font-medium text-white",children:[(0,s.jsx)("span",{className:"text-amber-400",children:e.username})," ÈÇÄË´ã‰Ω†ÈÄ≤Ë°åÂ∞çÊà∞"]}),(0,s.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:new Date(e.created_at).toLocaleTimeString()})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>u&&u(e.id),className:"flex-1 px-4 py-2 bg-amber-600 hover:bg-amber-500 text-white rounded-lg font-medium transition-colors",children:"Êé•ÂèóÊåëÊà∞"}),(0,s.jsx)("button",{onClick:()=>b&&b(e.id),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"ÊãíÁµï"})]})]},e.id))})]}),m.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-bold text-indigo-400 mb-3 uppercase tracking-wider",children:"Â•ΩÂèãË´ãÊ±Ç"}),(0,s.jsx)("div",{className:"space-y-3",children:m.map(e=>(0,s.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-12 h-12 rounded-full border-2 border-indigo-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium text-white",children:e.username}),e.games_played>=10?(0,s.jsxs)("p",{className:`text-sm ${(0,r.getRankInfo)(e.rating).color}`,children:[(0,r.getRankInfo)(e.rating).nameZh," ¬∑ ",e.rating]}):(0,s.jsx)("p",{className:"text-sm text-amber-400",children:"ÂÆöÁ¥ö‰∏≠"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>h(e.request_id),className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg font-medium transition-colors",children:"Êé•Âèó"}),(0,s.jsx)("button",{onClick:()=>f(e.request_id),className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-medium transition-colors",children:"ÊãíÁµï"})]})]},e.request_id))})]})]}):(0,s.jsx)("div",{className:"text-center py-8 text-slate-500",children:(0,s.jsx)("p",{children:"ÁõÆÂâçÊ≤íÊúâÊñ∞ÁöÑÈÄöÁü•"})}),d[5]=u,d[6]=h,d[7]=g,d[8]=m,d[9]=j,d[10]=b,d[11]=f,d[12]=i):i=d[12],d[13]!==l||d[14]!==i?(c=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-md border border-slate-700 shadow-2xl",children:[l,i]})}),d[13]=l,d[14]=i,d[15]=c):c=d[15],c}function b({showChat:e,setShowChat:a,chatFriend:n,user:i}){let[c,d]=(0,t.useState)([]),[o,x]=(0,t.useState)(""),m=(0,t.useRef)(null);(0,t.useEffect)(()=>{if(e&&n){f();let e=setInterval(f,3e3);return()=>clearInterval(e)}},[e,n]),(0,t.useEffect)(()=>{h()},[c]);let h=()=>{m.current?.scrollIntoView({behavior:"smooth"})};async function f(){if(n)try{let e=await (0,l.api)(`/api/friends/messages/${n.id}`);if(e.ok){let s=await e.json();d(s)}}catch(e){console.error("Failed to load messages:",e)}}async function p(){if(o.trim()&&n)try{(await (0,l.api)(`/api/friends/send-message/${n.id}`,{method:"POST",body:JSON.stringify({content:o})})).ok&&(x(""),f())}catch(e){console.error("Failed to send message:",e)}}return e&&n?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] rounded-2xl w-full max-w-2xl h-[600px] border border-slate-700 shadow-2xl flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:n.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${n.username}`,alt:n.username,className:"w-10 h-10 rounded-full border-2 border-indigo-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-white",children:n.username}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:n.seconds_offline<30?(0,s.jsx)("span",{className:"text-green-400",children:"‚óè Á∑ö‰∏ä"}):(0,r.formatLastOnline)(n.seconds_offline)})]})]}),(0,s.jsx)("button",{onClick:()=>{a(!1)},className:"text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[0===c.length?(0,s.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,s.jsx)("p",{children:"ÈÇÑÊ≤íÊúâË®äÊÅØ"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"ÈñãÂßãËÅäÂ§©ÂêßÔºÅ"})]}):c.map(e=>{let t=e.sender_id===i?.id;return(0,s.jsx)("div",{className:`flex ${t?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`max-w-[70%] ${t?"items-end":"items-start"} flex flex-col`,children:[(0,s.jsx)("div",{className:`px-4 py-2 rounded-2xl ${t?"bg-indigo-600 text-white":"bg-slate-700 text-slate-200"}`,children:e.content}),(0,s.jsx)("span",{className:"text-xs text-slate-500 mt-1 px-1",children:function(e){let s=new Date(e),t=Math.floor((new Date().getTime()-s.getTime())/1e3);if(t<60)return"ÂâõÂâõ";let a=Math.floor(t/60);if(a<60)return`${a} ÂàÜÈêòÂâç`;let l=Math.floor(a/60);return l<24?`${l} Â∞èÊôÇÂâç`:s.toLocaleString("zh-TW",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}(e.created_at)})]})},e.id)}),(0,s.jsx)("div",{ref:m})]}),(0,s.jsx)("div",{className:"p-4 border-t border-slate-700 bg-slate-800/50 rounded-b-2xl",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:o,onChange:e=>x(e.target.value),onKeyDown:e=>"Enter"===e.key&&p(),placeholder:"Ëº∏ÂÖ•Ë®äÊÅØ...",className:"flex-1 px-4 py-2 bg-slate-900 border border-slate-700 rounded-full text-white focus:outline-none focus:border-indigo-500 transition-colors"}),(0,s.jsx)("button",{onClick:p,disabled:!o.trim(),className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-700 disabled:text-slate-500 text-white rounded-full font-medium transition-colors",children:"ÁôºÈÄÅ"})]})})]})}):null}function g(e){let t,a,l=(0,n.c)(6),{isMatching:r,matchStatus:i,matchMode:d,cancelMatching:o,opponent:x}=e;return r?(l[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500 to-transparent animate-shimmer"}),l[0]=t):t=l[0],l[1]!==o||l[2]!==d||l[3]!==i||l[4]!==x?(a=(0,s.jsx)("div",{className:"fixed inset-0 bg-slate-900/90 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-slate-800 p-8 rounded-2xl border border-slate-700 shadow-2xl max-w-md w-full text-center relative overflow-hidden",children:[t,"waiting"===i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-6 relative",children:[(0,s.jsx)("div",{className:"w-24 h-24 mx-auto border-4 border-indigo-500/30 border-t-indigo-500 rounded-full animate-spin"}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-4xl",children:"üîç"})})]}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-white mb-2",children:"Ê≠£Âú®Â∞ãÊâæÂ∞çÊâã..."}),(0,s.jsxs)("p",{className:"text-slate-400 mb-8",children:["ranked"===d?"Á©çÂàÜÂ∞çÊà∞":"ranked_rts"===d?"Âç≥ÊôÇÂ∞çÊà∞":"‰∏ÄËà¨Â∞çÊà∞"," ‚Ä¢ È†êË®àÁ≠âÂæÖÊôÇÈñì: 30Áßí"]}),(0,s.jsx)("button",{onClick:o,className:"px-8 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition-colors",children:"ÂèñÊ∂àÂåπÈÖç"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-6 relative",children:(0,s.jsx)("div",{className:"w-24 h-24 mx-auto bg-green-500 rounded-full flex items-center justify-center animate-bounce",children:(0,s.jsx)("span",{className:"text-4xl",children:"‚öîÔ∏è"})})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-white mb-2",children:"ÂåπÈÖçÊàêÂäüÔºÅ"}),(0,s.jsx)("p",{className:"text-slate-400 mb-6",children:"Âç≥Â∞áÈñãÂßãÂ∞çÊà∞"}),x&&(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-slate-700 mb-6 flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-slate-700 rounded-full overflow-hidden",children:(0,s.jsx)("img",{src:x.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${x.username}`,alt:x.username,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"text-left flex-1",children:[(0,s.jsx)("div",{className:"font-bold text-white",children:x.username}),(0,s.jsxs)("div",{className:"text-sm text-slate-400",children:["Rating: ",null!==x.rating?x.rating:"Êú™ÂÆöÁ¥ö"]})]}),null!==x.rating&&(0,s.jsx)(c.default,{rating:x.rating,size:40})]}),(0,s.jsx)("div",{className:"w-full bg-slate-700 h-2 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-green-500 animate-[width_3s_linear_forwards]",style:{width:"100%"}})})]})]})}),l[1]=o,l[2]=d,l[3]=i,l[4]=x,l[5]=a):a=l[5],a):null}let j=["IRON","BRONZE","SILVER","GOLD","PLATINUM","DIAMOND","MASTER","GRANDMASTER"],N={IRON:{nameZh:"ÈêµÁâå",gradient:"from-zinc-500 to-zinc-700",rating:700},BRONZE:{nameZh:"ÈäÖÁâå",gradient:"from-amber-600 to-amber-800",rating:900},SILVER:{nameZh:"ÈäÄÁâå",gradient:"from-slate-300 to-slate-500",rating:1100},GOLD:{nameZh:"ÈáëÁâå",gradient:"from-yellow-300 to-yellow-600",rating:1350},PLATINUM:{nameZh:"ÁôΩÈáë",gradient:"from-cyan-300 to-cyan-600",rating:1650},DIAMOND:{nameZh:"ÈëΩÁü≥",gradient:"from-blue-400 to-blue-700",rating:2e3},MASTER:{nameZh:"Â§ßÂ∏´",gradient:"from-purple-400 to-purple-700",rating:2300},GRANDMASTER:{nameZh:"ÂÆóÂ∏´",gradient:"from-red-400 to-red-700",rating:2600}};function v(e){let a,r,i,d,o,x,m,h,f,p=(0,n.c)(17),{show:u,onClose:b}=e;p[0]===Symbol.for("react.memo_cache_sentinel")?(a=[],p[0]=a):a=p[0];let[g,v]=(0,t.useState)(a),[_,k]=(0,t.useState)(!0);if(p[1]!==u?(r=()=>{u&&(k(!0),(0,l.api)("/api/users/rank-distribution").then(y).then(e=>{v(j.map(s=>{let t=e.find(e=>e.rank===s);return{rank:s,count:t?t.count:0}})),k(!1)}).catch(e=>{console.error(e),k(!1)}))},i=[u],p[1]=u,p[2]=r,p[3]=i):(r=p[2],i=p[3]),(0,t.useEffect)(r,i),!u)return null;p[4]!==g?(d=Math.max(...g.map(w),1),p[4]=g,p[5]=d):d=p[5];let S=d;return p[6]!==b?(o=(0,s.jsx)("button",{onClick:b,className:"absolute top-4 right-4 text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"}),p[6]=b,p[7]=o):o=p[7],p[8]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("h2",{className:"text-2xl font-bold text-white mb-8 text-center",children:"ÂÖ®ÊúçÊÆµ‰ΩçÂàÜ‰Ωà"}),p[8]=x):x=p[8],p[9]!==g||p[10]!==_||p[11]!==S?(m=_?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):(0,s.jsx)("div",{className:"h-80 flex items-end justify-between gap-2 px-4",children:g.map(e=>{let t=N[e.rank],a=e.count/S*100;return(0,s.jsxs)("div",{className:"flex flex-col items-center flex-1 group relative",children:[(0,s.jsxs)("div",{className:"absolute bottom-full mb-2 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-800 text-white text-xs px-2 py-1 rounded border border-slate-600 whitespace-nowrap z-10",children:[e.count," ‰∫∫ (",t.nameZh,")"]}),(0,s.jsx)("div",{className:`w-full rounded-t-lg bg-gradient-to-t ${t.gradient} transition-all duration-500 hover:brightness-110 relative`,style:{height:`${Math.max(a,2)}%`},children:(0,s.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 bg-white/30"})}),(0,s.jsxs)("div",{className:"mt-3 flex flex-col items-center gap-1",children:[(0,s.jsx)("div",{className:"transform transition-transform group-hover:scale-110",children:(0,s.jsx)(c.default,{rating:t.rating,size:32})}),(0,s.jsx)("span",{className:"text-[10px] text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity absolute top-full mt-1 whitespace-nowrap",children:t.nameZh})]})]},e.rank)})}),p[9]=g,p[10]=_,p[11]=S,p[12]=m):m=p[12],p[13]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsx)("div",{className:"mt-8 text-center text-slate-500 text-sm",children:"Áµ±Ë®àÁØÑÂúçÔºöÂÆåÊàê 10 Â†¥ÂÆöÁ¥öË≥ΩÁöÑÊ¥ªË∫çÁé©ÂÆ∂"}),p[13]=h):h=p[13],p[14]!==o||p[15]!==m?(f=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-8 rounded-2xl w-full max-w-4xl border border-slate-700 shadow-2xl relative",children:[o,x,m,h]})}),p[14]=o,p[15]=m,p[16]=f):f=p[16],f}function w(e){return e.count}function y(e){return e.json()}function _(e){let a,l,r,i,c,d,o,x,m,h,f,p,u,b,g,j,N,v,w,y,_,$,I,R,T,O,P,F,E,M,A,q,z,L,D,U,Z=(0,n.c)(57),{show:B,onClose:J}=e,[V,G]=(0,t.useState)(0);Z[0]!==B?(a=()=>{B&&G(0)},l=[B],Z[0]=B,Z[1]=a,Z[2]=l):(a=Z[1],l=Z[2]),(0,t.useEffect)(a,l),Z[3]===Symbol.for("react.memo_cache_sentinel")?(r=()=>G(C),Z[3]=r):r=Z[3];let K=r;Z[4]===Symbol.for("react.memo_cache_sentinel")?(i=()=>G(S),Z[4]=i):i=Z[4];let H=i;if(!B)return null;Z[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsxs)("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{children:"üéì"})," ÈÅäÊà≤ÊïôÂ≠∏"]}),Z[5]=c):c=Z[5],Z[6]!==J?(d=(0,s.jsxs)("div",{className:"p-6 border-b border-slate-800 flex justify-between items-center bg-slate-950",children:[c,(0,s.jsx)("button",{onClick:J,className:"text-slate-400 hover:text-white transition-colors text-2xl",children:"√ó"})]}),Z[6]=J,Z[7]=d):d=Z[7];let W=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${0===V?"opacity-100 translate-x-0":V>0?"opacity-0 -translate-x-full":"opacity-0 translate-x-full"}`;Z[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"„ÑÖ",animate:!0})}),Z[8]=o):o=Z[8],Z[9]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(k,{char:"„ÑÜ",animate:!0})}),Z[9]=x):x=Z[9],Z[10]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsxs)("div",{className:"flex items-center justify-center gap-1 mb-6",children:[o,x,(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"„Ñá",animate:!0})})]}),h=(0,s.jsx)("p",{className:"text-xl font-bold text-indigo-400 mb-2",children:"1. ÈÄ£Êé•Áõ∏ÈÑ∞Á¨¶Ëôü"}),f=(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"Âú®Âú∞Âúñ‰∏äÊªëÂãïÊàñÈªûÊìäÔºåÈÄ£Êé•Áõ∏ÈÑ∞ÁöÑÊ≥®Èü≥Á¨¶Ëôü"}),Z[10]=m,Z[11]=h,Z[12]=f):(m=Z[10],h=Z[11],f=Z[12]),Z[13]!==W?(p=(0,s.jsxs)("div",{className:W,children:[m,h,f]}),Z[13]=W,Z[14]=p):p=Z[14];let Q=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${1===V?"opacity-100 translate-x-0":V>1?"opacity-0 -translate-x-full":V<1?"opacity-0 translate-x-full":""}`;Z[15]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"„ÑÖ",color:"indigo",scale:1.1})}),Z[15]=u):u=Z[15],Z[16]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(k,{char:"„ÑÜ",color:"indigo",scale:1.1})}),Z[16]=b):b=Z[16],Z[17]===Symbol.for("react.memo_cache_sentinel")?(g=(0,s.jsxs)("div",{className:"flex items-center justify-center gap-1 mb-6",children:[u,b,(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"„Ñá",color:"indigo",scale:1.1})})]}),j=(0,s.jsx)("p",{className:"text-xl font-bold text-green-400 mb-2",children:"2. ÁµÑÊàêÊúâÊïàË©ûÂΩô"}),N=(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"ÂøÖÈ†àÁµÑÊàêÂ≠óÂÖ∏‰∏≠Â≠òÂú®ÁöÑÊ≥®Èü≥ÁµÑÂêàÔºàÂ¶ÇÔºö„ÑÖ„ÑÜ„ÑáÔºâ"}),Z[17]=g,Z[18]=j,Z[19]=N):(g=Z[17],j=Z[18],N=Z[19]),Z[20]!==Q?(v=(0,s.jsxs)("div",{className:Q,children:[g,j,N]}),Z[20]=Q,Z[21]=v):v=Z[21];let X=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${2===V?"opacity-100 translate-x-0":V>2?"opacity-0 -translate-x-full":V<2?"opacity-0 translate-x-full":""}`;Z[22]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"",color:"red"})}),Z[22]=w):w=Z[22],Z[23]===Symbol.for("react.memo_cache_sentinel")?(y=(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(k,{char:"",color:"red"})}),Z[23]=y):y=Z[23],Z[24]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsxs)("div",{className:"flex items-center justify-center gap-1 mb-6",children:[w,y,(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"",color:"red"})})]}),$=(0,s.jsx)("p",{className:"text-xl font-bold text-red-400 mb-2",children:"3. ‰ΩîÈ†òÂú∞Áõ§"}),I=(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"ÊàêÂäüÁµÑË©ûÂæåÔºåË©≤ÂçÄÂüüÂ∞áËÆäÁÇ∫‰Ω†ÁöÑÈ†òÂú∞„ÄÇÈÄ£Êé•Âà∞Â∞çÊñπÂüéÂ†°Âç≥ÂèØÁç≤ÂãùÔºÅ"}),Z[24]=_,Z[25]=$,Z[26]=I):(_=Z[24],$=Z[25],I=Z[26]),Z[27]!==X?(R=(0,s.jsxs)("div",{className:X,children:[_,$,I]}),Z[27]=X,Z[28]=R):R=Z[28];let Y=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${3===V?"opacity-100 translate-x-0":V<3?"opacity-0 translate-x-full":""}`;Z[29]===Symbol.for("react.memo_cache_sentinel")?(T=(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("div",{className:"w-24 h-24 rounded-full bg-purple-600 flex items-center justify-center text-5xl shadow-[0_0_30px_rgba(147,51,234,0.5)] animate-bounce",children:"üé≤"}),(0,s.jsx)("div",{className:"absolute -bottom-2 -right-2 bg-yellow-400 text-black text-xs font-bold px-2 py-1 rounded-full border-2 border-slate-900",children:"Skill Ready!"})]}),O=(0,s.jsx)("p",{className:"text-xl font-bold text-purple-400 mb-2",children:"4. ‰ΩøÁî®ÊäÄËÉΩ"}),P=(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"ÊØèÂõûÂêàÁ¥ØÁ©çËÉΩÈáèÔºåÈõÜÊªø 3 ÈªûÂèØÁç≤ÂæóÊäÄËÉΩÈÅìÂÖ∑ÔºåÊîπËÆäÊà∞Â±ÄÔºÅ"}),Z[29]=T,Z[30]=O,Z[31]=P):(T=Z[29],O=Z[30],P=Z[31]),Z[32]!==Y?(F=(0,s.jsxs)("div",{className:Y,children:[T,O,P]}),Z[32]=Y,Z[33]=F):F=Z[33],Z[34]!==p||Z[35]!==v||Z[36]!==R||Z[37]!==F?(E=(0,s.jsxs)("div",{className:"w-full h-72 bg-slate-950 rounded-xl border border-slate-800 mb-6 relative overflow-hidden flex items-center justify-center",children:[p,v,R,F]}),Z[34]=p,Z[35]=v,Z[36]=R,Z[37]=F,Z[38]=E):E=Z[38],Z[39]===Symbol.for("react.memo_cache_sentinel")?(M=[0,1,2,3],Z[39]=M):M=Z[39],Z[40]!==V?(A=(0,s.jsx)("div",{className:"flex gap-2 mb-8",children:M.map(e=>(0,s.jsx)("div",{className:`w-3 h-3 rounded-full transition-all duration-300 ${V===e?"bg-indigo-500 scale-125":"bg-slate-700"}`},e))}),Z[40]=V,Z[41]=A):A=Z[41];let ee=0===V;return Z[42]!==ee?(q=(0,s.jsx)("button",{onClick:H,disabled:ee,className:"flex-1 py-3 rounded-xl font-bold transition-all bg-slate-800 hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed text-slate-300",children:"‰∏ä‰∏ÄÊ≠•"}),Z[42]=ee,Z[43]=q):q=Z[43],Z[44]!==J||Z[45]!==V?(z=V<3?(0,s.jsx)("button",{onClick:K,className:"flex-1 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-indigo-500/25",children:"‰∏ã‰∏ÄÊ≠•"}):(0,s.jsx)("button",{onClick:J,className:"flex-1 py-3 bg-green-600 hover:bg-green-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-green-500/25",children:"ÈñãÂßãÊà∞È¨•ÔºÅ"}),Z[44]=J,Z[45]=V,Z[46]=z):z=Z[46],Z[47]!==q||Z[48]!==z?(L=(0,s.jsxs)("div",{className:"flex gap-4 w-full",children:[q,z]}),Z[47]=q,Z[48]=z,Z[49]=L):L=Z[49],Z[50]!==E||Z[51]!==A||Z[52]!==L?(D=(0,s.jsxs)("div",{className:"p-8 flex flex-col items-center",children:[E,A,L]}),Z[50]=E,Z[51]=A,Z[52]=L,Z[53]=D):D=Z[53],Z[54]!==D||Z[55]!==d?(U=(0,s.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:(0,s.jsxs)("div",{className:"bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col",children:[d,D]})}),Z[54]=D,Z[55]=d,Z[56]=U):U=Z[56],U}function k(e){let{char:t,color:a,animate:l,scale:r}=e,n=void 0===a?"slate":a,i="linear-gradient(180deg, #cbd5e1 0%, #94a3b8 100%)";return"red"===n&&(i="linear-gradient(180deg,#fca5a5,#ef4444)"),"indigo"===n&&(i="linear-gradient(180deg, #818cf8, #4f46e5)"),(0,s.jsxs)("div",{className:`relative flex items-center justify-center transition-all duration-300 ${void 0!==l&&l?"animate-bounce":""}`,style:{width:"64px",height:"74px",clipPath:"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)",background:i,transform:`scale(${void 0===r?1:r})`,boxShadow:"0 4px 6px rgba(0,0,0,0.3)"},children:[(0,s.jsx)("div",{className:"absolute inset-0 border border-white/20",style:{clipPath:"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)"}}),(0,s.jsx)("span",{className:"text-2xl font-bold text-slate-900 z-10",children:t})]})}function S(e){return Math.max(e-1,0)}function C(e){return Math.min(e+1,3)}function $(){let e=(0,a.useRouter)(),[n,c]=(0,t.useState)(!0),[p,j]=(0,t.useState)(null),[N,w]=(0,t.useState)(!1),[y,k]=(0,t.useState)(!1),[S,C]=(0,t.useState)(!1),[$,I]=(0,t.useState)(!1),[R,T]=(0,t.useState)(!1),[O,P]=(0,t.useState)(!1),[F,E]=(0,t.useState)(!1),[M,A]=(0,t.useState)([]),[q,z]=(0,t.useState)([]),[L,D]=(0,t.useState)([]),[U,Z]=(0,t.useState)([]),[B,J]=(0,t.useState)(null),[V,G]=(0,t.useState)(null),[K,H]=(0,t.useState)(!1),[W,Q]=(0,t.useState)(null),[X,Y]=(0,t.useState)(null),[ee,es]=(0,t.useState)(null),[et,ea]=(0,t.useState)(null),el=p?.avatar_url||r.AVATAR_OPTIONS[0];async function er(e){try{let s=await (0,l.api)(`/api/friends/invite-battle/${e}`,{method:"POST"});if(s.ok)alert("Â∑≤ÁôºÈÄÅÁ¥ÑÊà∞ÈÇÄË´ãÔºÅ");else{let e=await s.json();alert(e.error||"ÁôºÈÄÅÈÇÄË´ãÂ§±Êïó")}}catch(e){console.error("Challenge error:",e)}}async function en(s){try{let t=await (0,l.api)(`/api/friends/accept-battle-invite/${s}`,{method:"POST"});if(t.ok){let s=await t.json();e.push(`/battle?id=${s.battleId}`)}else alert("Êé•ÂèóÈÇÄË´ãÂ§±Êïó")}catch(e){console.error("Accept invite error:",e)}}async function ei(e){try{await (0,l.api)(`/api/friends/reject-battle-invite/${e}`,{method:"POST"}),Z(s=>s.filter(s=>s.id!==e))}catch(e){console.error("Reject invite error:",e)}}async function ec(){try{localStorage.getItem("token")&&await (0,l.api)("/api/users/logout",{method:"POST"})}catch(e){console.error("Logout error:",e)}finally{localStorage.removeItem("token"),localStorage.removeItem("user"),e.replace("/")}}function ed(e){j(e),localStorage.setItem("user",JSON.stringify(e))}async function eo(e){try{let s=await (0,l.api)(`/api/friends/user/${e}`);s.ok&&(J(await s.json()),C(!0))}catch(e){console.error("Failed to fetch user detail:",e)}}async function ex(e){try{let s=await (0,l.api)(`/api/friends/add-friend/${e}`,{method:"POST"});if(s.ok){alert("Â•ΩÂèãË´ãÊ±ÇÂ∑≤ÁôºÈÄÅÔºÅ");let e=await (0,l.api)("/api/friends/online-users");e.ok&&z(await e.json())}else{let e=await s.json();alert(e.error||"ÁôºÈÄÅÂ§±Êïó")}}catch(e){console.error("Failed to send friend request:",e)}}async function em(e){try{if((await (0,l.api)(`/api/friends/accept-friend/${e}`,{method:"POST"})).ok){let[e,s,t]=await Promise.all([(0,l.api)("/api/friends/my-friends"),(0,l.api)("/api/friends/pending-requests"),(0,l.api)("/api/friends/online-users")]);e.ok&&A(await e.json()),s.ok&&D(await s.json()),t.ok&&z(await t.json())}}catch(e){console.error("Failed to accept friend request:",e)}}async function eh(e){try{if((await (0,l.api)(`/api/friends/reject-friend/${e}`,{method:"DELETE"})).ok){let e=await (0,l.api)("/api/friends/pending-requests");e.ok&&D(await e.json())}}catch(e){console.error("Failed to reject friend request:",e)}}async function ef(e){if(confirm("Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄô‰ΩçÂ•ΩÂèãÂóéÔºü"))try{if((await (0,l.api)(`/api/friends/remove-friend/${e}`,{method:"DELETE"})).ok){let s=await (0,l.api)("/api/friends/my-friends");s.ok&&A(await s.json()),V&&V.id===e&&(T(!1),G(null))}}catch(e){console.error("Failed to remove friend:",e)}}async function ep(s){try{let t;H(!0),Q(s),Y("waiting");let a=await (0,l.api)("/api/matchmaking/queue/join",{method:"POST",body:JSON.stringify({mode:s})});if(!a.ok)throw Error("Failed to join queue");let r=await a.json();"matched"===r.status?(Y("matched"),es(r.battleId),ea(r.opponent),setTimeout(()=>e.push(`/battle?id=${r.battleId}`),3e3)):(t=setInterval(async()=>{try{let s=await (0,l.api)("/api/matchmaking/queue/status");if(!s.ok)return void clearInterval(t);let a=await s.json();"matched"===a.status&&(clearInterval(t),Y("matched"),es(a.battleId),ea(a.opponent),setTimeout(()=>e.push(`/battle?id=${a.battleId}`),3e3))}catch(e){console.error("Error polling match status:",e),clearInterval(t)}},2e3),window.matchPollInterval=t)}catch(e){console.error("Failed to start matching:",e),H(!1),Q(null),Y(null),alert("ÂåπÈÖçÂ§±ÊïóÔºåË´ãÈáçË©¶")}}async function eu(){try{await (0,l.api)("/api/matchmaking/queue/leave",{method:"POST"}),window.matchPollInterval&&clearInterval(window.matchPollInterval),H(!1),Q(null),Y(null)}catch(e){console.error("Failed to cancel matching:",e)}}async function eb(e){try{if((await (0,l.api)(`/api/friends/add-friend/${e}`,{method:"POST"})).ok){alert("Â•ΩÂèãË´ãÊ±ÇÂ∑≤ÁôºÈÄÅÔºÅ");let s=await (0,l.api)("/api/friends/pending-requests");s.ok&&D(await s.json()),B&&B.id===e&&eo(e)}}catch(e){console.error("Failed to add friend:",e)}}return(0,t.useEffect)(()=>{if(localStorage.getItem("token")){let e=localStorage.getItem("user");e&&j(JSON.parse(e)),(0,l.api)("/api/users/me").then(e=>{if(e.ok)return e.json();throw Error("Failed to fetch user")}).then(e=>{j(e),localStorage.setItem("user",JSON.stringify(e))}).catch(e=>{console.error(e)}).finally(()=>{c(!1)})}else e.replace("/")},[e]),(0,t.useEffect)(()=>{if(!localStorage.getItem("token"))return;(0,l.api)("/api/friends/ping",{method:"POST"});let e=setInterval(()=>{(0,l.api)("/api/friends/ping",{method:"POST"})},2e4);return()=>clearInterval(e)},[]),(0,t.useEffect)(()=>{if(!p)return;async function e(){try{let[e,s,t,a]=await Promise.all([(0,l.api)("/api/friends/my-friends"),(0,l.api)("/api/friends/online-users"),(0,l.api)("/api/friends/pending-requests"),(0,l.api)("/api/friends/battle-invites")]);e.ok&&A(await e.json()),s.ok&&z(await s.json()),t.ok&&D(await t.json()),a.ok&&Z(await a.json())}catch(e){console.error("Failed to load friends and users:",e)}}e();let s=setInterval(e,3e4);return()=>clearInterval(s)},[p]),n?(0,s.jsx)("div",{className:"min-h-screen bg-[#0f172a] flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):(0,s.jsxs)("div",{className:"flex flex-col h-screen bg-[#0f172a] text-slate-200 overflow-hidden",children:[(0,s.jsx)(i,{friendRequestsCount:L.length+U.length,showFriendRequests:$,setShowFriendRequests:I,handleLogout:ec,onOpenLeaderboard:()=>P(!0),onOpenTutorial:()=>E(!0)}),(0,s.jsxs)("main",{className:"flex flex-1 overflow-hidden",children:[(0,s.jsx)(d,{user:p,selectedAvatar:el,setShowAvatarPicker:w,openProfileEdit:function(){k(!0)},startMatching:ep,isMatching:K}),(0,s.jsx)(x,{user:p}),(0,s.jsx)(o,{friends:M,onlineUsers:q,openChat:function(e){G(e),T(!0)},viewUserDetail:eo,removeFriend:ef,sendFriendRequest:ex})]}),(0,s.jsx)(m,{showAvatarPicker:N,setShowAvatarPicker:w,currentAvatar:el,onUpdate:ed}),(0,s.jsx)(h,{showProfileEdit:y,setShowProfileEdit:k,user:p,onUpdate:ed}),(0,s.jsx)(f,{showUserDetail:S,setShowUserDetail:C,selectedUser:B,addFriend:eb,removeFriend:ef,onChallenge:er}),(0,s.jsx)(u,{showFriendRequests:$,setShowFriendRequests:I,friendRequests:L,acceptFriendRequest:em,rejectFriendRequest:eh,battleInvites:U,acceptBattleInvite:en,rejectBattleInvite:ei}),(0,s.jsx)(b,{showChat:R,setShowChat:T,chatFriend:V,user:p}),(0,s.jsx)(g,{isMatching:K,matchStatus:X,matchMode:W,cancelMatching:eu,opponent:et}),(0,s.jsx)(v,{show:O,onClose:()=>P(!1)}),(0,s.jsx)(_,{show:F,onClose:()=>E(!1)})]})}e.s(["default",()=>$],15452)}]);