(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15452,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566),l=e.i(54858),r=e.i(47163),n=e.i(932);function i(e){let t,a,l,r,i,c,d,o,x,m,h,u=(0,n.c)(23),{friendRequestsCount:f,showFriendRequests:p,setShowFriendRequests:b,handleLogout:g,onOpenLeaderboard:j,onOpenTutorial:N}=e;return u[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("h1",{className:"text-2xl font-black text-white tracking-tighter italic",children:["Á≤æÈùàË™û ",(0,s.jsx)("span",{className:"text-indigo-500",children:"Â∞çÊà∞"})]})}),u[0]=t):t=u[0],u[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("span",{className:"text-2xl",children:"üéì"}),u[1]=a):a=u[1],u[2]!==N?(l=(0,s.jsx)("button",{onClick:N,className:"px-3 py-2 text-slate-300 hover:text-white transition-colors flex items-center gap-2",title:"ÈÅäÊà≤ÊïôÂ≠∏",children:a}),u[2]=N,u[3]=l):l=u[3],u[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)("span",{className:"text-2xl",children:"üìä"}),u[4]=r):r=u[4],u[5]!==j?(i=(0,s.jsx)("button",{onClick:j,className:"px-3 py-2 text-slate-300 hover:text-white transition-colors flex items-center gap-2",title:"ÊéíË°åÊ¶ú",children:r}),u[5]=j,u[6]=i):i=u[6],u[7]!==b||u[8]!==p?(c=()=>b(!p),u[7]=b,u[8]=p,u[9]=c):c=u[9],u[10]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)("span",{className:"text-2xl",children:"üîî"}),u[10]=d):d=u[10],u[11]!==f?(o=f>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center font-bold",children:f}),u[11]=f,u[12]=o):o=u[12],u[13]!==c||u[14]!==o?(x=(0,s.jsxs)("button",{onClick:c,className:"relative px-3 py-2 text-slate-300 hover:text-white transition-colors",children:[d,o]}),u[13]=c,u[14]=o,u[15]=x):x=u[15],u[16]!==g?(m=(0,s.jsx)("button",{onClick:g,className:"px-4 py-2 text-sm font-medium text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:"ÁôªÂá∫"}),u[16]=g,u[17]=m):m=u[17],u[18]!==m||u[19]!==l||u[20]!==i||u[21]!==x?(h=(0,s.jsxs)("nav",{className:"h-16 border-b border-slate-800 bg-[#1e293b]/80 backdrop-blur-md flex items-center justify-between px-6 flex-shrink-0 z-50",children:[t,(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[l,i,x,m]})]}),u[18]=m,u[19]=l,u[20]=i,u[21]=x,u[22]=h):h=u[22],h}var c=e.i(85333);function d(e){let a,l,i=(0,n.c)(12),{user:d,selectedAvatar:o,setShowAvatarPicker:x,openProfileEdit:m,startMatching:h,isMatching:u}=e,[f,p]=(0,t.useState)("turn-based"),b="turn-based"===f,g=b?d.rating:d.rts_rating,j=b?d.ranked_games_played:d.rts_ranked_games_played,N=g||1500,v=10>(j||0);return i[0]!==u||i[1]!==v||i[2]!==b||i[3]!==m||i[4]!==N||i[5]!==o||i[6]!==x||i[7]!==h||i[8]!==d?(a=d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"relative group",children:(0,s.jsx)("div",{className:"w-28 h-28 bg-gradient-to-tr from-indigo-600 to-purple-400 rounded-full border-4 border-slate-900 overflow-hidden shadow-2xl transition-transform group-hover:scale-105 cursor-pointer",onClick:()=>x(!0),children:(0,s.jsx)("img",{src:o||`https://api.dicebear.com/7.x/avataaars/svg?seed=${r.AVATAR_OPTIONS[0]}`,alt:d.username,className:"w-full h-full object-cover"})})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white tracking-tight",children:d.username}),(0,s.jsx)("button",{onClick:m,className:"text-slate-500 hover:text-indigo-400 transition-colors",title:"Á∑®ËºØÂÄã‰∫∫Ë≥áÊñô",children:"‚úèÔ∏è"})]}),d.bio&&(0,s.jsx)("p",{className:"text-sm text-slate-400 mt-1 italic",children:d.bio}),(0,s.jsxs)("div",{className:"w-full mt-6 bg-slate-900/50 p-1 rounded-xl border border-slate-700 flex relative",children:[(0,s.jsx)("button",{onClick:()=>p("turn-based"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all duration-300 relative z-10 ${b?"text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:"ÂõûÂêàÂà∂"}),(0,s.jsx)("button",{onClick:()=>p("rts"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all duration-300 relative z-10 ${!b?"text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:"Âç≥ÊôÇÂà∂"}),(0,s.jsx)("div",{className:`absolute top-1 bottom-1 w-[calc(50%-4px)] bg-gradient-to-r rounded-lg transition-all duration-300 ${b?"left-1 from-indigo-600 to-blue-600":"left-[calc(50%+0px)] from-pink-600 to-rose-600"}`})]}),(0,s.jsx)("div",{className:"mt-6 flex flex-col items-center",children:v?(0,s.jsxs)("div",{className:"flex items-center gap-1 relative group",children:[(0,s.jsx)("p",{className:"text-sm text-amber-400",children:"ÂÆöÁ¥ö‰∏≠"}),(0,s.jsx)("span",{className:"text-xs text-amber-500 cursor-help",children:"‚ìò"}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-3 px-4 py-2.5 bg-slate-900 text-slate-100 text-xs rounded-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap pointer-events-none z-10 shadow-xl border border-slate-700",children:(0,s.jsxs)("div",{className:"relative",children:["ÂÆåÊàê 10 Â†¥Á©çÂàÜÂ∞çÊà∞ÂæåÂç≥ÂèØÊü•ÁúãÂàÜÊï∏",(0,s.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-px",children:(0,s.jsx)("div",{className:"border-4 border-transparent border-t-slate-900"})})]})})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,s.jsx)(c.default,{rating:N,size:64}),(0,s.jsxs)("p",{className:"text-sm text-slate-300",children:["Rating: ",(0,s.jsx)("span",{className:`font-bold ${b?"text-amber-400":"text-pink-400"}`,children:N})]})]})}),(0,s.jsx)("div",{className:"w-full mt-6 space-y-4",children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-amber-400 mb-3 uppercase tracking-wider",children:"Á©çÂàÜÂ∞çÊà∞"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Âãù"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.ranked_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Êïó"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.ranked_games_played||0)-(d.ranked_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Á∏Ω"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.ranked_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Áéá"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.ranked_games_played>0?Math.round(d.ranked_games_won/d.ranked_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-blue-400 mb-3 uppercase tracking-wider",children:"‰∏ÄËà¨Â∞çÊà∞"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Âãù"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.casual_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Êïó"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.casual_games_played||0)-(d.casual_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Á∏Ω"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.casual_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Áéá"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.casual_games_played>0?Math.round(d.casual_games_won/d.casual_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-purple-400 mb-3 uppercase tracking-wider",children:"Â•ΩÂèãÂ∞çÊà∞"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Âãù"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.custom_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Êïó"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.custom_games_played||0)-(d.custom_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Á∏Ω"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.custom_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Áéá"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.custom_games_played>0?Math.round(d.custom_games_won/d.custom_games_played*100):0,"%"]})]})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-pink-400 mb-3 uppercase tracking-wider",children:"Á©çÂàÜÂ∞çÊà∞ (RTS)"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Âãù"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.rts_ranked_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Êïó"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.rts_ranked_games_played||0)-(d.rts_ranked_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Á∏Ω"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.rts_ranked_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Áéá"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.rts_ranked_games_played>0?Math.round(d.rts_ranked_games_won/d.rts_ranked_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-blue-400 mb-3 uppercase tracking-wider",children:"‰∏ÄËà¨Â∞çÊà∞ (RTS)"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Âãù"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.rts_casual_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Êïó"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.rts_casual_games_played||0)-(d.rts_casual_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Á∏Ω"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.rts_casual_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Áéá"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.rts_casual_games_played>0?Math.round(d.rts_casual_games_won/d.rts_casual_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-purple-400 mb-3 uppercase tracking-wider",children:"Â•ΩÂèãÂ∞çÊà∞ (RTS)"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Âãù"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.rts_custom_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Êïó"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.rts_custom_games_played||0)-(d.rts_custom_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Á∏Ω"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.rts_custom_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"Áéá"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.rts_custom_games_played>0?Math.round(d.rts_custom_games_won/d.rts_custom_games_played*100):0,"%"]})]})]})]})]})}),(0,s.jsx)("div",{className:"w-full mt-4 space-y-3",children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>h("ranked"),disabled:u,className:"w-full bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"üèÜ"})," Á©çÂàÜÂ∞çÊà∞"]}),(0,s.jsxs)("button",{onClick:()=>h("casual"),disabled:u,className:"w-full bg-slate-700 hover:bg-slate-600 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"üéÆ"})," ‰∏ÄËà¨Â∞çÊà∞"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>h("ranked_rts"),disabled:u,className:"w-full bg-gradient-to-r from-pink-500 to-rose-600 hover:from-pink-600 hover:to-rose-700 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"‚ö°"})," Á©çÂàÜÂ∞çÊà∞ (RTS)"]}),(0,s.jsxs)("button",{onClick:()=>h("casual_rts"),disabled:u,className:"w-full bg-slate-700 hover:bg-slate-600 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"üéÆ"})," ‰∏ÄËà¨Â∞çÊà∞ (RTS)"]})]})})]}),i[0]=u,i[1]=v,i[2]=b,i[3]=m,i[4]=N,i[5]=o,i[6]=x,i[7]=h,i[8]=d,i[9]=a):a=i[9],i[10]!==a?(l=(0,s.jsx)("section",{className:"w-80 bg-[#1e293b] border-r border-slate-800 flex flex-col p-6 flex-shrink-0 overflow-y-auto",children:(0,s.jsx)("div",{className:"flex flex-col items-center flex-1",children:a})}),i[10]=a,i[11]=l):l=i[11],l}function o(e){let t,a,l,i,c,d,o,x,m,h=(0,n.c)(23),{friends:u,onlineUsers:f,openChat:p,viewUserDetail:b,sendFriendRequest:g}=e;return h[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("span",{children:"üë•"}),h[0]=t):t=h[0],h[1]!==u.length?(a=(0,s.jsxs)("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[t," ÊàëÁöÑÂ•ΩÂèã (",u.length,")"]}),h[1]=u.length,h[2]=a):a=h[2],h[3]!==u||h[4]!==p||h[5]!==b?(l=0===u.length?(0,s.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,s.jsx)("p",{children:"ÈÇÑÊ≤íÊúâÂ•ΩÂèã"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"Âæû‰∏ãÊñπÁöÑÁ∑ö‰∏äÁî®Êà∂‰∏≠Ê∑ªÂä†Â•ΩÂèãÂêßÔºÅ"})]}):(0,s.jsx)("div",{className:"space-y-2",children:u.map(e=>(0,s.jsxs)("div",{onClick:()=>b(e.id),className:"bg-slate-800/50 p-3 rounded-xl border border-slate-700/50 hover:border-indigo-500/50 transition-all cursor-pointer relative group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-10 h-10 rounded-full border-2 border-indigo-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium text-white",children:e.username}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:e.seconds_offline<30?(0,s.jsx)("span",{className:"text-green-400",children:"‚óè Á∑ö‰∏ä"}):(0,r.formatLastOnline)(e.seconds_offline)})]})]}),(0,s.jsx)("button",{onClick:s=>{s.stopPropagation(),p(e)},className:"absolute top-2 right-2 p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-full transition-colors",title:"ËÅäÂ§©",children:"üí¨"})]},e.id))}),h[3]=u,h[4]=p,h[5]=b,h[6]=l):l=h[6],h[7]!==a||h[8]!==l?(i=(0,s.jsxs)("div",{className:"mb-8",children:[a,l]}),h[7]=a,h[8]=l,h[9]=i):i=h[9],h[10]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)("span",{children:"üåê"}),h[10]=c):c=h[10],h[11]!==f.length?(d=(0,s.jsxs)("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[c," Á∑ö‰∏äÁé©ÂÆ∂ (",f.length,")"]}),h[11]=f.length,h[12]=d):d=h[12],h[13]!==f||h[14]!==g||h[15]!==b?(o=0===f.length?(0,s.jsx)("div",{className:"text-center py-8 text-slate-500",children:(0,s.jsx)("p",{children:"ÁõÆÂâçÊ≤íÊúâÂÖ∂‰ªñÁ∑ö‰∏äÁé©ÂÆ∂"})}):(0,s.jsx)("div",{className:"space-y-2",children:f.map(e=>(0,s.jsxs)("div",{className:"w-full bg-slate-800/30 p-3 rounded-xl flex items-center gap-3 border border-slate-700/30",children:[(0,s.jsxs)("button",{onClick:()=>b(e.id),className:"flex items-center gap-3 flex-1 hover:opacity-80 transition-opacity",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-10 h-10 rounded-full border-2 border-slate-600"}),(0,s.jsxs)("div",{className:"flex-1 text-left",children:[(0,s.jsx)("p",{className:"font-medium text-white",children:e.username}),(0,s.jsx)("p",{className:"text-xs text-green-400",children:"‚óè Á∑ö‰∏ä"})]})]}),"pending"===e.friendship_status?(0,s.jsx)("span",{className:"px-3 py-1 text-slate-500 text-sm flex-shrink-0 cursor-default",children:"Â∑≤Áî≥Ë´ã"}):(0,s.jsx)("button",{onClick:s=>{s.stopPropagation(),g(e.id)},className:"px-3 py-1 bg-indigo-500 hover:bg-indigo-600 text-white text-sm rounded-lg transition-colors flex-shrink-0",children:"Âä†Â•ΩÂèã"})]},e.id))}),h[13]=f,h[14]=g,h[15]=b,h[16]=o):o=h[16],h[17]!==d||h[18]!==o?(x=(0,s.jsxs)("div",{children:[d,o]}),h[17]=d,h[18]=o,h[19]=x):x=h[19],h[20]!==i||h[21]!==x?(m=(0,s.jsxs)("section",{className:"w-80 flex flex-col bg-[#0f172a] p-6 overflow-y-auto border-l border-slate-800 flex-shrink-0",children:[i,x]}),h[20]=i,h[21]=x,h[22]=m):m=h[22],m}function x({user:e}){let r=(0,a.useRouter)(),[n,i]=(0,t.useState)([]);async function c(){try{let e=await (0,l.api)("/api/matchmaking/active");e.ok&&i(await e.json())}catch(e){console.error("Failed to fetch active battles:",e)}}(0,t.useEffect)(()=>{c();let e=setInterval(c,1e4);return()=>clearInterval(e)},[]);let d=n.filter(s=>e&&(s.player1_id===e.id||s.player2_id===e.id)),o=n.filter(s=>!e||s.player1_id!==e.id&&s.player2_id!==e.id),x=({battle:e,isMyBattle:t})=>(0,s.jsxs)("div",{className:`bg-slate-800/50 rounded-xl p-3 border transition-all cursor-pointer group ${t?"border-indigo-500/50 hover:border-indigo-400 hover:bg-indigo-900/20":"border-slate-700/50 hover:border-indigo-500/30 hover:bg-slate-800"}`,onClick:()=>r.push(`/battle?id=${e.id}`),children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:`text-xs px-2 py-0.5 rounded-full ${e.mode.includes("ranked")?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":e.mode.includes("custom")?"bg-pink-500/20 text-pink-400 border border-pink-500/30":"bg-blue-500/20 text-blue-400 border border-blue-500/30"}`,children:e.mode.includes("ranked")?"Á©çÂàÜ":e.mode.includes("custom")?"Â•ΩÂèã":"‰∏ÄËà¨"}),(0,s.jsx)("span",{className:`text-xs px-2 py-0.5 rounded-full ${e.mode.includes("rts")?"bg-purple-500/20 text-purple-400 border border-purple-500/30":"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30"}`,children:e.mode.includes("rts")?"Âç≥ÊôÇ":"ÂõûÂêà"}),t&&(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full bg-green-500/20 text-green-400 border border-green-500/30 animate-pulse",children:"ÈÄ≤Ë°å‰∏≠"})]}),(0,s.jsx)("span",{className:"text-xs text-slate-500",children:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,s.jsx)("img",{src:e.player1_avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.player1_name}`,alt:e.player1_name,className:"w-8 h-8 rounded-full bg-slate-700"}),(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-slate-200 truncate",children:e.player1_name}),(0,s.jsx)("div",{className:"text-xs text-slate-500",children:e.player1_rating?`Rating: ${e.player1_rating}`:"Unranked"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-slate-600 font-bold text-sm",children:"VS"}),!t&&(0,s.jsx)("span",{className:"text-[10px] text-indigo-400 opacity-0 group-hover:opacity-100 transition-opacity",children:"ËßÄÊà∞"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0 justify-end text-right",children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-slate-200 truncate",children:e.player2_name}),(0,s.jsx)("div",{className:"text-xs text-slate-500",children:e.player2_rating?`Rating: ${e.player2_rating}`:"Unranked"})]}),(0,s.jsx)("img",{src:e.player2_avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.player2_name}`,alt:e.player2_name,className:"w-8 h-8 rounded-full bg-slate-700"})]})]})]});return(0,s.jsxs)("div",{className:"flex-1 bg-slate-900/50 border-x border-slate-800 flex flex-col min-w-0",children:[d.length>0&&(0,s.jsxs)("div",{className:"flex-shrink-0",children:[(0,s.jsx)("div",{className:"p-4 border-b border-slate-800 bg-indigo-900/10",children:(0,s.jsxs)("h2",{className:"text-lg font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{children:"‚öîÔ∏è"})," ÊàëÁöÑÂ∞çÊà∞"]})}),(0,s.jsx)("div",{className:"p-4 space-y-3 border-b border-slate-800",children:d.map(e=>(0,s.jsx)(x,{battle:e,isMyBattle:!0},e.id))})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,s.jsx)("div",{className:"p-4 border-b border-slate-800",children:(0,s.jsxs)("h2",{className:"text-lg font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),"Ê≠£Âú®ÈÄ≤Ë°åÁöÑÂ∞çÊà∞"]})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:0===o.length?(0,s.jsx)("div",{className:"text-center py-12 text-slate-500",children:(0,s.jsx)("p",{children:"ÁõÆÂâçÊ≤íÊúâÂÖ∂‰ªñÊ≠£Âú®ÈÄ≤Ë°åÁöÑÂ∞çÊà∞"})}):o.map(e=>(0,s.jsx)(x,{battle:e,isMyBattle:!1},e.id))})]})]})}function m(e){let t,a,i,c,d,o,x=(0,n.c)(14),{showAvatarPicker:m,setShowAvatarPicker:h,currentAvatar:u,onUpdate:f}=e;x[0]!==f||x[1]!==h?(t=async function(e){let s=`https://api.dicebear.com/7.x/avataaars/svg?seed=${e}`;try{let e=await (0,l.api)("/api/users/me",{method:"PATCH",body:JSON.stringify({avatar_url:s})});if(e.ok){let s=await e.json();f(s),h(!1)}}catch(e){console.error("Failed to update avatar:",e)}},x[0]=f,x[1]=h,x[2]=t):t=x[2];let p=t;return m?(x[3]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"ÈÅ∏Êìá‰Ω†ÁöÑÈ†≠ÂÉè"}),x[3]=a):a=x[3],x[4]!==h?(i=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[a,(0,s.jsx)("button",{onClick:()=>h(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),x[4]=h,x[5]=i):i=x[5],x[6]!==u||x[7]!==p?(c=r.AVATAR_OPTIONS.map(e=>{let t=`https://api.dicebear.com/7.x/avataaars/svg?seed=${e}`,a=u===t;return(0,s.jsxs)("button",{onClick:()=>p(e),className:`relative w-full aspect-square rounded-xl overflow-hidden border-4 transition-all hover:scale-105 ${a?"border-indigo-500 shadow-lg shadow-indigo-500/50":"border-slate-700 hover:border-slate-500"}`,children:[(0,s.jsx)("img",{src:t,alt:e,className:"w-full h-full object-cover bg-gradient-to-br from-indigo-600 to-purple-400"}),a&&(0,s.jsx)("div",{className:"absolute inset-0 bg-indigo-500/20 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-3xl",children:"‚úì"})})]},e)}),x[6]=u,x[7]=p,x[8]=c):c=x[8],x[9]!==c?(d=(0,s.jsx)("div",{className:"grid grid-cols-5 gap-4 max-h-96 overflow-y-auto p-2",children:c}),x[9]=c,x[10]=d):d=x[10],x[11]!==i||x[12]!==d?(o=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-2xl border border-slate-700 shadow-2xl",children:[i,d]})}),x[11]=i,x[12]=d,x[13]=o):o=x[13],o):null}function h({showProfileEdit:e,setShowProfileEdit:a,user:r,onUpdate:n}){let[i,c]=(0,t.useState)(""),[d,o]=(0,t.useState)("");async function x(){try{let e=await (0,l.api)("/api/users/me",{method:"PATCH",body:JSON.stringify({username:i,bio:d})});if(e.ok){let s=await e.json();n(s),a(!1)}else{let s=await e.json();alert(s.error||"Êõ¥Êñ∞Â§±Êïó")}}catch(e){console.error("Failed to update profile:",e),alert("Êõ¥Êñ∞Â§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶")}}return((0,t.useEffect)(()=>{e&&r&&(c(r.username||""),o(r.bio||""))},[e,r]),e)?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-md border border-slate-700 shadow-2xl",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"Á∑®ËºØÂÄã‰∫∫Ë≥áÊñô"}),(0,s.jsx)("button",{onClick:()=>a(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"‰ΩøÁî®ËÄÖÂêçÁ®±"}),(0,s.jsx)("input",{type:"text",value:i,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-indigo-500 transition-colors",placeholder:"Ëº∏ÂÖ•‰ΩøÁî®ËÄÖÂêçÁ®±",maxLength:20})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"ÂÄã‰∫∫Á∞°‰ªã"}),(0,s.jsx)("textarea",{value:d,onChange:e=>o(e.target.value),className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-indigo-500 transition-colors resize-none",placeholder:"ÂØ´ÈªûÈóúÊñºËá™Â∑±ÁöÑ‰∫ãÊÉÖ...",rows:3,maxLength:100}),(0,s.jsxs)("p",{className:"text-xs text-slate-500 mt-1 text-right",children:[d.length," / 100"]})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)("button",{onClick:()=>a(!1),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"ÂèñÊ∂à"}),(0,s.jsx)("button",{onClick:x,className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-medium transition-colors",children:"ÂÑ≤Â≠ò"})]})]})}):null}function u(e){let a,l,i,d,o,x,m,h,u,p,b,g,j,N,v,w,_=(0,n.c)(96),{showUserDetail:y,setShowUserDetail:k,selectedUser:S,addFriend:C,removeFriend:$,onChallenge:P}=e,[I,R]=(0,t.useState)("turn-based");if(!y||!S)return null;let T=f;_[0]!==S.casual_games_played||_[1]!==S.casual_games_won||_[2]!==S.custom_games_played||_[3]!==S.custom_games_won||_[4]!==S.ranked_games_played||_[5]!==S.ranked_games_won||_[6]!==S.rating||_[7]!==S.rts_casual_games_played||_[8]!==S.rts_casual_games_won||_[9]!==S.rts_custom_games_played||_[10]!==S.rts_custom_games_won||_[11]!==S.rts_ranked_games_played||_[12]!==S.rts_ranked_games_won||_[13]!==S.rts_rating||_[14]!==I?(a=()=>"rts"===I?{rating:S.rts_rating,rankedPlayed:S.rts_ranked_games_played||0,rankedWon:S.rts_ranked_games_won||0,casualPlayed:S.rts_casual_games_played||0,casualWon:S.rts_casual_games_won||0,customPlayed:S.rts_custom_games_played||0,customWon:S.rts_custom_games_won||0}:{rating:S.rating,rankedPlayed:S.ranked_games_played||0,rankedWon:S.ranked_games_won||0,casualPlayed:S.casual_games_played||0,casualWon:S.casual_games_won||0,customPlayed:S.custom_games_played||0,customWon:S.custom_games_won||0},_[0]=S.casual_games_played,_[1]=S.casual_games_won,_[2]=S.custom_games_played,_[3]=S.custom_games_won,_[4]=S.ranked_games_played,_[5]=S.ranked_games_won,_[6]=S.rating,_[7]=S.rts_casual_games_played,_[8]=S.rts_casual_games_won,_[9]=S.rts_custom_games_played,_[10]=S.rts_custom_games_won,_[11]=S.rts_ranked_games_played,_[12]=S.rts_ranked_games_won,_[13]=S.rts_rating,_[14]=I,_[15]=a):a=_[15];let O=a;if(_[16]!==C||_[17]!==O||_[18]!==P||_[19]!==$||_[20]!==S.avatar_url||_[21]!==S.bio||_[22]!==S.id||_[23]!==S.is_friend||_[24]!==S.seconds_offline||_[25]!==S.username||_[26]!==k||_[27]!==I){let e,t,a,n,f,g,j,N,v,w,y,F,M;l=O(),i="fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",h="bg-[#1e293b] p-6 rounded-2xl w-full max-w-lg border border-slate-700 shadow-2xl max-h-[90vh] overflow-y-auto",_[38]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"Áé©ÂÆ∂Ë≥áÊñô"}),_[38]=e):e=_[38],_[39]!==k?(u=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[e,(0,s.jsx)("button",{onClick:()=>k(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),_[39]=k,_[40]=u):u=_[40];let E=S.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${S.username}`;_[41]!==S.username||_[42]!==E?(t=(0,s.jsx)("img",{src:E,alt:S.username,className:"w-24 h-24 rounded-full border-4 border-indigo-500 mb-4"}),_[41]=S.username,_[42]=E,_[43]=t):t=_[43],_[44]!==S.username?(a=(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:S.username}),_[44]=S.username,_[45]=a):a=_[45],_[46]!==S.seconds_offline?(n=S.seconds_offline<300?(0,s.jsx)("p",{className:"text-green-400 text-sm mt-1",children:"‚óè Á∑ö‰∏ä"}):(0,s.jsxs)("p",{className:"text-slate-400 text-sm mt-1",children:["Èõ¢Á∑ö ",(0,r.formatLastOnline)(S.seconds_offline)]}),_[46]=S.seconds_offline,_[47]=n):n=_[47],_[48]!==S.bio?(f=S.bio&&(0,s.jsx)("p",{className:"text-slate-300 text-sm mt-3 text-center italic",children:S.bio}),_[48]=S.bio,_[49]=f):f=_[49],_[50]!==P||_[51]!==S.id||_[52]!==S.is_friend?(g=S.is_friend&&P&&(0,s.jsxs)("button",{onClick:()=>P(S.id),className:"px-6 py-2 bg-amber-600 hover:bg-amber-500 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[(0,s.jsx)("span",{children:"‚öîÔ∏è"})," Á¥ÑÊà∞"]}),_[50]=P,_[51]=S.id,_[52]=S.is_friend,_[53]=g):g=_[53],_[54]!==C||_[55]!==$||_[56]!==S.id||_[57]!==S.is_friend||_[58]!==k?(j=S.is_friend?$&&(0,s.jsx)("button",{onClick:()=>{confirm("Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄô‰ΩçÂ•ΩÂèãÂóéÔºü")&&($(S.id),k(!1))},className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-medium transition-colors",children:"Âà™Èô§Â•ΩÂèã"}):(0,s.jsx)("button",{onClick:()=>C(S.id),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-medium transition-colors",children:"Âä†ÁÇ∫Â•ΩÂèã"}),_[54]=C,_[55]=$,_[56]=S.id,_[57]=S.is_friend,_[58]=k,_[59]=j):j=_[59],_[60]!==g||_[61]!==j?(N=(0,s.jsxs)("div",{className:"flex gap-3 mt-4 w-full justify-center",children:[g,j]}),_[60]=g,_[61]=j,_[62]=N):N=_[62],p=(0,s.jsxs)("div",{className:"flex flex-col items-center mb-6",children:[t,a,n,f,l.rating&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(c.default,{rating:l.rating,size:64})}),N]}),_[63]===Symbol.for("react.memo_cache_sentinel")?(v=()=>R("turn-based"),_[63]=v):v=_[63];let A=`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${"turn-based"===I?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`;_[64]!==A?(w=(0,s.jsx)("button",{onClick:v,className:A,children:"ÂõûÂêàÂà∂"}),_[64]=A,_[65]=w):w=_[65],_[66]===Symbol.for("react.memo_cache_sentinel")?(y=()=>R("rts"),_[66]=y):y=_[66];let z=`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${"rts"===I?"bg-pink-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`;_[67]!==z?(F=(0,s.jsx)("button",{onClick:y,className:z,children:"Âç≥ÊôÇÂà∂ (RTS)"}),_[67]=z,_[68]=F):F=_[68],_[69]!==w||_[70]!==F?(b=(0,s.jsxs)("div",{className:"flex p-1 bg-slate-900/50 rounded-xl mb-6",children:[w,F]}),_[69]=w,_[70]=F,_[71]=b):b=_[71],d="space-y-4 mb-6",_[72]===Symbol.for("react.memo_cache_sentinel")?(M=(0,s.jsx)("h4",{className:"text-xs font-bold text-amber-400 mb-3 uppercase tracking-wider",children:"Á©çÂàÜÂ∞çÊà∞"}),_[72]=M):M=_[72];let q=l.rankedPlayed<10?(0,s.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,s.jsx)("p",{className:"text-sm text-amber-400 text-center font-medium",children:"ÂÆöÁ¥ö‰∏≠"}),(0,s.jsx)("p",{className:"text-xs text-slate-400 text-center mt-2",children:"ÂÆåÊàê 10 Â†¥ÂÆöÁ¥öË≥ΩÂæåÂ∞áÈ°ØÁ§∫ÊÆµ‰Ωç"}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"Â∑≤ÂÆåÊàê"}),(0,s.jsxs)("span",{className:"font-bold text-white",children:[l.rankedPlayed,"/10"]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÂãùÂ†¥"}),(0,s.jsx)("span",{className:"font-bold text-green-400",children:l.rankedWon})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs block",children:"ÊÆµ‰Ωç"}),(0,s.jsx)("span",{className:`font-bold text-lg ${(0,r.getRankInfo)(l.rating).color}`,children:(0,r.getRankInfo)(l.rating).nameZh})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs block",children:"Rating"}),(0,s.jsx)("span",{className:"font-bold text-lg text-amber-400",children:l.rating})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÂãùÂ†¥"}),(0,s.jsx)("span",{className:"font-bold text-green-400",children:l.rankedWon})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÊïóÂ†¥"}),(0,s.jsx)("span",{className:"font-bold text-red-400",children:l.rankedPlayed-l.rankedWon})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"Á∏ΩÂ†¥Ê¨°"}),(0,s.jsx)("span",{className:"font-bold text-white",children:l.rankedPlayed})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÂãùÁéá"}),(0,s.jsxs)("span",{className:"font-bold text-emerald-400",children:[l.rankedPlayed>0?Math.round(l.rankedWon/l.rankedPlayed*100):0,"%"]})]})]})]});_[73]!==q?(o=(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl",children:[M,q]}),_[73]=q,_[74]=o):o=_[74],x=T("‰∏ÄËà¨Â∞çÊà∞",l.casualPlayed,l.casualWon,"text-blue-400"),m=T("Â•ΩÂèãÂ∞çÊà∞",l.customPlayed,l.customWon,"text-purple-400"),_[16]=C,_[17]=O,_[18]=P,_[19]=$,_[20]=S.avatar_url,_[21]=S.bio,_[22]=S.id,_[23]=S.is_friend,_[24]=S.seconds_offline,_[25]=S.username,_[26]=k,_[27]=I,_[28]=l,_[29]=i,_[30]=d,_[31]=o,_[32]=x,_[33]=m,_[34]=h,_[35]=u,_[36]=p,_[37]=b}else l=_[28],i=_[29],d=_[30],o=_[31],x=_[32],m=_[33],h=_[34],u=_[35],p=_[36],b=_[37];return _[75]!==d||_[76]!==o||_[77]!==x||_[78]!==m?(g=(0,s.jsxs)("div",{className:d,children:[o,x,m]}),_[75]=d,_[76]=o,_[77]=x,_[78]=m,_[79]=g):g=_[79],_[80]!==l.rankedPlayed||_[81]!==l.rating?(j=l.rankedPlayed>=10&&l.rating&&(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl mb-6",children:[(0,s.jsx)("h4",{className:"text-sm font-bold text-white mb-3",children:"Rating ÂàÜ‰Ωà"}),(0,s.jsxs)("div",{className:"relative pt-6 pb-2",children:[(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 flex justify-between text-[10px] text-slate-500",children:[(0,s.jsx)("span",{style:{left:"0%"},className:"absolute",children:"0"}),(0,s.jsx)("span",{style:{left:"14%"},className:"absolute",children:"800"}),(0,s.jsx)("span",{style:{left:"28%"},className:"absolute",children:"1200"}),(0,s.jsx)("span",{style:{left:"42%"},className:"absolute",children:"1500"}),(0,s.jsx)("span",{style:{left:"57%"},className:"absolute",children:"1800"}),(0,s.jsx)("span",{style:{left:"71%"},className:"absolute",children:"2200"}),(0,s.jsx)("span",{style:{left:"85%"},className:"absolute",children:"2500"})]}),(0,s.jsxs)("div",{className:"relative h-4 bg-slate-800 rounded-full overflow-hidden mt-1",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-slate-600 via-amber-700 via-slate-400 via-yellow-500 via-cyan-500 via-blue-600 to-purple-600 opacity-50"}),(0,s.jsx)("div",{className:"absolute top-0 bottom-0 w-1 bg-white shadow-[0_0_10px_rgba(255,255,255,0.8)] z-10",style:{left:`${Math.min(Math.max(l.rating/3e3*100,0),100)}%`},children:(0,s.jsx)("div",{className:"absolute -top-7 left-1/2 transform -translate-x-1/2 bg-slate-800 text-white text-xs font-bold px-2 py-0.5 rounded border border-slate-600 whitespace-nowrap",children:l.rating})})]}),(0,s.jsxs)("div",{className:"flex justify-between items-start mt-2 px-1",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-500",children:"Èêµ"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"0-800"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-amber-700",children:"ÈäÖ"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"800+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-300",children:"ÈäÄ"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"1200+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-yellow-500",children:"Èáë"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"1500+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-cyan-400",children:"ÁôΩÈáë"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"1800+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-blue-400",children:"ÈëΩÁü≥"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"2200+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-purple-400",children:"Â§ßÂ∏´"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"2500+"})]})]})]})]}),_[80]=l.rankedPlayed,_[81]=l.rating,_[82]=j):j=_[82],_[83]!==k?(N=(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("button",{onClick:()=>k(!1),className:"w-full px-4 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-medium transition-colors",children:"ÈóúÈñâ"})}),_[83]=k,_[84]=N):N=_[84],_[85]!==g||_[86]!==j||_[87]!==N||_[88]!==h||_[89]!==u||_[90]!==p||_[91]!==b?(v=(0,s.jsxs)("div",{className:h,children:[u,p,b,g,j,N]}),_[85]=g,_[86]=j,_[87]=N,_[88]=h,_[89]=u,_[90]=p,_[91]=b,_[92]=v):v=_[92],_[93]!==i||_[94]!==v?(w=(0,s.jsx)("div",{className:i,children:v}),_[93]=i,_[94]=v,_[95]=w):w=_[95],w}function f(e,t,a,l){let r=t>0?Math.round(a/t*100):0;return(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:`text-xs font-bold ${l} mb-3 uppercase tracking-wider`,children:e}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÂãùÂ†¥"}),(0,s.jsx)("span",{className:"font-bold text-green-400",children:a})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÊïóÂ†¥"}),(0,s.jsx)("span",{className:"font-bold text-red-400",children:t-a})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"Á∏ΩÂ†¥Ê¨°"}),(0,s.jsx)("span",{className:"font-bold text-white",children:t})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ÂãùÁéá"}),(0,s.jsxs)("span",{className:"font-bold text-emerald-400",children:[r,"%"]})]})]})]})}function p(e){let t,a,l,i,c,d=(0,n.c)(16),{showFriendRequests:o,setShowFriendRequests:x,friendRequests:m,acceptFriendRequest:h,rejectFriendRequest:u,battleInvites:f,acceptBattleInvite:p,rejectBattleInvite:b}=e;d[0]!==f?(t=void 0===f?[]:f,d[0]=f,d[1]=t):t=d[1];let g=t;if(!o)return null;let j=m.length>0||g.length>0;return d[2]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"ÈÄöÁü•‰∏≠ÂøÉ"}),d[2]=a):a=d[2],d[3]!==x?(l=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[a,(0,s.jsx)("button",{onClick:()=>x(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),d[3]=x,d[4]=l):l=d[4],d[5]!==p||d[6]!==h||d[7]!==g||d[8]!==m||d[9]!==j||d[10]!==b||d[11]!==u?(i=j?(0,s.jsxs)("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[g.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-bold text-amber-400 mb-3 uppercase tracking-wider",children:"Â∞çÊà∞ÈÇÄË´ã"}),(0,s.jsx)("div",{className:"space-y-3",children:g.map(e=>(0,s.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-xl border border-amber-500/30",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-12 h-12 rounded-full border-2 border-amber-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("p",{className:"font-medium text-white",children:[(0,s.jsx)("span",{className:"text-amber-400",children:e.username})," ÈÇÄË´ã‰Ω†ÈÄ≤Ë°åÂ∞çÊà∞"]}),(0,s.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:new Date(e.created_at).toLocaleTimeString()})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>p&&p(e.id),className:"flex-1 px-4 py-2 bg-amber-600 hover:bg-amber-500 text-white rounded-lg font-medium transition-colors",children:"Êé•ÂèóÊåëÊà∞"}),(0,s.jsx)("button",{onClick:()=>b&&b(e.id),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"ÊãíÁµï"})]})]},e.id))})]}),m.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-bold text-indigo-400 mb-3 uppercase tracking-wider",children:"Â•ΩÂèãË´ãÊ±Ç"}),(0,s.jsx)("div",{className:"space-y-3",children:m.map(e=>(0,s.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-12 h-12 rounded-full border-2 border-indigo-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium text-white",children:e.username}),e.games_played>=10?(0,s.jsxs)("p",{className:`text-sm ${(0,r.getRankInfo)(e.rating).color}`,children:[(0,r.getRankInfo)(e.rating).nameZh," ¬∑ ",e.rating]}):(0,s.jsx)("p",{className:"text-sm text-amber-400",children:"ÂÆöÁ¥ö‰∏≠"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>h(e.request_id),className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg font-medium transition-colors",children:"Êé•Âèó"}),(0,s.jsx)("button",{onClick:()=>u(e.request_id),className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-medium transition-colors",children:"ÊãíÁµï"})]})]},e.request_id))})]})]}):(0,s.jsx)("div",{className:"text-center py-8 text-slate-500",children:(0,s.jsx)("p",{children:"ÁõÆÂâçÊ≤íÊúâÊñ∞ÁöÑÈÄöÁü•"})}),d[5]=p,d[6]=h,d[7]=g,d[8]=m,d[9]=j,d[10]=b,d[11]=u,d[12]=i):i=d[12],d[13]!==l||d[14]!==i?(c=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-md border border-slate-700 shadow-2xl",children:[l,i]})}),d[13]=l,d[14]=i,d[15]=c):c=d[15],c}function b({showChat:e,setShowChat:a,chatFriend:n,user:i}){let[c,d]=(0,t.useState)([]),[o,x]=(0,t.useState)(""),m=(0,t.useRef)(null);(0,t.useEffect)(()=>{if(e&&n){u();let e=setInterval(u,3e3);return()=>clearInterval(e)}},[e,n]),(0,t.useEffect)(()=>{h()},[c]);let h=()=>{m.current?.scrollIntoView({behavior:"smooth"})};async function u(){if(n)try{let e=await (0,l.api)(`/api/friends/messages/${n.id}`);if(e.ok){let s=await e.json();d(s)}}catch(e){console.error("Failed to load messages:",e)}}async function f(){if(o.trim()&&n)try{(await (0,l.api)(`/api/friends/send-message/${n.id}`,{method:"POST",body:JSON.stringify({content:o})})).ok&&(x(""),u())}catch(e){console.error("Failed to send message:",e)}}return e&&n?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] rounded-2xl w-full max-w-2xl h-[600px] border border-slate-700 shadow-2xl flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:n.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${n.username}`,alt:n.username,className:"w-10 h-10 rounded-full border-2 border-indigo-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-white",children:n.username}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:n.seconds_offline<30?(0,s.jsx)("span",{className:"text-green-400",children:"‚óè Á∑ö‰∏ä"}):(0,r.formatLastOnline)(n.seconds_offline)})]})]}),(0,s.jsx)("button",{onClick:()=>{a(!1)},className:"text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[0===c.length?(0,s.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,s.jsx)("p",{children:"ÈÇÑÊ≤íÊúâË®äÊÅØ"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"ÈñãÂßãËÅäÂ§©ÂêßÔºÅ"})]}):c.map(e=>{let t=e.sender_id===i?.id;return(0,s.jsx)("div",{className:`flex ${t?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`max-w-[70%] ${t?"items-end":"items-start"} flex flex-col`,children:[(0,s.jsx)("div",{className:`px-4 py-2 rounded-2xl ${t?"bg-indigo-600 text-white":"bg-slate-700 text-slate-200"}`,children:e.content}),(0,s.jsx)("span",{className:"text-xs text-slate-500 mt-1 px-1",children:function(e){let s=new Date(e),t=Math.floor((new Date().getTime()-s.getTime())/1e3);if(t<60)return"ÂâõÂâõ";let a=Math.floor(t/60);if(a<60)return`${a} ÂàÜÈêòÂâç`;let l=Math.floor(a/60);return l<24?`${l} Â∞èÊôÇÂâç`:s.toLocaleString("zh-TW",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}(e.created_at)})]})},e.id)}),(0,s.jsx)("div",{ref:m})]}),(0,s.jsx)("div",{className:"p-4 border-t border-slate-700 bg-slate-800/50 rounded-b-2xl",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:o,onChange:e=>x(e.target.value),onKeyDown:e=>"Enter"===e.key&&f(),placeholder:"Ëº∏ÂÖ•Ë®äÊÅØ...",className:"flex-1 px-4 py-2 bg-slate-900 border border-slate-700 rounded-full text-white focus:outline-none focus:border-indigo-500 transition-colors"}),(0,s.jsx)("button",{onClick:f,disabled:!o.trim(),className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-700 disabled:text-slate-500 text-white rounded-full font-medium transition-colors",children:"ÁôºÈÄÅ"})]})})]})}):null}function g(e){let t,a,l=(0,n.c)(6),{isMatching:r,matchStatus:i,matchMode:d,cancelMatching:o,opponent:x}=e;return r?(l[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500 to-transparent animate-shimmer"}),l[0]=t):t=l[0],l[1]!==o||l[2]!==d||l[3]!==i||l[4]!==x?(a=(0,s.jsx)("div",{className:"fixed inset-0 bg-slate-900/90 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-slate-800 p-8 rounded-2xl border border-slate-700 shadow-2xl max-w-md w-full text-center relative overflow-hidden",children:[t,"waiting"===i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-6 relative",children:[(0,s.jsx)("div",{className:"w-24 h-24 mx-auto border-4 border-indigo-500/30 border-t-indigo-500 rounded-full animate-spin"}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-4xl",children:"üîç"})})]}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-white mb-2",children:"Ê≠£Âú®Â∞ãÊâæÂ∞çÊâã..."}),(0,s.jsxs)("p",{className:"text-slate-400 mb-8",children:["ranked"===d?"Á©çÂàÜÂ∞çÊà∞":"ranked_rts"===d?"Âç≥ÊôÇÁ©çÂàÜ":"casual_rts"===d?"Âç≥ÊôÇ‰∏ÄËà¨":"‰∏ÄËà¨Â∞çÊà∞"," ‚Ä¢ È†êË®àÁ≠âÂæÖÊôÇÈñì: 30Áßí"]}),(0,s.jsx)("button",{onClick:o,className:"px-8 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition-colors",children:"ÂèñÊ∂àÂåπÈÖç"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-6 relative",children:(0,s.jsx)("div",{className:"w-24 h-24 mx-auto bg-green-500 rounded-full flex items-center justify-center animate-bounce",children:(0,s.jsx)("span",{className:"text-4xl",children:"‚öîÔ∏è"})})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-white mb-2",children:"ÂåπÈÖçÊàêÂäüÔºÅ"}),(0,s.jsx)("p",{className:"text-slate-400 mb-6",children:"Âç≥Â∞áÈñãÂßãÂ∞çÊà∞"}),x&&(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-slate-700 mb-6 flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-slate-700 rounded-full overflow-hidden",children:(0,s.jsx)("img",{src:x.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${x.username}`,alt:x.username,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"text-left flex-1",children:[(0,s.jsx)("div",{className:"font-bold text-white",children:x.username}),(0,s.jsxs)("div",{className:"text-sm text-slate-400",children:["Rating: ",null!==x.rating?x.rating:"Êú™ÂÆöÁ¥ö"]})]}),null!==x.rating&&(0,s.jsx)(c.default,{rating:x.rating,size:40})]}),(0,s.jsx)("div",{className:"w-full bg-slate-700 h-2 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-green-500 animate-[width_3s_linear_forwards]",style:{width:"100%"}})})]})]})}),l[1]=o,l[2]=d,l[3]=i,l[4]=x,l[5]=a):a=l[5],a):null}let j=["IRON","BRONZE","SILVER","GOLD","PLATINUM","DIAMOND","MASTER","GRANDMASTER"],N={IRON:{nameZh:"ÈêµÁâå",gradient:"from-zinc-500 to-zinc-700",rating:700},BRONZE:{nameZh:"ÈäÖÁâå",gradient:"from-amber-600 to-amber-800",rating:900},SILVER:{nameZh:"ÈäÄÁâå",gradient:"from-slate-300 to-slate-500",rating:1100},GOLD:{nameZh:"ÈáëÁâå",gradient:"from-yellow-300 to-yellow-600",rating:1350},PLATINUM:{nameZh:"ÁôΩÈáë",gradient:"from-cyan-300 to-cyan-600",rating:1650},DIAMOND:{nameZh:"ÈëΩÁü≥",gradient:"from-blue-400 to-blue-700",rating:2e3},MASTER:{nameZh:"Â§ßÂ∏´",gradient:"from-purple-400 to-purple-700",rating:2300},GRANDMASTER:{nameZh:"ÂÆóÂ∏´",gradient:"from-red-400 to-red-700",rating:2600}};function v(e){let a,r,i,d,o,x,m,h,u,f=(0,n.c)(17),{show:p,onClose:b}=e;f[0]===Symbol.for("react.memo_cache_sentinel")?(a=[],f[0]=a):a=f[0];let[g,v]=(0,t.useState)(a),[y,k]=(0,t.useState)(!0);if(f[1]!==p?(r=()=>{p&&(k(!0),(0,l.api)("/api/users/rank-distribution").then(_).then(e=>{v(j.map(s=>{let t=e.find(e=>e.rank===s);return{rank:s,count:t?t.count:0}})),k(!1)}).catch(e=>{console.error(e),k(!1)}))},i=[p],f[1]=p,f[2]=r,f[3]=i):(r=f[2],i=f[3]),(0,t.useEffect)(r,i),!p)return null;f[4]!==g?(d=Math.max(...g.map(w),1),f[4]=g,f[5]=d):d=f[5];let S=d;return f[6]!==b?(o=(0,s.jsx)("button",{onClick:b,className:"absolute top-4 right-4 text-slate-400 hover:text-white text-2xl leading-none",children:"√ó"}),f[6]=b,f[7]=o):o=f[7],f[8]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("h2",{className:"text-2xl font-bold text-white mb-8 text-center",children:"ÂÖ®ÊúçÊÆµ‰ΩçÂàÜ‰Ωà"}),f[8]=x):x=f[8],f[9]!==g||f[10]!==y||f[11]!==S?(m=y?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):(0,s.jsx)("div",{className:"h-80 flex items-end justify-between gap-2 px-4",children:g.map(e=>{let t=N[e.rank],a=e.count/S*100;return(0,s.jsxs)("div",{className:"flex flex-col items-center flex-1 group relative",children:[(0,s.jsxs)("div",{className:"absolute bottom-full mb-2 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-800 text-white text-xs px-2 py-1 rounded border border-slate-600 whitespace-nowrap z-10",children:[e.count," ‰∫∫ (",t.nameZh,")"]}),(0,s.jsx)("div",{className:`w-full rounded-t-lg bg-gradient-to-t ${t.gradient} transition-all duration-500 hover:brightness-110 relative`,style:{height:`${Math.max(a,2)}%`},children:(0,s.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 bg-white/30"})}),(0,s.jsxs)("div",{className:"mt-3 flex flex-col items-center gap-1",children:[(0,s.jsx)("div",{className:"transform transition-transform group-hover:scale-110",children:(0,s.jsx)(c.default,{rating:t.rating,size:32})}),(0,s.jsx)("span",{className:"text-[10px] text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity absolute top-full mt-1 whitespace-nowrap",children:t.nameZh})]})]},e.rank)})}),f[9]=g,f[10]=y,f[11]=S,f[12]=m):m=f[12],f[13]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsx)("div",{className:"mt-8 text-center text-slate-500 text-sm",children:"Áµ±Ë®àÁØÑÂúçÔºöÂÆåÊàê 10 Â†¥ÂÆöÁ¥öË≥ΩÁöÑÊ¥ªË∫çÁé©ÂÆ∂"}),f[13]=h):h=f[13],f[14]!==o||f[15]!==m?(u=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-8 rounded-2xl w-full max-w-4xl border border-slate-700 shadow-2xl relative",children:[o,x,m,h]})}),f[14]=o,f[15]=m,f[16]=u):u=f[16],u}function w(e){return e.count}function _(e){return e.json()}function y(e){let a,l,r,i,c,d,o,x,m,h,u,f,p,b,g,j,N,v,w,_,y,$,P,I,R,T,O,F,M,E,A,z,q,L,D,U,Z,W=(0,n.c)(58),{show:B,onClose:J}=e,[V,G]=(0,t.useState)(0);W[0]!==B?(a=()=>{B&&G(0)},l=[B],W[0]=B,W[1]=a,W[2]=l):(a=W[1],l=W[2]),(0,t.useEffect)(a,l),W[3]===Symbol.for("react.memo_cache_sentinel")?(r=()=>G(C),W[3]=r):r=W[3];let K=r;W[4]===Symbol.for("react.memo_cache_sentinel")?(i=()=>G(S),W[4]=i):i=W[4];let H=i;if(!B)return null;W[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsxs)("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{children:"üéì"})," ÈÅäÊà≤ÊïôÂ≠∏"]}),W[5]=c):c=W[5],W[6]!==J?(d=(0,s.jsxs)("div",{className:"p-6 border-b border-slate-800 flex justify-between items-center bg-slate-950",children:[c,(0,s.jsx)("button",{onClick:J,className:"text-slate-400 hover:text-white transition-colors text-2xl",children:"√ó"})]}),W[6]=J,W[7]=d):d=W[7];let Q=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${0===V?"opacity-100 translate-x-0":V>0?"opacity-0 -translate-x-full":"opacity-0 translate-x-full"}`;W[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"„Ñå",animate:!0})}),W[8]=o):o=W[8],W[9]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(k,{char:"„Ñß",animate:!0})}),W[9]=x):x=W[9],W[10]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsxs)("div",{className:"flex items-center justify-center gap-1 mb-6",children:[o,x,(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"„Ñì",animate:!0})})]}),h=(0,s.jsx)("p",{className:"text-xl font-bold text-indigo-400 mb-2",children:"1. ÈÄ£Êé•Áõ∏ÈÑ∞Á¨¶Ëôü"}),u=(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"Âú®Âú∞Âúñ‰∏äÊªëÂãïÊàñÈªûÊìäÔºåÈÄ£Êé•Áõ∏ÈÑ∞ÁöÑÊ≥®Èü≥Á¨¶Ëôü"}),W[10]=m,W[11]=h,W[12]=u):(m=W[10],h=W[11],u=W[12]),W[13]!==Q?(f=(0,s.jsxs)("div",{className:Q,children:[m,h,u]}),W[13]=Q,W[14]=f):f=W[14];let X=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${1===V?"opacity-100 translate-x-0":V>1?"opacity-0 -translate-x-full":V<1?"opacity-0 translate-x-full":""}`;W[15]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"„Ñå",color:"indigo",scale:1.1})}),W[15]=p):p=W[15],W[16]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(k,{char:"„Ñß",color:"indigo",scale:1.1})}),W[16]=b):b=W[16],W[17]===Symbol.for("react.memo_cache_sentinel")?(g=(0,s.jsxs)("div",{className:"flex items-center justify-center gap-1 mb-6",children:[p,b,(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"„Ñì",color:"indigo",scale:1.1})})]}),j=(0,s.jsx)("p",{className:"text-xl font-bold text-green-400 mb-2",children:"2. ÁµÑÊàêÊúâÊïàË©ûÂΩô"}),W[17]=g,W[18]=j):(g=W[17],j=W[18]),W[19]===Symbol.for("react.memo_cache_sentinel")?(N=(0,s.jsx)("p",{className:"mb-1",children:"ÂøÖÈ†àÁµÑÊàêÂ≠óÂÖ∏‰∏≠Â≠òÂú®ÁöÑÊ≥®Èü≥ÁµÑÂêàÔºàÂ¶ÇÔºö„Ñå„Ñß„Ñì ËçîÊûùÔºâ"}),W[19]=N):N=W[19],W[20]===Symbol.for("react.memo_cache_sentinel")?(v=(0,s.jsxs)("div",{className:"text-slate-400 text-sm text-center max-w-md px-4",children:[N,(0,s.jsxs)("p",{className:"text-xs text-slate-500",children:["‰πüÂèØ‰ª•ÊòØÊàêË™ûÔºåË©ûÂΩô‰æÜÊ∫êÂèÉËÄÉ ",(0,s.jsx)("a",{href:"https://www.moedict.tw/",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-400 hover:text-indigo-300 underline",children:"ËêåÂÖ∏ (Moedict)"})]})]}),W[20]=v):v=W[20],W[21]!==X?(w=(0,s.jsxs)("div",{className:X,children:[g,j,v]}),W[21]=X,W[22]=w):w=W[22];let Y=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${2===V?"opacity-100 translate-x-0":V>2?"opacity-0 -translate-x-full":V<2?"opacity-0 translate-x-full":""}`;W[23]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"",color:"red"})}),W[23]=_):_=W[23],W[24]===Symbol.for("react.memo_cache_sentinel")?(y=(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(k,{char:"",color:"red"})}),W[24]=y):y=W[24],W[25]===Symbol.for("react.memo_cache_sentinel")?($=(0,s.jsxs)("div",{className:"flex items-center justify-center gap-1 mb-6",children:[_,y,(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(k,{char:"",color:"red"})})]}),P=(0,s.jsx)("p",{className:"text-xl font-bold text-red-400 mb-2",children:"3. ‰ΩîÈ†òÂú∞Áõ§"}),I=(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"ÊàêÂäüÁµÑË©ûÂæåÔºåË©≤ÂçÄÂüüÂ∞áËÆäÁÇ∫‰Ω†ÁöÑÈ†òÂú∞„ÄÇÈÄ£Êé•Âà∞Â∞çÊñπÂüéÂ†°Âç≥ÂèØÁç≤ÂãùÔºÅ"}),W[25]=$,W[26]=P,W[27]=I):($=W[25],P=W[26],I=W[27]),W[28]!==Y?(R=(0,s.jsxs)("div",{className:Y,children:[$,P,I]}),W[28]=Y,W[29]=R):R=W[29];let ee=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${3===V?"opacity-100 translate-x-0":V<3?"opacity-0 translate-x-full":""}`;W[30]===Symbol.for("react.memo_cache_sentinel")?(T=(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("div",{className:"w-24 h-24 rounded-full bg-purple-600 flex items-center justify-center text-5xl shadow-[0_0_30px_rgba(147,51,234,0.5)] animate-bounce",children:"üé≤"}),(0,s.jsx)("div",{className:"absolute -bottom-2 -right-2 bg-yellow-400 text-black text-xs font-bold px-2 py-1 rounded-full border-2 border-slate-900",children:"Skill Ready!"})]}),O=(0,s.jsx)("p",{className:"text-xl font-bold text-purple-400 mb-2",children:"4. ‰ΩøÁî®ÊäÄËÉΩ"}),F=(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"ÊØèÂõûÂêàÁ¥ØÁ©çËÉΩÈáèÔºåÈõÜÊªø 3 ÈªûÂèØÁç≤ÂæóÊäÄËÉΩÈÅìÂÖ∑ÔºåÊîπËÆäÊà∞Â±ÄÔºÅ"}),W[30]=T,W[31]=O,W[32]=F):(T=W[30],O=W[31],F=W[32]),W[33]!==ee?(M=(0,s.jsxs)("div",{className:ee,children:[T,O,F]}),W[33]=ee,W[34]=M):M=W[34],W[35]!==f||W[36]!==w||W[37]!==R||W[38]!==M?(E=(0,s.jsxs)("div",{className:"w-full h-72 bg-slate-950 rounded-xl border border-slate-800 mb-6 relative overflow-hidden flex items-center justify-center",children:[f,w,R,M]}),W[35]=f,W[36]=w,W[37]=R,W[38]=M,W[39]=E):E=W[39],W[40]===Symbol.for("react.memo_cache_sentinel")?(A=[0,1,2,3],W[40]=A):A=W[40],W[41]!==V?(z=(0,s.jsx)("div",{className:"flex gap-2 mb-8",children:A.map(e=>(0,s.jsx)("div",{className:`w-3 h-3 rounded-full transition-all duration-300 ${V===e?"bg-indigo-500 scale-125":"bg-slate-700"}`},e))}),W[41]=V,W[42]=z):z=W[42];let es=0===V;return W[43]!==es?(q=(0,s.jsx)("button",{onClick:H,disabled:es,className:"flex-1 py-3 rounded-xl font-bold transition-all bg-slate-800 hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed text-slate-300",children:"‰∏ä‰∏ÄÊ≠•"}),W[43]=es,W[44]=q):q=W[44],W[45]!==J||W[46]!==V?(L=V<3?(0,s.jsx)("button",{onClick:K,className:"flex-1 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-indigo-500/25",children:"‰∏ã‰∏ÄÊ≠•"}):(0,s.jsx)("button",{onClick:J,className:"flex-1 py-3 bg-green-600 hover:bg-green-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-green-500/25",children:"ÈñãÂßãÊà∞È¨•ÔºÅ"}),W[45]=J,W[46]=V,W[47]=L):L=W[47],W[48]!==q||W[49]!==L?(D=(0,s.jsxs)("div",{className:"flex gap-4 w-full",children:[q,L]}),W[48]=q,W[49]=L,W[50]=D):D=W[50],W[51]!==E||W[52]!==z||W[53]!==D?(U=(0,s.jsxs)("div",{className:"p-8 flex flex-col items-center",children:[E,z,D]}),W[51]=E,W[52]=z,W[53]=D,W[54]=U):U=W[54],W[55]!==U||W[56]!==d?(Z=(0,s.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:(0,s.jsxs)("div",{className:"bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col",children:[d,U]})}),W[55]=U,W[56]=d,W[57]=Z):Z=W[57],Z}function k(e){let{char:t,color:a,animate:l,scale:r}=e,n=void 0===a?"slate":a,i="linear-gradient(180deg, #cbd5e1 0%, #94a3b8 100%)";return"red"===n&&(i="linear-gradient(180deg,#fca5a5,#ef4444)"),"indigo"===n&&(i="linear-gradient(180deg, #818cf8, #4f46e5)"),(0,s.jsxs)("div",{className:`relative flex items-center justify-center transition-all duration-300 ${void 0!==l&&l?"animate-bounce":""}`,style:{width:"64px",height:"74px",clipPath:"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)",background:i,transform:`scale(${void 0===r?1:r})`,boxShadow:"0 4px 6px rgba(0,0,0,0.3)"},children:[(0,s.jsx)("div",{className:"absolute inset-0 border border-white/20",style:{clipPath:"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)"}}),(0,s.jsx)("span",{className:"text-2xl font-bold text-slate-900 z-10",children:t})]})}function S(e){return Math.max(e-1,0)}function C(e){return Math.min(e+1,3)}function $(e){let a,l,r,i,c,d,o,x,m,h,u,f,p,b,g,j,N,v,w,_,y=(0,n.c)(45),{show:k,onClose:S,onConfirm:C,friendName:$}=e,[P,I]=(0,t.useState)("turn-based"),[R,T]=(0,t.useState)("increment"),[O,F]=(0,t.useState)(60),[M,E]=(0,t.useState)(60);if(!k)return null;y[0]!==O||y[1]!==M||y[2]!==P||y[3]!==C||y[4]!==R?(a=()=>{C({mode:P,timeControl:R,baseTime:O,increment:M})},y[0]=O,y[1]=M,y[2]=P,y[3]=C,y[4]=R,y[5]=a):a=y[5];let A=a;y[6]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{children:"‚öîÔ∏è"})," ÁôºËµ∑ÊåëÊà∞"]}),y[6]=l):l=y[6],y[7]!==S?(r=(0,s.jsxs)("div",{className:"p-6 border-b border-slate-800 flex justify-between items-center bg-slate-900/50",children:[l,(0,s.jsx)("button",{onClick:S,className:"text-slate-400 hover:text-white transition-colors w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-800",children:"‚úï"})]}),y[7]=S,y[8]=r):r=y[8],y[9]!==$?(i=(0,s.jsxs)("p",{className:"text-slate-300 text-center",children:["Ë®≠ÂÆöËàá ",(0,s.jsx)("span",{className:"text-indigo-400 font-bold",children:$})," ÁöÑÂ∞çÊà∞Ë¶èÂâá"]}),y[9]=$,y[10]=i):i=y[10],y[11]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)("label",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider",children:"Â∞çÊà∞Ê®°Âºè"}),y[11]=c):c=y[11],y[12]===Symbol.for("react.memo_cache_sentinel")?(d=()=>I("turn-based"),y[12]=d):d=y[12];let z=`p-3 rounded-xl border-2 transition-all ${"turn-based"===P?"border-indigo-500 bg-indigo-500/20 text-white shadow-lg shadow-indigo-500/20":"border-slate-700 bg-slate-800/50 text-slate-400 hover:border-slate-600"}`;y[13]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)("div",{className:"font-bold",children:"ÂõûÂêàÂà∂"}),x=(0,s.jsx)("div",{className:"text-xs opacity-70 mt-1",children:"Á∂ìÂÖ∏Ëº™ÊµÅÂá∫Áâå"}),y[13]=o,y[14]=x):(o=y[13],x=y[14]),y[15]!==z?(m=(0,s.jsxs)("button",{onClick:d,className:z,children:[o,x]}),y[15]=z,y[16]=m):m=y[16],y[17]===Symbol.for("react.memo_cache_sentinel")?(h=()=>I("rts"),y[17]=h):h=y[17];let q=`p-3 rounded-xl border-2 transition-all ${"rts"===P?"border-pink-500 bg-pink-500/20 text-white shadow-lg shadow-pink-500/20":"border-slate-700 bg-slate-800/50 text-slate-400 hover:border-slate-600"}`;return y[18]===Symbol.for("react.memo_cache_sentinel")?(u=(0,s.jsx)("div",{className:"font-bold",children:"Âç≥ÊôÇÂà∂ (RTS)"}),f=(0,s.jsx)("div",{className:"text-xs opacity-70 mt-1",children:"Âø´ÁØÄÂ•èÊê∂Âú∞Áõ§"}),y[18]=u,y[19]=f):(u=y[18],f=y[19]),y[20]!==q?(p=(0,s.jsxs)("button",{onClick:h,className:q,children:[u,f]}),y[20]=q,y[21]=p):p=y[21],y[22]!==m||y[23]!==p?(b=(0,s.jsxs)("div",{className:"space-y-3",children:[c,(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[m,p]})]}),y[22]=m,y[23]=p,y[24]=b):b=y[24],y[25]!==O||y[26]!==M||y[27]!==P||y[28]!==R?(g="turn-based"===P&&(0,s.jsxs)("div",{className:"space-y-3 animate-in fade-in slide-in-from-top-2 duration-200",children:[(0,s.jsx)("label",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider",children:"ÊôÇÈñìË®≠ÂÆö"}),(0,s.jsxs)("div",{className:"flex bg-slate-800/50 p-1 rounded-lg border border-slate-700",children:[(0,s.jsx)("button",{onClick:()=>T("unlimited"),className:`flex-1 py-2 rounded-md text-sm font-bold transition-all ${"unlimited"===R?"bg-slate-700 text-white shadow":"text-slate-400 hover:text-slate-200"}`,children:"‰∏çÈôêÊôÇÈñì"}),(0,s.jsx)("button",{onClick:()=>T("increment"),className:`flex-1 py-2 rounded-md text-sm font-bold transition-all ${"increment"===R?"bg-slate-700 text-white shadow":"text-slate-400 hover:text-slate-200"}`,children:"Âä†ÁßíÂà∂"})]}),"increment"===R&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4 animate-in slide-in-from-top-2 duration-200",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs text-slate-400",children:"Âü∫Á§éÊôÇÈñì (Áßí)"}),(0,s.jsx)("input",{type:"number",value:O,onChange:e=>F(Math.max(10,parseInt(e.target.value)||0)),className:"w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-indigo-500 transition-colors"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs text-slate-400",children:"ÊØèÂõûÂêàÂä†Áßí (Áßí)"}),(0,s.jsx)("input",{type:"number",value:M,onChange:e=>E(Math.max(0,parseInt(e.target.value)||0)),className:"w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-indigo-500 transition-colors"})]})]})]}),y[25]=O,y[26]=M,y[27]=P,y[28]=R,y[29]=g):g=y[29],y[30]!==b||y[31]!==g||y[32]!==i?(j=(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[i,b,g]}),y[30]=b,y[31]=g,y[32]=i,y[33]=j):j=y[33],y[34]!==S?(N=(0,s.jsx)("button",{onClick:S,className:"flex-1 py-3 rounded-xl font-bold text-slate-400 hover:bg-slate-800 transition-colors",children:"ÂèñÊ∂à"}),y[34]=S,y[35]=N):N=y[35],y[36]!==A?(v=(0,s.jsx)("button",{onClick:A,className:"flex-1 py-3 rounded-xl font-bold text-white bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-500 hover:to-blue-500 shadow-lg shadow-indigo-500/20 transition-all active:scale-95",children:"ÁôºÈÄÅÈÇÄË´ã"}),y[36]=A,y[37]=v):v=y[37],y[38]!==N||y[39]!==v?(w=(0,s.jsxs)("div",{className:"p-6 border-t border-slate-800 bg-slate-900/50 flex gap-3",children:[N,v]}),y[38]=N,y[39]=v,y[40]=w):w=y[40],y[41]!==j||y[42]!==w||y[43]!==r?(_=(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-slate-900 border border-slate-700 rounded-2xl w-full max-w-md shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[r,j,w]})}),y[41]=j,y[42]=w,y[43]=r,y[44]=_):_=y[44],_}function P(){let e=(0,a.useRouter)(),[n,c]=(0,t.useState)(!0),[f,j]=(0,t.useState)(null),[N,w]=(0,t.useState)(!1),[_,k]=(0,t.useState)(!1),[S,C]=(0,t.useState)(!1),[P,I]=(0,t.useState)(!1),[R,T]=(0,t.useState)(!1),[O,F]=(0,t.useState)(!1),[M,E]=(0,t.useState)(!1),[A,z]=(0,t.useState)(!1),[q,L]=(0,t.useState)([]),[D,U]=(0,t.useState)([]),[Z,W]=(0,t.useState)([]),[B,J]=(0,t.useState)([]),[V,G]=(0,t.useState)(null),[K,H]=(0,t.useState)(null),[Q,X]=(0,t.useState)(null),[Y,ee]=(0,t.useState)(!1),[es,et]=(0,t.useState)(null),[ea,el]=(0,t.useState)(null),[er,en]=(0,t.useState)(null),[ei,ec]=(0,t.useState)(null),ed=f?.avatar_url||r.AVATAR_OPTIONS[0];async function eo(e){if(Q)try{let s=await (0,l.api)(`/api/friends/invite-battle/${Q.id}`,{method:"POST",body:JSON.stringify({settings:e})});if(s.ok)alert("Â∑≤ÁôºÈÄÅÁ¥ÑÊà∞ÈÇÄË´ãÔºÅ"),z(!1),X(null);else{let e=await s.json();alert(e.error||"ÁôºÈÄÅÈÇÄË´ãÂ§±Êïó")}}catch(e){console.error("Challenge error:",e)}}async function ex(s){try{let t=await (0,l.api)(`/api/friends/accept-battle-invite/${s}`,{method:"POST"});if(t.ok){let s=await t.json();e.push(`/battle?id=${s.battleId}`)}else alert("Êé•ÂèóÈÇÄË´ãÂ§±Êïó")}catch(e){console.error("Accept invite error:",e)}}async function em(e){try{await (0,l.api)(`/api/friends/reject-battle-invite/${e}`,{method:"POST"}),J(s=>s.filter(s=>s.id!==e))}catch(e){console.error("Reject invite error:",e)}}async function eh(){try{localStorage.getItem("token")&&await (0,l.api)("/api/users/logout",{method:"POST"})}catch(e){console.error("Logout error:",e)}finally{localStorage.removeItem("token"),localStorage.removeItem("user"),e.replace("/")}}function eu(e){j(e),localStorage.setItem("user",JSON.stringify(e))}async function ef(e){try{let s=await (0,l.api)(`/api/friends/user/${e}`);s.ok&&(G(await s.json()),C(!0))}catch(e){console.error("Failed to fetch user detail:",e)}}async function ep(e){try{let s=await (0,l.api)(`/api/friends/add-friend/${e}`,{method:"POST"});if(s.ok){alert("Â•ΩÂèãË´ãÊ±ÇÂ∑≤ÁôºÈÄÅÔºÅ");let e=await (0,l.api)("/api/friends/online-users");e.ok&&U(await e.json())}else{let e=await s.json();alert(e.error||"ÁôºÈÄÅÂ§±Êïó")}}catch(e){console.error("Failed to send friend request:",e)}}async function eb(e){try{if((await (0,l.api)(`/api/friends/accept-friend/${e}`,{method:"POST"})).ok){let[e,s,t]=await Promise.all([(0,l.api)("/api/friends/my-friends"),(0,l.api)("/api/friends/pending-requests"),(0,l.api)("/api/friends/online-users")]);e.ok&&L(await e.json()),s.ok&&W(await s.json()),t.ok&&U(await t.json())}}catch(e){console.error("Failed to accept friend request:",e)}}async function eg(e){try{if((await (0,l.api)(`/api/friends/reject-friend/${e}`,{method:"DELETE"})).ok){let e=await (0,l.api)("/api/friends/pending-requests");e.ok&&W(await e.json())}}catch(e){console.error("Failed to reject friend request:",e)}}async function ej(e){if(confirm("Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄô‰ΩçÂ•ΩÂèãÂóéÔºü"))try{if((await (0,l.api)(`/api/friends/remove-friend/${e}`,{method:"DELETE"})).ok){let s=await (0,l.api)("/api/friends/my-friends");s.ok&&L(await s.json()),K&&K.id===e&&(T(!1),H(null))}}catch(e){console.error("Failed to remove friend:",e)}}async function eN(s){try{let t;ee(!0),et(s),el("waiting");let a=await (0,l.api)("/api/matchmaking/queue/join",{method:"POST",body:JSON.stringify({mode:s})});if(!a.ok)throw Error("Failed to join queue");let r=await a.json();"matched"===r.status?(el("matched"),en(r.battleId),ec(r.opponent),setTimeout(()=>e.push(`/battle?id=${r.battleId}`),3e3)):(t=setInterval(async()=>{try{let s=await (0,l.api)("/api/matchmaking/queue/status");if(!s.ok)return void clearInterval(t);let a=await s.json();"matched"===a.status&&(clearInterval(t),el("matched"),en(a.battleId),ec(a.opponent),setTimeout(()=>e.push(`/battle?id=${a.battleId}`),3e3))}catch(e){console.error("Error polling match status:",e),clearInterval(t)}},2e3),window.matchPollInterval=t)}catch(e){console.error("Failed to start matching:",e),ee(!1),et(null),el(null),alert("ÂåπÈÖçÂ§±ÊïóÔºåË´ãÈáçË©¶")}}async function ev(){try{await (0,l.api)("/api/matchmaking/queue/leave",{method:"POST"}),window.matchPollInterval&&clearInterval(window.matchPollInterval),ee(!1),et(null),el(null)}catch(e){console.error("Failed to cancel matching:",e)}}async function ew(e){try{if((await (0,l.api)(`/api/friends/add-friend/${e}`,{method:"POST"})).ok){alert("Â•ΩÂèãË´ãÊ±ÇÂ∑≤ÁôºÈÄÅÔºÅ");let s=await (0,l.api)("/api/friends/pending-requests");s.ok&&W(await s.json()),V&&V.id===e&&ef(e)}}catch(e){console.error("Failed to add friend:",e)}}return(0,t.useEffect)(()=>{if(localStorage.getItem("token")){let e=localStorage.getItem("user");e&&j(JSON.parse(e)),(0,l.api)("/api/users/me").then(e=>{if(e.ok)return e.json();throw Error("Failed to fetch user")}).then(e=>{j(e),localStorage.setItem("user",JSON.stringify(e))}).catch(e=>{console.error(e)}).finally(()=>{c(!1)})}else e.replace("/")},[e]),(0,t.useEffect)(()=>{if(!localStorage.getItem("token"))return;(0,l.api)("/api/friends/ping",{method:"POST"});let e=setInterval(()=>{(0,l.api)("/api/friends/ping",{method:"POST"})},2e4);return()=>clearInterval(e)},[]),(0,t.useEffect)(()=>{if(!f)return;async function e(){try{let[e,s,t,a]=await Promise.all([(0,l.api)("/api/friends/my-friends"),(0,l.api)("/api/friends/online-users"),(0,l.api)("/api/friends/pending-requests"),(0,l.api)("/api/friends/battle-invites")]);e.ok&&L(await e.json()),s.ok&&U(await s.json()),t.ok&&W(await t.json()),a.ok&&J(await a.json())}catch(e){console.error("Failed to load friends and users:",e)}}e();let s=setInterval(e,3e4);return()=>clearInterval(s)},[f]),n?(0,s.jsx)("div",{className:"min-h-screen bg-[#0f172a] flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):(0,s.jsxs)("div",{className:"flex flex-col h-screen bg-[#0f172a] text-slate-200 overflow-hidden",children:[(0,s.jsx)(i,{friendRequestsCount:Z.length+B.length,showFriendRequests:P,setShowFriendRequests:I,handleLogout:eh,onOpenLeaderboard:()=>F(!0),onOpenTutorial:()=>E(!0)}),(0,s.jsxs)("main",{className:"flex flex-1 overflow-hidden",children:[(0,s.jsx)(d,{user:f,selectedAvatar:ed,setShowAvatarPicker:w,openProfileEdit:function(){k(!0)},startMatching:eN,isMatching:Y}),(0,s.jsx)(x,{user:f}),(0,s.jsx)(o,{friends:q,onlineUsers:D,openChat:function(e){H(e),T(!0)},viewUserDetail:ef,removeFriend:ej,sendFriendRequest:ep})]}),(0,s.jsx)(m,{showAvatarPicker:N,setShowAvatarPicker:w,currentAvatar:ed,onUpdate:eu}),(0,s.jsx)(h,{showProfileEdit:_,setShowProfileEdit:k,user:f,onUpdate:eu}),(0,s.jsx)(u,{showUserDetail:S,setShowUserDetail:C,selectedUser:V,addFriend:ew,removeFriend:ej,onChallenge:function(e){let s=q.find(s=>s.id===e)||D.find(s=>s.id===e)||(V&&V.id===e?V:null);s?X(s):X({id:e,username:"Unknown"}),z(!0)}}),(0,s.jsx)(p,{showFriendRequests:P,setShowFriendRequests:I,friendRequests:Z,acceptFriendRequest:eb,rejectFriendRequest:eg,battleInvites:B,acceptBattleInvite:ex,rejectBattleInvite:em}),(0,s.jsx)(b,{showChat:R,setShowChat:T,chatFriend:K,user:f}),(0,s.jsx)(g,{isMatching:Y,matchStatus:ea,matchMode:es,cancelMatching:ev,opponent:ei}),(0,s.jsx)(v,{show:O,onClose:()=>F(!1)}),(0,s.jsx)(y,{show:M,onClose:()=>E(!1)}),(0,s.jsx)($,{show:A,onClose:()=>z(!1),onConfirm:eo,friendName:Q?.username||"Friend"})]})}e.s(["default",()=>P],15452)}]);