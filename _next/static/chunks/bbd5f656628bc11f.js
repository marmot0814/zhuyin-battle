(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15452,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566),l=e.i(54858),r=e.i(47163),n=e.i(932);function i(e){let t,a,l,r,i,c,d,o,x,m,h,f=(0,n.c)(23),{friendRequestsCount:p,showFriendRequests:u,setShowFriendRequests:b,handleLogout:g,onOpenLeaderboard:j,onOpenTutorial:N}=e;return f[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("h1",{className:"text-2xl font-black text-white tracking-tighter italic",children:["ç²¾éˆèª ",(0,s.jsx)("span",{className:"text-indigo-500",children:"å°æˆ°"})]})}),f[0]=t):t=f[0],f[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("span",{className:"text-2xl",children:"ğŸ“"}),f[1]=a):a=f[1],f[2]!==N?(l=(0,s.jsx)("button",{onClick:N,className:"px-3 py-2 text-slate-300 hover:text-white transition-colors flex items-center gap-2",title:"éŠæˆ²æ•™å­¸",children:a}),f[2]=N,f[3]=l):l=f[3],f[4]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)("span",{className:"text-2xl",children:"ğŸ“Š"}),f[4]=r):r=f[4],f[5]!==j?(i=(0,s.jsx)("button",{onClick:j,className:"px-3 py-2 text-slate-300 hover:text-white transition-colors flex items-center gap-2",title:"æ’è¡Œæ¦œ",children:r}),f[5]=j,f[6]=i):i=f[6],f[7]!==b||f[8]!==u?(c=()=>b(!u),f[7]=b,f[8]=u,f[9]=c):c=f[9],f[10]===Symbol.for("react.memo_cache_sentinel")?(d=(0,s.jsx)("span",{className:"text-2xl",children:"ğŸ””"}),f[10]=d):d=f[10],f[11]!==p?(o=p>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center font-bold",children:p}),f[11]=p,f[12]=o):o=f[12],f[13]!==c||f[14]!==o?(x=(0,s.jsxs)("button",{onClick:c,className:"relative px-3 py-2 text-slate-300 hover:text-white transition-colors",children:[d,o]}),f[13]=c,f[14]=o,f[15]=x):x=f[15],f[16]!==g?(m=(0,s.jsx)("button",{onClick:g,className:"px-4 py-2 text-sm font-medium text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:"ç™»å‡º"}),f[16]=g,f[17]=m):m=f[17],f[18]!==m||f[19]!==l||f[20]!==i||f[21]!==x?(h=(0,s.jsxs)("nav",{className:"h-16 border-b border-slate-800 bg-[#1e293b]/80 backdrop-blur-md flex items-center justify-between px-6 flex-shrink-0 z-50",children:[t,(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[l,i,x,m]})]}),f[18]=m,f[19]=l,f[20]=i,f[21]=x,f[22]=h):h=f[22],h}var c=e.i(85333);function d(e){let a,l,i=(0,n.c)(12),{user:d,selectedAvatar:o,setShowAvatarPicker:x,openProfileEdit:m,startMatching:h,isMatching:f}=e,[p,u]=(0,t.useState)("turn-based"),b="turn-based"===p,g=b?d.rating:d.rts_rating,j=b?d.ranked_games_played:d.rts_ranked_games_played,N=g||1500,v=10>(j||0);return i[0]!==f||i[1]!==v||i[2]!==b||i[3]!==m||i[4]!==N||i[5]!==o||i[6]!==x||i[7]!==h||i[8]!==d?(a=d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"relative group",children:(0,s.jsx)("div",{className:"w-28 h-28 bg-gradient-to-tr from-indigo-600 to-purple-400 rounded-full border-4 border-slate-900 overflow-hidden shadow-2xl transition-transform group-hover:scale-105 cursor-pointer",onClick:()=>x(!0),children:(0,s.jsx)("img",{src:o||`https://api.dicebear.com/7.x/avataaars/svg?seed=${r.AVATAR_OPTIONS[0]}`,alt:d.username,className:"w-full h-full object-cover"})})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white tracking-tight",children:d.username}),(0,s.jsx)("button",{onClick:m,className:"text-slate-500 hover:text-indigo-400 transition-colors",title:"ç·¨è¼¯å€‹äººè³‡æ–™",children:"âœï¸"})]}),d.bio&&(0,s.jsx)("p",{className:"text-sm text-slate-400 mt-1 italic",children:d.bio}),(0,s.jsxs)("div",{className:"w-full mt-6 bg-slate-900/50 p-1 rounded-xl border border-slate-700 flex relative",children:[(0,s.jsx)("button",{onClick:()=>u("turn-based"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all duration-300 relative z-10 ${b?"text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:"å›åˆåˆ¶"}),(0,s.jsx)("button",{onClick:()=>u("rts"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all duration-300 relative z-10 ${!b?"text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:"å³æ™‚åˆ¶"}),(0,s.jsx)("div",{className:`absolute top-1 bottom-1 w-[calc(50%-4px)] bg-gradient-to-r rounded-lg transition-all duration-300 ${b?"left-1 from-indigo-600 to-blue-600":"left-[calc(50%+0px)] from-pink-600 to-rose-600"}`})]}),(0,s.jsx)("div",{className:"mt-6 flex flex-col items-center",children:v?(0,s.jsxs)("div",{className:"flex items-center gap-1 relative group",children:[(0,s.jsx)("p",{className:"text-sm text-amber-400",children:"å®šç´šä¸­"}),(0,s.jsx)("span",{className:"text-xs text-amber-500 cursor-help",children:"â“˜"}),(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-3 px-4 py-2.5 bg-slate-900 text-slate-100 text-xs rounded-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap pointer-events-none z-10 shadow-xl border border-slate-700",children:(0,s.jsxs)("div",{className:"relative",children:["å®Œæˆ 10 å ´ç©åˆ†å°æˆ°å¾Œå³å¯æŸ¥çœ‹åˆ†æ•¸",(0,s.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-px",children:(0,s.jsx)("div",{className:"border-4 border-transparent border-t-slate-900"})})]})})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,s.jsx)(c.default,{rating:N,size:64}),(0,s.jsxs)("p",{className:"text-sm text-slate-300",children:["Rating: ",(0,s.jsx)("span",{className:`font-bold ${b?"text-amber-400":"text-pink-400"}`,children:N})]})]})}),(0,s.jsx)("div",{className:"w-full mt-6 space-y-4",children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-amber-400 mb-3 uppercase tracking-wider",children:"ç©åˆ†å°æˆ°"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"å‹"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.ranked_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"æ•—"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.ranked_games_played||0)-(d.ranked_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç¸½"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.ranked_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç‡"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.ranked_games_played>0?Math.round(d.ranked_games_won/d.ranked_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-blue-400 mb-3 uppercase tracking-wider",children:"ä¸€èˆ¬å°æˆ°"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"å‹"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.casual_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"æ•—"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.casual_games_played||0)-(d.casual_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç¸½"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.casual_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç‡"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.casual_games_played>0?Math.round(d.casual_games_won/d.casual_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-purple-400 mb-3 uppercase tracking-wider",children:"å¥½å‹å°æˆ°"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"å‹"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.custom_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"æ•—"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.custom_games_played||0)-(d.custom_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç¸½"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.custom_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç‡"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.custom_games_played>0?Math.round(d.custom_games_won/d.custom_games_played*100):0,"%"]})]})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-pink-400 mb-3 uppercase tracking-wider",children:"ç©åˆ†å°æˆ° (RTS)"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"å‹"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.rts_ranked_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"æ•—"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.rts_ranked_games_played||0)-(d.rts_ranked_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç¸½"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.rts_ranked_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç‡"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.rts_ranked_games_played>0?Math.round(d.rts_ranked_games_won/d.rts_ranked_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-blue-400 mb-3 uppercase tracking-wider",children:"ä¸€èˆ¬å°æˆ° (RTS)"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"å‹"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.rts_casual_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"æ•—"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.rts_casual_games_played||0)-(d.rts_casual_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç¸½"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.rts_casual_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç‡"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.rts_casual_games_played>0?Math.round(d.rts_casual_games_won/d.rts_casual_games_played*100):0,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/30 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-purple-400 mb-3 uppercase tracking-wider",children:"å¥½å‹å°æˆ° (RTS)"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"å‹"}),(0,s.jsx)("span",{className:"text-sm font-bold text-green-400",children:d.rts_custom_games_won||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"æ•—"}),(0,s.jsx)("span",{className:"text-sm font-bold text-red-400",children:(d.rts_custom_games_played||0)-(d.rts_custom_games_won||0)})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç¸½"}),(0,s.jsx)("span",{className:"text-sm font-bold text-slate-400",children:d.rts_custom_games_played||0})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-400",children:"ç‡"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-emerald-400",children:[d.rts_custom_games_played>0?Math.round(d.rts_custom_games_won/d.rts_custom_games_played*100):0,"%"]})]})]})]})]})}),(0,s.jsx)("div",{className:"w-full mt-4 space-y-3",children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>h("ranked"),disabled:f,className:"w-full bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"ğŸ†"})," ç©åˆ†å°æˆ°"]}),(0,s.jsxs)("button",{onClick:()=>h("casual"),disabled:f,className:"w-full bg-slate-700 hover:bg-slate-600 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"ğŸ®"})," ä¸€èˆ¬å°æˆ°"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>h("ranked_rts"),disabled:f,className:"w-full bg-gradient-to-r from-pink-500 to-rose-600 hover:from-pink-600 hover:to-rose-700 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"âš¡"})," ç©åˆ†å°æˆ° (RTS)"]}),(0,s.jsxs)("button",{onClick:()=>h("casual_rts"),disabled:f,className:"w-full bg-slate-700 hover:bg-slate-600 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{children:"ğŸ®"})," ä¸€èˆ¬å°æˆ° (RTS)"]})]})})]}),i[0]=f,i[1]=v,i[2]=b,i[3]=m,i[4]=N,i[5]=o,i[6]=x,i[7]=h,i[8]=d,i[9]=a):a=i[9],i[10]!==a?(l=(0,s.jsx)("section",{className:"w-80 bg-[#1e293b] border-r border-slate-800 flex flex-col p-6 flex-shrink-0 overflow-y-auto",children:(0,s.jsx)("div",{className:"flex flex-col items-center flex-1",children:a})}),i[10]=a,i[11]=l):l=i[11],l}function o(e){let t,a,l,i,c,d,o,x,m,h=(0,n.c)(23),{friends:f,onlineUsers:p,openChat:u,viewUserDetail:b,sendFriendRequest:g}=e;return h[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("span",{children:"ğŸ‘¥"}),h[0]=t):t=h[0],h[1]!==f.length?(a=(0,s.jsxs)("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[t," æˆ‘çš„å¥½å‹ (",f.length,")"]}),h[1]=f.length,h[2]=a):a=h[2],h[3]!==f||h[4]!==u||h[5]!==b?(l=0===f.length?(0,s.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,s.jsx)("p",{children:"é‚„æ²’æœ‰å¥½å‹"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"å¾ä¸‹æ–¹çš„ç·šä¸Šç”¨æˆ¶ä¸­æ·»åŠ å¥½å‹å§ï¼"})]}):(0,s.jsx)("div",{className:"space-y-2",children:f.map(e=>(0,s.jsxs)("div",{onClick:()=>b(e.id),className:"bg-slate-800/50 p-3 rounded-xl border border-slate-700/50 hover:border-indigo-500/50 transition-all cursor-pointer relative group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-10 h-10 rounded-full border-2 border-indigo-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium text-white",children:e.username}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:e.seconds_offline<30?(0,s.jsx)("span",{className:"text-green-400",children:"â— ç·šä¸Š"}):(0,r.formatLastOnline)(e.seconds_offline)})]})]}),(0,s.jsx)("button",{onClick:s=>{s.stopPropagation(),u(e)},className:"absolute top-2 right-2 p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-full transition-colors",title:"èŠå¤©",children:"ğŸ’¬"})]},e.id))}),h[3]=f,h[4]=u,h[5]=b,h[6]=l):l=h[6],h[7]!==a||h[8]!==l?(i=(0,s.jsxs)("div",{className:"mb-8",children:[a,l]}),h[7]=a,h[8]=l,h[9]=i):i=h[9],h[10]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)("span",{children:"ğŸŒ"}),h[10]=c):c=h[10],h[11]!==p.length?(d=(0,s.jsxs)("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[c," ç·šä¸Šç©å®¶ (",p.length,")"]}),h[11]=p.length,h[12]=d):d=h[12],h[13]!==p||h[14]!==g||h[15]!==b?(o=0===p.length?(0,s.jsx)("div",{className:"text-center py-8 text-slate-500",children:(0,s.jsx)("p",{children:"ç›®å‰æ²’æœ‰å…¶ä»–ç·šä¸Šç©å®¶"})}):(0,s.jsx)("div",{className:"space-y-2",children:p.map(e=>(0,s.jsxs)("div",{className:"w-full bg-slate-800/30 p-3 rounded-xl flex items-center gap-3 border border-slate-700/30",children:[(0,s.jsxs)("button",{onClick:()=>b(e.id),className:"flex items-center gap-3 flex-1 hover:opacity-80 transition-opacity",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-10 h-10 rounded-full border-2 border-slate-600"}),(0,s.jsxs)("div",{className:"flex-1 text-left",children:[(0,s.jsx)("p",{className:"font-medium text-white",children:e.username}),(0,s.jsx)("p",{className:"text-xs text-green-400",children:"â— ç·šä¸Š"})]})]}),(0,s.jsx)("button",{onClick:s=>{s.stopPropagation(),g(e.id)},className:"px-3 py-1 bg-indigo-500 hover:bg-indigo-600 text-white text-sm rounded-lg transition-colors flex-shrink-0",children:"åŠ å¥½å‹"})]},e.id))}),h[13]=p,h[14]=g,h[15]=b,h[16]=o):o=h[16],h[17]!==d||h[18]!==o?(x=(0,s.jsxs)("div",{children:[d,o]}),h[17]=d,h[18]=o,h[19]=x):x=h[19],h[20]!==i||h[21]!==x?(m=(0,s.jsxs)("section",{className:"w-80 flex flex-col bg-[#0f172a] p-6 overflow-y-auto border-l border-slate-800 flex-shrink-0",children:[i,x]}),h[20]=i,h[21]=x,h[22]=m):m=h[22],m}function x({user:e}){let r=(0,a.useRouter)(),[n,i]=(0,t.useState)([]);async function c(){try{let e=await (0,l.api)("/api/matchmaking/active");e.ok&&i(await e.json())}catch(e){console.error("Failed to fetch active battles:",e)}}(0,t.useEffect)(()=>{c();let e=setInterval(c,1e4);return()=>clearInterval(e)},[]);let d=n.filter(s=>e&&(s.player1_id===e.id||s.player2_id===e.id)),o=n.filter(s=>!e||s.player1_id!==e.id&&s.player2_id!==e.id),x=({battle:e,isMyBattle:t})=>(0,s.jsxs)("div",{className:`bg-slate-800/50 rounded-xl p-3 border transition-all cursor-pointer group ${t?"border-indigo-500/50 hover:border-indigo-400 hover:bg-indigo-900/20":"border-slate-700/50 hover:border-indigo-500/30 hover:bg-slate-800"}`,onClick:()=>r.push(`/battle?id=${e.id}`),children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:`text-xs px-2 py-0.5 rounded-full ${"ranked"===e.mode?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-blue-500/20 text-blue-400 border border-blue-500/30"}`,children:"ranked"===e.mode?"ç©åˆ†å°æˆ°":"ä¸€èˆ¬å°æˆ°"}),t&&(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full bg-green-500/20 text-green-400 border border-green-500/30 animate-pulse",children:"é€²è¡Œä¸­"})]}),(0,s.jsx)("span",{className:"text-xs text-slate-500",children:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,s.jsx)("img",{src:e.player1_avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.player1_name}`,alt:e.player1_name,className:"w-8 h-8 rounded-full bg-slate-700"}),(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-slate-200 truncate",children:e.player1_name}),(0,s.jsx)("div",{className:"text-xs text-slate-500",children:e.player1_rating?`Rating: ${e.player1_rating}`:"Unranked"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-slate-600 font-bold text-sm",children:"VS"}),!t&&(0,s.jsx)("span",{className:"text-[10px] text-indigo-400 opacity-0 group-hover:opacity-100 transition-opacity",children:"è§€æˆ°"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0 justify-end text-right",children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-slate-200 truncate",children:e.player2_name}),(0,s.jsx)("div",{className:"text-xs text-slate-500",children:e.player2_rating?`Rating: ${e.player2_rating}`:"Unranked"})]}),(0,s.jsx)("img",{src:e.player2_avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.player2_name}`,alt:e.player2_name,className:"w-8 h-8 rounded-full bg-slate-700"})]})]})]});return(0,s.jsxs)("div",{className:"flex-1 bg-slate-900/50 border-x border-slate-800 flex flex-col min-w-0",children:[d.length>0&&(0,s.jsxs)("div",{className:"flex-shrink-0",children:[(0,s.jsx)("div",{className:"p-4 border-b border-slate-800 bg-indigo-900/10",children:(0,s.jsxs)("h2",{className:"text-lg font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{children:"âš”ï¸"})," æˆ‘çš„å°æˆ°"]})}),(0,s.jsx)("div",{className:"p-4 space-y-3 border-b border-slate-800",children:d.map(e=>(0,s.jsx)(x,{battle:e,isMyBattle:!0},e.id))})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,s.jsx)("div",{className:"p-4 border-b border-slate-800",children:(0,s.jsxs)("h2",{className:"text-lg font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),"æ­£åœ¨é€²è¡Œçš„å°æˆ°"]})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:0===o.length?(0,s.jsx)("div",{className:"text-center py-12 text-slate-500",children:(0,s.jsx)("p",{children:"ç›®å‰æ²’æœ‰å…¶ä»–æ­£åœ¨é€²è¡Œçš„å°æˆ°"})}):o.map(e=>(0,s.jsx)(x,{battle:e,isMyBattle:!1},e.id))})]})]})}function m(e){let t,a,i,c,d,o,x=(0,n.c)(14),{showAvatarPicker:m,setShowAvatarPicker:h,currentAvatar:f,onUpdate:p}=e;x[0]!==p||x[1]!==h?(t=async function(e){let s=`https://api.dicebear.com/7.x/avataaars/svg?seed=${e}`;try{let e=await (0,l.api)("/api/users/me",{method:"PATCH",body:JSON.stringify({avatar_url:s})});if(e.ok){let s=await e.json();p(s),h(!1)}}catch(e){console.error("Failed to update avatar:",e)}},x[0]=p,x[1]=h,x[2]=t):t=x[2];let u=t;return m?(x[3]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"é¸æ“‡ä½ çš„é ­åƒ"}),x[3]=a):a=x[3],x[4]!==h?(i=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[a,(0,s.jsx)("button",{onClick:()=>h(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"Ã—"})]}),x[4]=h,x[5]=i):i=x[5],x[6]!==f||x[7]!==u?(c=r.AVATAR_OPTIONS.map(e=>{let t=`https://api.dicebear.com/7.x/avataaars/svg?seed=${e}`,a=f===t;return(0,s.jsxs)("button",{onClick:()=>u(e),className:`relative w-full aspect-square rounded-xl overflow-hidden border-4 transition-all hover:scale-105 ${a?"border-indigo-500 shadow-lg shadow-indigo-500/50":"border-slate-700 hover:border-slate-500"}`,children:[(0,s.jsx)("img",{src:t,alt:e,className:"w-full h-full object-cover bg-gradient-to-br from-indigo-600 to-purple-400"}),a&&(0,s.jsx)("div",{className:"absolute inset-0 bg-indigo-500/20 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-3xl",children:"âœ“"})})]},e)}),x[6]=f,x[7]=u,x[8]=c):c=x[8],x[9]!==c?(d=(0,s.jsx)("div",{className:"grid grid-cols-5 gap-4 max-h-96 overflow-y-auto p-2",children:c}),x[9]=c,x[10]=d):d=x[10],x[11]!==i||x[12]!==d?(o=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-2xl border border-slate-700 shadow-2xl",children:[i,d]})}),x[11]=i,x[12]=d,x[13]=o):o=x[13],o):null}function h({showProfileEdit:e,setShowProfileEdit:a,user:r,onUpdate:n}){let[i,c]=(0,t.useState)(""),[d,o]=(0,t.useState)("");async function x(){try{let e=await (0,l.api)("/api/users/me",{method:"PATCH",body:JSON.stringify({username:i,bio:d})});if(e.ok){let s=await e.json();n(s),a(!1)}else{let s=await e.json();alert(s.error||"æ›´æ–°å¤±æ•—")}}catch(e){console.error("Failed to update profile:",e),alert("æ›´æ–°å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}}return((0,t.useEffect)(()=>{e&&r&&(c(r.username||""),o(r.bio||""))},[e,r]),e)?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-md border border-slate-700 shadow-2xl",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"ç·¨è¼¯å€‹äººè³‡æ–™"}),(0,s.jsx)("button",{onClick:()=>a(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"Ã—"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"ä½¿ç”¨è€…åç¨±"}),(0,s.jsx)("input",{type:"text",value:i,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-indigo-500 transition-colors",placeholder:"è¼¸å…¥ä½¿ç”¨è€…åç¨±",maxLength:20})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"å€‹äººç°¡ä»‹"}),(0,s.jsx)("textarea",{value:d,onChange:e=>o(e.target.value),className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-indigo-500 transition-colors resize-none",placeholder:"å¯«é»é—œæ–¼è‡ªå·±çš„äº‹æƒ…...",rows:3,maxLength:100}),(0,s.jsxs)("p",{className:"text-xs text-slate-500 mt-1 text-right",children:[d.length," / 100"]})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)("button",{onClick:()=>a(!1),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"å–æ¶ˆ"}),(0,s.jsx)("button",{onClick:x,className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-medium transition-colors",children:"å„²å­˜"})]})]})}):null}function f(e){let t,a,l,i,d,o,x,m,h,f,u,b,g,j,N,v,w,y,_,k=(0,n.c)(60),{showUserDetail:S,setShowUserDetail:C,selectedUser:$,addFriend:I,removeFriend:R,onChallenge:T}=e;if(!S||!$)return null;let O=p;k[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"ç©å®¶è³‡æ–™"}),k[0]=t):t=k[0],k[1]!==C?(a=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[t,(0,s.jsx)("button",{onClick:()=>C(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"Ã—"})]}),k[1]=C,k[2]=a):a=k[2];let F=$.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${$.username}`;k[3]!==$.username||k[4]!==F?(l=(0,s.jsx)("img",{src:F,alt:$.username,className:"w-24 h-24 rounded-full border-4 border-indigo-500 mb-4"}),k[3]=$.username,k[4]=F,k[5]=l):l=k[5],k[6]!==$.username?(i=(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:$.username}),k[6]=$.username,k[7]=i):i=k[7],k[8]!==$.seconds_offline?(d=$.seconds_offline<300?(0,s.jsx)("p",{className:"text-green-400 text-sm mt-1",children:"â— ç·šä¸Š"}):(0,s.jsxs)("p",{className:"text-slate-400 text-sm mt-1",children:["é›¢ç·š ",(0,r.formatLastOnline)($.seconds_offline)]}),k[8]=$.seconds_offline,k[9]=d):d=k[9],k[10]!==$.bio?(o=$.bio&&(0,s.jsx)("p",{className:"text-slate-300 text-sm mt-3 text-center italic",children:$.bio}),k[10]=$.bio,k[11]=o):o=k[11],k[12]!==$.rating?(x=$.rating&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(c.default,{rating:$.rating,size:64})}),k[12]=$.rating,k[13]=x):x=k[13],k[14]!==T||k[15]!==$.id||k[16]!==$.is_friend?(m=$.is_friend&&T&&(0,s.jsxs)("button",{onClick:()=>T($.id),className:"px-6 py-2 bg-amber-600 hover:bg-amber-500 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[(0,s.jsx)("span",{children:"âš”ï¸"})," ç´„æˆ°"]}),k[14]=T,k[15]=$.id,k[16]=$.is_friend,k[17]=m):m=k[17],k[18]!==I||k[19]!==R||k[20]!==$.id||k[21]!==$.is_friend||k[22]!==C?(h=$.is_friend?R&&(0,s.jsx)("button",{onClick:()=>{confirm("ç¢ºå®šè¦åˆªé™¤é€™ä½å¥½å‹å—ï¼Ÿ")&&(R($.id),C(!1))},className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-medium transition-colors",children:"åˆªé™¤å¥½å‹"}):(0,s.jsx)("button",{onClick:()=>I($.id),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-medium transition-colors",children:"åŠ ç‚ºå¥½å‹"}),k[18]=I,k[19]=R,k[20]=$.id,k[21]=$.is_friend,k[22]=C,k[23]=h):h=k[23],k[24]!==h||k[25]!==m?(f=(0,s.jsxs)("div",{className:"flex gap-3 mt-4 w-full justify-center",children:[m,h]}),k[24]=h,k[25]=m,k[26]=f):f=k[26],k[27]!==f||k[28]!==l||k[29]!==i||k[30]!==d||k[31]!==o||k[32]!==x?(u=(0,s.jsxs)("div",{className:"flex flex-col items-center mb-6",children:[l,i,d,o,x,f]}),k[27]=f,k[28]=l,k[29]=i,k[30]=d,k[31]=o,k[32]=x,k[33]=u):u=k[33],k[34]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)("h4",{className:"text-xs font-bold text-amber-400 mb-3 uppercase tracking-wider",children:"ç©åˆ†å°æˆ°"}),k[34]=b):b=k[34],k[35]!==$.ranked_games_played||k[36]!==$.ranked_games_won||k[37]!==$.rating?(g=(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl",children:[b,$.ranked_games_played<5?(0,s.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[(0,s.jsx)("p",{className:"text-sm text-amber-400 text-center font-medium",children:"å®šç´šä¸­"}),(0,s.jsx)("p",{className:"text-xs text-slate-400 text-center mt-2",children:"å®Œæˆ 5 å ´å®šç´šè³½å¾Œå°‡é¡¯ç¤ºæ®µä½"}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"å·²å®Œæˆ"}),(0,s.jsxs)("span",{className:"font-bold text-white",children:[$.ranked_games_played,"/5"]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"å‹å ´"}),(0,s.jsx)("span",{className:"font-bold text-green-400",children:$.ranked_games_won})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs block",children:"æ®µä½"}),(0,s.jsx)("span",{className:`font-bold text-lg ${(0,r.getRankInfo)($.rating).color}`,children:(0,r.getRankInfo)($.rating).nameZh})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs block",children:"Rating"}),(0,s.jsx)("span",{className:"font-bold text-lg text-amber-400",children:$.rating})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"å‹å ´"}),(0,s.jsx)("span",{className:"font-bold text-green-400",children:$.ranked_games_won})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"æ•—å ´"}),(0,s.jsx)("span",{className:"font-bold text-red-400",children:$.ranked_games_played-$.ranked_games_won})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ç¸½å ´æ¬¡"}),(0,s.jsx)("span",{className:"font-bold text-white",children:$.ranked_games_played})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"å‹ç‡"}),(0,s.jsxs)("span",{className:"font-bold text-emerald-400",children:[$.ranked_games_played>0?Math.round($.ranked_games_won/$.ranked_games_played*100):0,"%"]})]})]})]})]}),k[35]=$.ranked_games_played,k[36]=$.ranked_games_won,k[37]=$.rating,k[38]=g):g=k[38];let P=$.casual_games_played||0,M=$.casual_games_won||0;k[39]!==P||k[40]!==M?(j=O("ä¸€èˆ¬å°æˆ°",P,M,"text-blue-400"),k[39]=P,k[40]=M,k[41]=j):j=k[41];let E=$.custom_games_played||0,A=$.custom_games_won||0;return k[42]!==E||k[43]!==A?(N=O("å¥½å‹å°æˆ°",E,A,"text-purple-400"),k[42]=E,k[43]=A,k[44]=N):N=k[44],k[45]!==g||k[46]!==j||k[47]!==N?(v=(0,s.jsxs)("div",{className:"space-y-4 mb-6",children:[g,j,N]}),k[45]=g,k[46]=j,k[47]=N,k[48]=v):v=k[48],k[49]!==$.ranked_games_played||k[50]!==$.rating?(w=$.ranked_games_played>=10&&(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl mb-6",children:[(0,s.jsx)("h4",{className:"text-sm font-bold text-white mb-3",children:"Rating åˆ†ä½ˆ"}),(0,s.jsxs)("div",{className:"relative pt-6 pb-2",children:[(0,s.jsxs)("div",{className:"absolute top-0 left-0 right-0 flex justify-between text-[10px] text-slate-500",children:[(0,s.jsx)("span",{style:{left:"0%"},className:"absolute",children:"0"}),(0,s.jsx)("span",{style:{left:"14%"},className:"absolute",children:"800"}),(0,s.jsx)("span",{style:{left:"28%"},className:"absolute",children:"1200"}),(0,s.jsx)("span",{style:{left:"42%"},className:"absolute",children:"1500"}),(0,s.jsx)("span",{style:{left:"57%"},className:"absolute",children:"1800"}),(0,s.jsx)("span",{style:{left:"71%"},className:"absolute",children:"2200"}),(0,s.jsx)("span",{style:{left:"85%"},className:"absolute",children:"2500"})]}),(0,s.jsxs)("div",{className:"relative h-4 bg-slate-800 rounded-full overflow-hidden mt-1",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-slate-600 via-amber-700 via-slate-400 via-yellow-500 via-cyan-500 via-blue-600 to-purple-600 opacity-50"}),(0,s.jsx)("div",{className:"absolute top-0 bottom-0 w-1 bg-white shadow-[0_0_10px_rgba(255,255,255,0.8)] z-10",style:{left:`${Math.min(Math.max($.rating/3e3*100,0),100)}%`},children:(0,s.jsx)("div",{className:"absolute -top-7 left-1/2 transform -translate-x-1/2 bg-slate-800 text-white text-xs font-bold px-2 py-0.5 rounded border border-slate-600 whitespace-nowrap",children:$.rating})})]}),(0,s.jsxs)("div",{className:"flex justify-between items-start mt-2 px-1",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-500",children:"éµ"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"0-800"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-amber-700",children:"éŠ…"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"800+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-slate-300",children:"éŠ€"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"1200+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-yellow-500",children:"é‡‘"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"1500+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-cyan-400",children:"ç™½é‡‘"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"1800+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-blue-400",children:"é‘½çŸ³"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"2200+"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,s.jsx)("span",{className:"text-[10px] text-purple-400",children:"å¤§å¸«"}),(0,s.jsx)("span",{className:"text-[9px] text-slate-600",children:"2500+"})]})]})]})]}),k[49]=$.ranked_games_played,k[50]=$.rating,k[51]=w):w=k[51],k[52]!==C?(y=(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("button",{onClick:()=>C(!1),className:"w-full px-4 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-medium transition-colors",children:"é—œé–‰"})}),k[52]=C,k[53]=y):y=k[53],k[54]!==u||k[55]!==a||k[56]!==v||k[57]!==w||k[58]!==y?(_=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-lg border border-slate-700 shadow-2xl max-h-[90vh] overflow-y-auto",children:[a,u,v,w,y]})}),k[54]=u,k[55]=a,k[56]=v,k[57]=w,k[58]=y,k[59]=_):_=k[59],_}function p(e,t,a,l){let r=t>0?Math.round(a/t*100):0;return(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:`text-xs font-bold ${l} mb-3 uppercase tracking-wider`,children:e}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"å‹å ´"}),(0,s.jsx)("span",{className:"font-bold text-green-400",children:a})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"æ•—å ´"}),(0,s.jsx)("span",{className:"font-bold text-red-400",children:t-a})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"ç¸½å ´æ¬¡"}),(0,s.jsx)("span",{className:"font-bold text-white",children:t})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-slate-400 text-xs",children:"å‹ç‡"}),(0,s.jsxs)("span",{className:"font-bold text-emerald-400",children:[r,"%"]})]})]})]})}function u(e){let t,a,l,i,c,d=(0,n.c)(16),{showFriendRequests:o,setShowFriendRequests:x,friendRequests:m,acceptFriendRequest:h,rejectFriendRequest:f,battleInvites:p,acceptBattleInvite:u,rejectBattleInvite:b}=e;d[0]!==p?(t=void 0===p?[]:p,d[0]=p,d[1]=t):t=d[1];let g=t;if(!o)return null;let j=m.length>0||g.length>0;return d[2]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:"é€šçŸ¥ä¸­å¿ƒ"}),d[2]=a):a=d[2],d[3]!==x?(l=(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[a,(0,s.jsx)("button",{onClick:()=>x(!1),className:"text-slate-400 hover:text-white text-2xl leading-none",children:"Ã—"})]}),d[3]=x,d[4]=l):l=d[4],d[5]!==u||d[6]!==h||d[7]!==g||d[8]!==m||d[9]!==j||d[10]!==b||d[11]!==f?(i=j?(0,s.jsxs)("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[g.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-bold text-amber-400 mb-3 uppercase tracking-wider",children:"å°æˆ°é‚€è«‹"}),(0,s.jsx)("div",{className:"space-y-3",children:g.map(e=>(0,s.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-xl border border-amber-500/30",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-12 h-12 rounded-full border-2 border-amber-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("p",{className:"font-medium text-white",children:[(0,s.jsx)("span",{className:"text-amber-400",children:e.username})," é‚€è«‹ä½ é€²è¡Œå°æˆ°"]}),(0,s.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:new Date(e.created_at).toLocaleTimeString()})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>u&&u(e.id),className:"flex-1 px-4 py-2 bg-amber-600 hover:bg-amber-500 text-white rounded-lg font-medium transition-colors",children:"æ¥å—æŒ‘æˆ°"}),(0,s.jsx)("button",{onClick:()=>b&&b(e.id),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"æ‹’çµ•"})]})]},e.id))})]}),m.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-bold text-indigo-400 mb-3 uppercase tracking-wider",children:"å¥½å‹è«‹æ±‚"}),(0,s.jsx)("div",{className:"space-y-3",children:m.map(e=>(0,s.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-xl border border-slate-700/50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("img",{src:e.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.username}`,alt:e.username,className:"w-12 h-12 rounded-full border-2 border-indigo-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium text-white",children:e.username}),e.games_played>=10?(0,s.jsxs)("p",{className:`text-sm ${(0,r.getRankInfo)(e.rating).color}`,children:[(0,r.getRankInfo)(e.rating).nameZh," Â· ",e.rating]}):(0,s.jsx)("p",{className:"text-sm text-amber-400",children:"å®šç´šä¸­"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>h(e.request_id),className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg font-medium transition-colors",children:"æ¥å—"}),(0,s.jsx)("button",{onClick:()=>f(e.request_id),className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-medium transition-colors",children:"æ‹’çµ•"})]})]},e.request_id))})]})]}):(0,s.jsx)("div",{className:"text-center py-8 text-slate-500",children:(0,s.jsx)("p",{children:"ç›®å‰æ²’æœ‰æ–°çš„é€šçŸ¥"})}),d[5]=u,d[6]=h,d[7]=g,d[8]=m,d[9]=j,d[10]=b,d[11]=f,d[12]=i):i=d[12],d[13]!==l||d[14]!==i?(c=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-2xl w-full max-w-md border border-slate-700 shadow-2xl",children:[l,i]})}),d[13]=l,d[14]=i,d[15]=c):c=d[15],c}function b({showChat:e,setShowChat:a,chatFriend:n,user:i}){let[c,d]=(0,t.useState)([]),[o,x]=(0,t.useState)(""),m=(0,t.useRef)(null);(0,t.useEffect)(()=>{if(e&&n){f();let e=setInterval(f,3e3);return()=>clearInterval(e)}},[e,n]),(0,t.useEffect)(()=>{h()},[c]);let h=()=>{m.current?.scrollIntoView({behavior:"smooth"})};async function f(){if(n)try{let e=await (0,l.api)(`/api/friends/messages/${n.id}`);if(e.ok){let s=await e.json();d(s)}}catch(e){console.error("Failed to load messages:",e)}}async function p(){if(o.trim()&&n)try{(await (0,l.api)(`/api/friends/send-message/${n.id}`,{method:"POST",body:JSON.stringify({content:o})})).ok&&(x(""),f())}catch(e){console.error("Failed to send message:",e)}}return e&&n?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] rounded-2xl w-full max-w-2xl h-[600px] border border-slate-700 shadow-2xl flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:n.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${n.username}`,alt:n.username,className:"w-10 h-10 rounded-full border-2 border-indigo-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-white",children:n.username}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:n.seconds_offline<30?(0,s.jsx)("span",{className:"text-green-400",children:"â— ç·šä¸Š"}):(0,r.formatLastOnline)(n.seconds_offline)})]})]}),(0,s.jsx)("button",{onClick:()=>{a(!1)},className:"text-slate-400 hover:text-white text-2xl leading-none",children:"Ã—"})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[0===c.length?(0,s.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,s.jsx)("p",{children:"é‚„æ²’æœ‰è¨Šæ¯"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"é–‹å§‹èŠå¤©å§ï¼"})]}):c.map(e=>{let t=e.sender_id===i?.id;return(0,s.jsx)("div",{className:`flex ${t?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`max-w-[70%] ${t?"items-end":"items-start"} flex flex-col`,children:[(0,s.jsx)("div",{className:`px-4 py-2 rounded-2xl ${t?"bg-indigo-600 text-white":"bg-slate-700 text-slate-200"}`,children:e.content}),(0,s.jsx)("span",{className:"text-xs text-slate-500 mt-1 px-1",children:function(e){let s=new Date(e),t=Math.floor((new Date().getTime()-s.getTime())/1e3);if(t<60)return"å‰›å‰›";let a=Math.floor(t/60);if(a<60)return`${a} åˆ†é˜å‰`;let l=Math.floor(a/60);return l<24?`${l} å°æ™‚å‰`:s.toLocaleString("zh-TW",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}(e.created_at)})]})},e.id)}),(0,s.jsx)("div",{ref:m})]}),(0,s.jsx)("div",{className:"p-4 border-t border-slate-700 bg-slate-800/50 rounded-b-2xl",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:o,onChange:e=>x(e.target.value),onKeyDown:e=>"Enter"===e.key&&p(),placeholder:"è¼¸å…¥è¨Šæ¯...",className:"flex-1 px-4 py-2 bg-slate-900 border border-slate-700 rounded-full text-white focus:outline-none focus:border-indigo-500 transition-colors"}),(0,s.jsx)("button",{onClick:p,disabled:!o.trim(),className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-700 disabled:text-slate-500 text-white rounded-full font-medium transition-colors",children:"ç™¼é€"})]})})]})}):null}function g(e){let t,a,l=(0,n.c)(6),{isMatching:r,matchStatus:i,matchMode:d,cancelMatching:o,opponent:x}=e;return r?(l[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-indigo-500 to-transparent animate-shimmer"}),l[0]=t):t=l[0],l[1]!==o||l[2]!==d||l[3]!==i||l[4]!==x?(a=(0,s.jsx)("div",{className:"fixed inset-0 bg-slate-900/90 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-slate-800 p-8 rounded-2xl border border-slate-700 shadow-2xl max-w-md w-full text-center relative overflow-hidden",children:[t,"waiting"===i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-6 relative",children:[(0,s.jsx)("div",{className:"w-24 h-24 mx-auto border-4 border-indigo-500/30 border-t-indigo-500 rounded-full animate-spin"}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-4xl",children:"ğŸ”"})})]}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-white mb-2",children:"æ­£åœ¨å°‹æ‰¾å°æ‰‹..."}),(0,s.jsxs)("p",{className:"text-slate-400 mb-8",children:["ranked"===d?"ç©åˆ†å°æˆ°":"ranked_rts"===d?"å³æ™‚ç©åˆ†":"casual_rts"===d?"å³æ™‚ä¸€èˆ¬":"ä¸€èˆ¬å°æˆ°"," â€¢ é è¨ˆç­‰å¾…æ™‚é–“: 30ç§’"]}),(0,s.jsx)("button",{onClick:o,className:"px-8 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition-colors",children:"å–æ¶ˆåŒ¹é…"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-6 relative",children:(0,s.jsx)("div",{className:"w-24 h-24 mx-auto bg-green-500 rounded-full flex items-center justify-center animate-bounce",children:(0,s.jsx)("span",{className:"text-4xl",children:"âš”ï¸"})})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-white mb-2",children:"åŒ¹é…æˆåŠŸï¼"}),(0,s.jsx)("p",{className:"text-slate-400 mb-6",children:"å³å°‡é–‹å§‹å°æˆ°"}),x&&(0,s.jsxs)("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-slate-700 mb-6 flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-slate-700 rounded-full overflow-hidden",children:(0,s.jsx)("img",{src:x.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${x.username}`,alt:x.username,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"text-left flex-1",children:[(0,s.jsx)("div",{className:"font-bold text-white",children:x.username}),(0,s.jsxs)("div",{className:"text-sm text-slate-400",children:["Rating: ",null!==x.rating?x.rating:"æœªå®šç´š"]})]}),null!==x.rating&&(0,s.jsx)(c.default,{rating:x.rating,size:40})]}),(0,s.jsx)("div",{className:"w-full bg-slate-700 h-2 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-green-500 animate-[width_3s_linear_forwards]",style:{width:"100%"}})})]})]})}),l[1]=o,l[2]=d,l[3]=i,l[4]=x,l[5]=a):a=l[5],a):null}let j=["IRON","BRONZE","SILVER","GOLD","PLATINUM","DIAMOND","MASTER","GRANDMASTER"],N={IRON:{nameZh:"éµç‰Œ",gradient:"from-zinc-500 to-zinc-700",rating:700},BRONZE:{nameZh:"éŠ…ç‰Œ",gradient:"from-amber-600 to-amber-800",rating:900},SILVER:{nameZh:"éŠ€ç‰Œ",gradient:"from-slate-300 to-slate-500",rating:1100},GOLD:{nameZh:"é‡‘ç‰Œ",gradient:"from-yellow-300 to-yellow-600",rating:1350},PLATINUM:{nameZh:"ç™½é‡‘",gradient:"from-cyan-300 to-cyan-600",rating:1650},DIAMOND:{nameZh:"é‘½çŸ³",gradient:"from-blue-400 to-blue-700",rating:2e3},MASTER:{nameZh:"å¤§å¸«",gradient:"from-purple-400 to-purple-700",rating:2300},GRANDMASTER:{nameZh:"å®—å¸«",gradient:"from-red-400 to-red-700",rating:2600}};function v(e){let a,r,i,d,o,x,m,h,f,p=(0,n.c)(17),{show:u,onClose:b}=e;p[0]===Symbol.for("react.memo_cache_sentinel")?(a=[],p[0]=a):a=p[0];let[g,v]=(0,t.useState)(a),[_,k]=(0,t.useState)(!0);if(p[1]!==u?(r=()=>{u&&(k(!0),(0,l.api)("/api/users/rank-distribution").then(y).then(e=>{v(j.map(s=>{let t=e.find(e=>e.rank===s);return{rank:s,count:t?t.count:0}})),k(!1)}).catch(e=>{console.error(e),k(!1)}))},i=[u],p[1]=u,p[2]=r,p[3]=i):(r=p[2],i=p[3]),(0,t.useEffect)(r,i),!u)return null;p[4]!==g?(d=Math.max(...g.map(w),1),p[4]=g,p[5]=d):d=p[5];let S=d;return p[6]!==b?(o=(0,s.jsx)("button",{onClick:b,className:"absolute top-4 right-4 text-slate-400 hover:text-white text-2xl leading-none",children:"Ã—"}),p[6]=b,p[7]=o):o=p[7],p[8]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("h2",{className:"text-2xl font-bold text-white mb-8 text-center",children:"å…¨æœæ®µä½åˆ†ä½ˆ"}),p[8]=x):x=p[8],p[9]!==g||p[10]!==_||p[11]!==S?(m=_?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):(0,s.jsx)("div",{className:"h-80 flex items-end justify-between gap-2 px-4",children:g.map(e=>{let t=N[e.rank],a=e.count/S*100;return(0,s.jsxs)("div",{className:"flex flex-col items-center flex-1 group relative",children:[(0,s.jsxs)("div",{className:"absolute bottom-full mb-2 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-800 text-white text-xs px-2 py-1 rounded border border-slate-600 whitespace-nowrap z-10",children:[e.count," äºº (",t.nameZh,")"]}),(0,s.jsx)("div",{className:`w-full rounded-t-lg bg-gradient-to-t ${t.gradient} transition-all duration-500 hover:brightness-110 relative`,style:{height:`${Math.max(a,2)}%`},children:(0,s.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 bg-white/30"})}),(0,s.jsxs)("div",{className:"mt-3 flex flex-col items-center gap-1",children:[(0,s.jsx)("div",{className:"transform transition-transform group-hover:scale-110",children:(0,s.jsx)(c.default,{rating:t.rating,size:32})}),(0,s.jsx)("span",{className:"text-[10px] text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity absolute top-full mt-1 whitespace-nowrap",children:t.nameZh})]})]},e.rank)})}),p[9]=g,p[10]=_,p[11]=S,p[12]=m):m=p[12],p[13]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsx)("div",{className:"mt-8 text-center text-slate-500 text-sm",children:"çµ±è¨ˆç¯„åœï¼šå®Œæˆ 10 å ´å®šç´šè³½çš„æ´»èºç©å®¶"}),p[13]=h):h=p[13],p[14]!==o||p[15]!==m?(f=(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-[#1e293b] p-8 rounded-2xl w-full max-w-4xl border border-slate-700 shadow-2xl relative",children:[o,x,m,h]})}),p[14]=o,p[15]=m,p[16]=f):f=p[16],f}function w(e){return e.count}function y(e){return e.json()}function _(e){let a,l,r,i,c,d,o,x,m,h,f,p,u,b,g,j,N,v,w,y,_,$,I,R,T,O,F,P,M,E,A,z,q=(0,n.c)(51),{show:L,onClose:D}=e,[U,Z]=(0,t.useState)(0);q[0]!==L?(a=()=>{L&&Z(0)},l=[L],q[0]=L,q[1]=a,q[2]=l):(a=q[1],l=q[2]),(0,t.useEffect)(a,l),q[3]===Symbol.for("react.memo_cache_sentinel")?(r=()=>Z(C),q[3]=r):r=q[3];let B=r;q[4]===Symbol.for("react.memo_cache_sentinel")?(i=()=>Z(S),q[4]=i):i=q[4];let J=i;if(!L)return null;q[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsxs)("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{children:"ğŸ“"})," éŠæˆ²æ•™å­¸"]}),q[5]=c):c=q[5],q[6]!==D?(d=(0,s.jsxs)("div",{className:"p-6 border-b border-slate-800 flex justify-between items-center bg-slate-950",children:[c,(0,s.jsx)("button",{onClick:D,className:"text-slate-400 hover:text-white transition-colors text-2xl",children:"Ã—"})]}),q[6]=D,q[7]=d):d=q[7];let V=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${0===U?"opacity-100 translate-x-0":"opacity-0 -translate-x-full"}`;q[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2",children:(0,s.jsx)(k,{char:"ã„Œ",animate:!0})}),q[8]=o):o=q[8],q[9]===Symbol.for("react.memo_cache_sentinel")?(x=(0,s.jsx)("div",{className:"absolute top-[56px] left-[calc(50%-34px)]",children:(0,s.jsx)(k,{char:"ã„§",animate:!0})}),q[9]=x):x=q[9],q[10]===Symbol.for("react.memo_cache_sentinel")?(m=(0,s.jsx)("div",{className:"absolute top-[56px] left-[calc(50%+34px)]",children:(0,s.jsx)(k,{char:"ã„“",animate:!0})}),q[10]=m):m=q[10],q[11]===Symbol.for("react.memo_cache_sentinel")?(h=(0,s.jsxs)("div",{className:"relative w-64 h-48 flex items-center justify-center mb-2",children:[o,x,m,(0,s.jsx)("div",{className:"absolute top-[112px] left-1/2 transform -translate-x-1/2",children:(0,s.jsx)(k,{char:".",color:"slate",scale:.8})})]}),f=(0,s.jsx)("p",{className:"text-xl font-bold text-indigo-400 mb-2",children:"1. é€£æ¥ç¬¦è™Ÿçµ„æˆè©å½™"}),q[11]=h,q[12]=f):(h=q[11],f=q[12]),q[13]===Symbol.for("react.memo_cache_sentinel")?(p=(0,s.jsxs)("div",{className:"text-slate-400 text-sm text-center max-w-md px-4",children:[(0,s.jsxs)("p",{className:"mb-1",children:["é»æ“Šåœ°åœ–ä¸Šçš„",(0,s.jsx)("span",{className:"text-white font-bold",children:"æœªä½”é ˜å€åŸŸï¼ˆç™½è‰²åº•è‰²ï¼‰"})]}),(0,s.jsx)("p",{children:"é€£æ¥ç›¸é„°çš„æ³¨éŸ³ç¬¦è™Ÿï¼Œçµ„æˆå­—å…¸ä¸­å­˜åœ¨çš„è©å½™ï¼ˆå¦‚ï¼šã„Œã„§ã„“ è”æï¼‰"})]}),q[13]=p):p=q[13],q[14]!==V?(u=(0,s.jsxs)("div",{className:V,children:[h,f,p]}),q[14]=V,q[15]=u):u=q[15];let G=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${1===U?"opacity-100 translate-x-0":U>1?"opacity-0 -translate-x-full":"opacity-0 translate-x-full"}`;q[16]===Symbol.for("react.memo_cache_sentinel")?(b=(0,s.jsx)("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2",children:(0,s.jsx)(k,{char:"",color:"red"})}),q[16]=b):b=q[16],q[17]===Symbol.for("react.memo_cache_sentinel")?(g=(0,s.jsx)("div",{className:"absolute top-[56px] left-[calc(50%-34px)]",children:(0,s.jsx)(k,{char:"",color:"red"})}),q[17]=g):g=q[17],q[18]===Symbol.for("react.memo_cache_sentinel")?(j=(0,s.jsx)("div",{className:"absolute top-[56px] left-[calc(50%+34px)]",children:(0,s.jsx)(k,{char:"",color:"red"})}),q[18]=j):j=q[18],q[19]===Symbol.for("react.memo_cache_sentinel")?(N=(0,s.jsxs)("div",{className:"relative w-64 h-48 flex items-center justify-center mb-2",children:[b,g,j,(0,s.jsx)("div",{className:"absolute top-[112px] left-1/2 transform -translate-x-1/2",children:(0,s.jsx)(k,{char:"",color:"slate",scale:.8})})]}),v=(0,s.jsx)("p",{className:"text-xl font-bold text-red-400 mb-2",children:"2. ä½”é ˜åœ°ç›¤"}),q[19]=N,q[20]=v):(N=q[19],v=q[20]),q[21]===Symbol.for("react.memo_cache_sentinel")?(w=(0,s.jsxs)("p",{className:"text-slate-400 text-sm text-center px-4",children:["æˆåŠŸçµ„è©å¾Œï¼Œè©²å€åŸŸå°‡è®Šç‚ºä½ çš„é ˜åœ°ã€‚",(0,s.jsx)("br",{}),"é€£æ¥åˆ°å°æ–¹åŸå ¡å³å¯ç²å‹ï¼"]}),q[21]=w):w=q[21],q[22]!==G?(y=(0,s.jsxs)("div",{className:G,children:[N,v,w]}),q[22]=G,q[23]=y):y=q[23];let K=`absolute inset-0 flex flex-col items-center justify-center transition-all duration-500 ${2===U?"opacity-100 translate-x-0":"opacity-0 translate-x-full"}`;q[24]===Symbol.for("react.memo_cache_sentinel")?(_=(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("div",{className:"w-24 h-24 rounded-full bg-purple-600 flex items-center justify-center text-5xl shadow-[0_0_30px_rgba(147,51,234,0.5)] animate-bounce",children:"ğŸ²"}),(0,s.jsx)("div",{className:"absolute -bottom-2 -right-2 bg-yellow-400 text-black text-xs font-bold px-2 py-1 rounded-full border-2 border-slate-900",children:"Skill Ready!"})]}),$=(0,s.jsx)("p",{className:"text-xl font-bold text-purple-400 mb-2",children:"3. ä½¿ç”¨æŠ€èƒ½"}),I=(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"æ¯å›åˆç´¯ç©èƒ½é‡ï¼Œé›†æ»¿ 3 é»å¯ç²å¾—æŠ€èƒ½é“å…·ï¼Œæ”¹è®Šæˆ°å±€ï¼"}),q[24]=_,q[25]=$,q[26]=I):(_=q[24],$=q[25],I=q[26]),q[27]!==K?(R=(0,s.jsxs)("div",{className:K,children:[_,$,I]}),q[27]=K,q[28]=R):R=q[28],q[29]!==u||q[30]!==y||q[31]!==R?(T=(0,s.jsxs)("div",{className:"w-full h-72 bg-slate-950 rounded-xl border border-slate-800 mb-6 relative overflow-hidden flex items-center justify-center",children:[u,y,R]}),q[29]=u,q[30]=y,q[31]=R,q[32]=T):T=q[32],q[33]===Symbol.for("react.memo_cache_sentinel")?(O=[0,1,2],q[33]=O):O=q[33],q[34]!==U?(F=(0,s.jsx)("div",{className:"flex gap-2 mb-8",children:O.map(e=>(0,s.jsx)("div",{className:`w-3 h-3 rounded-full transition-all duration-300 ${U===e?"bg-indigo-500 scale-125":"bg-slate-700"}`},e))}),q[34]=U,q[35]=F):F=q[35];let H=0===U;return q[36]!==H?(P=(0,s.jsx)("button",{onClick:J,disabled:H,className:"flex-1 py-3 rounded-xl font-bold transition-all bg-slate-800 hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed text-slate-300",children:"ä¸Šä¸€æ­¥"}),q[36]=H,q[37]=P):P=q[37],q[38]!==D||q[39]!==U?(M=U<2?(0,s.jsx)("button",{onClick:B,className:"flex-1 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-indigo-500/25",children:"ä¸‹ä¸€æ­¥"}):(0,s.jsx)("button",{onClick:D,className:"flex-1 py-3 bg-green-600 hover:bg-green-500 text-white rounded-xl font-bold transition-all shadow-lg hover:shadow-green-500/25",children:"é–‹å§‹æˆ°é¬¥ï¼"}),q[38]=D,q[39]=U,q[40]=M):M=q[40],q[41]!==P||q[42]!==M?(E=(0,s.jsxs)("div",{className:"flex gap-4 w-full",children:[P,M]}),q[41]=P,q[42]=M,q[43]=E):E=q[43],q[44]!==T||q[45]!==F||q[46]!==E?(A=(0,s.jsxs)("div",{className:"p-8 flex flex-col items-center",children:[T,F,E]}),q[44]=T,q[45]=F,q[46]=E,q[47]=A):A=q[47],q[48]!==A||q[49]!==d?(z=(0,s.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:(0,s.jsxs)("div",{className:"bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col",children:[d,A]})}),q[48]=A,q[49]=d,q[50]=z):z=q[50],z}function k(e){let{char:t,color:a,animate:l,scale:r}=e,n=void 0===a?"slate":a,i="linear-gradient(180deg, #cbd5e1 0%, #94a3b8 100%)";return"red"===n&&(i="linear-gradient(180deg,#fca5a5,#ef4444)"),"indigo"===n&&(i="linear-gradient(180deg, #818cf8, #4f46e5)"),(0,s.jsxs)("div",{className:`relative flex items-center justify-center transition-all duration-300 ${void 0!==l&&l?"animate-bounce":""}`,style:{width:"64px",height:"74px",clipPath:"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)",background:i,transform:`scale(${void 0===r?1:r})`,boxShadow:"0 4px 6px rgba(0,0,0,0.3)"},children:[(0,s.jsx)("div",{className:"absolute inset-0 border border-white/20",style:{clipPath:"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)"}}),(0,s.jsx)("span",{className:"text-2xl font-bold text-slate-900 z-10",children:t})]})}function S(e){return Math.max(e-1,0)}function C(e){return Math.min(e+1,2)}function $(e){let a,l,r,i,c,d,o,x,m,h,f,p,u,b,g,j,N,v,w,y,_,k,S,C,$,I,R,T=(0,n.c)(57),{show:O,onClose:F,onConfirm:P,friendName:M}=e,[E,A]=(0,t.useState)("turn-based"),[z,q]=(0,t.useState)("increment"),[L,D]=(0,t.useState)(60),[U,Z]=(0,t.useState)(60);if(!O)return null;T[0]!==L||T[1]!==U||T[2]!==E||T[3]!==P||T[4]!==z?(a=()=>{P({mode:E,timeControl:z,baseTime:L,increment:U})},T[0]=L,T[1]=U,T[2]=E,T[3]=P,T[4]=z,T[5]=a):a=T[5];let B=a;T[6]===Symbol.for("react.memo_cache_sentinel")?(l=(0,s.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,s.jsx)("span",{children:"âš”ï¸"})," ç™¼èµ·æŒ‘æˆ°"]}),T[6]=l):l=T[6],T[7]!==F?(r=(0,s.jsxs)("div",{className:"p-6 border-b border-slate-800 flex justify-between items-center bg-slate-900/50",children:[l,(0,s.jsx)("button",{onClick:F,className:"text-slate-400 hover:text-white transition-colors w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-800",children:"âœ•"})]}),T[7]=F,T[8]=r):r=T[8],T[9]!==M?(i=(0,s.jsxs)("p",{className:"text-slate-300 text-center",children:["è¨­å®šèˆ‡ ",(0,s.jsx)("span",{className:"text-indigo-400 font-bold",children:M})," çš„å°æˆ°è¦å‰‡"]}),T[9]=M,T[10]=i):i=T[10],T[11]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)("label",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider",children:"å°æˆ°æ¨¡å¼"}),T[11]=c):c=T[11],T[12]===Symbol.for("react.memo_cache_sentinel")?(d=()=>A("turn-based"),T[12]=d):d=T[12];let J=`p-3 rounded-xl border-2 transition-all ${"turn-based"===E?"border-indigo-500 bg-indigo-500/20 text-white shadow-lg shadow-indigo-500/20":"border-slate-700 bg-slate-800/50 text-slate-400 hover:border-slate-600"}`;T[13]===Symbol.for("react.memo_cache_sentinel")?(o=(0,s.jsx)("div",{className:"font-bold",children:"å›åˆåˆ¶"}),x=(0,s.jsx)("div",{className:"text-xs opacity-70 mt-1",children:"ç¶“å…¸è¼ªæµå‡ºç‰Œ"}),T[13]=o,T[14]=x):(o=T[13],x=T[14]),T[15]!==J?(m=(0,s.jsxs)("button",{onClick:d,className:J,children:[o,x]}),T[15]=J,T[16]=m):m=T[16],T[17]===Symbol.for("react.memo_cache_sentinel")?(h=()=>A("rts"),T[17]=h):h=T[17];let V=`p-3 rounded-xl border-2 transition-all ${"rts"===E?"border-pink-500 bg-pink-500/20 text-white shadow-lg shadow-pink-500/20":"border-slate-700 bg-slate-800/50 text-slate-400 hover:border-slate-600"}`;T[18]===Symbol.for("react.memo_cache_sentinel")?(f=(0,s.jsx)("div",{className:"font-bold",children:"å³æ™‚åˆ¶ (RTS)"}),p=(0,s.jsx)("div",{className:"text-xs opacity-70 mt-1",children:"å¿«ç¯€å¥æ¶åœ°ç›¤"}),T[18]=f,T[19]=p):(f=T[18],p=T[19]),T[20]!==V?(u=(0,s.jsxs)("button",{onClick:h,className:V,children:[f,p]}),T[20]=V,T[21]=u):u=T[21],T[22]!==m||T[23]!==u?(b=(0,s.jsxs)("div",{className:"space-y-3",children:[c,(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[m,u]})]}),T[22]=m,T[23]=u,T[24]=b):b=T[24],T[25]===Symbol.for("react.memo_cache_sentinel")?(g=(0,s.jsx)("label",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider",children:"æ™‚é–“è¨­å®š"}),T[25]=g):g=T[25],T[26]===Symbol.for("react.memo_cache_sentinel")?(j=()=>q("unlimited"),T[26]=j):j=T[26];let G=`flex-1 py-2 rounded-md text-sm font-bold transition-all ${"unlimited"===z?"bg-slate-700 text-white shadow":"text-slate-400 hover:text-slate-200"}`;T[27]!==G?(N=(0,s.jsx)("button",{onClick:j,className:G,children:"ä¸é™æ™‚é–“"}),T[27]=G,T[28]=N):N=T[28],T[29]===Symbol.for("react.memo_cache_sentinel")?(v=()=>q("increment"),T[29]=v):v=T[29];let K=`flex-1 py-2 rounded-md text-sm font-bold transition-all ${"increment"===z?"bg-slate-700 text-white shadow":"text-slate-400 hover:text-slate-200"}`;return T[30]!==K?(w=(0,s.jsx)("button",{onClick:v,className:K,children:"åŠ ç§’åˆ¶"}),T[30]=K,T[31]=w):w=T[31],T[32]!==N||T[33]!==w?(y=(0,s.jsxs)("div",{className:"flex bg-slate-800/50 p-1 rounded-lg border border-slate-700",children:[N,w]}),T[32]=N,T[33]=w,T[34]=y):y=T[34],T[35]!==L||T[36]!==U||T[37]!==z?(_="increment"===z&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4 animate-in slide-in-from-top-2 duration-200",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs text-slate-400",children:"åŸºç¤æ™‚é–“ (ç§’)"}),(0,s.jsx)("input",{type:"number",value:L,onChange:e=>D(Math.max(10,parseInt(e.target.value)||0)),className:"w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-indigo-500 transition-colors"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs text-slate-400",children:"æ¯å›åˆåŠ ç§’ (ç§’)"}),(0,s.jsx)("input",{type:"number",value:U,onChange:e=>Z(Math.max(0,parseInt(e.target.value)||0)),className:"w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-indigo-500 transition-colors"})]})]}),T[35]=L,T[36]=U,T[37]=z,T[38]=_):_=T[38],T[39]!==y||T[40]!==_?(k=(0,s.jsxs)("div",{className:"space-y-3",children:[g,y,_]}),T[39]=y,T[40]=_,T[41]=k):k=T[41],T[42]!==b||T[43]!==k||T[44]!==i?(S=(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[i,b,k]}),T[42]=b,T[43]=k,T[44]=i,T[45]=S):S=T[45],T[46]!==F?(C=(0,s.jsx)("button",{onClick:F,className:"flex-1 py-3 rounded-xl font-bold text-slate-400 hover:bg-slate-800 transition-colors",children:"å–æ¶ˆ"}),T[46]=F,T[47]=C):C=T[47],T[48]!==B?($=(0,s.jsx)("button",{onClick:B,className:"flex-1 py-3 rounded-xl font-bold text-white bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-500 hover:to-blue-500 shadow-lg shadow-indigo-500/20 transition-all active:scale-95",children:"ç™¼é€é‚€è«‹"}),T[48]=B,T[49]=$):$=T[49],T[50]!==C||T[51]!==$?(I=(0,s.jsxs)("div",{className:"p-6 border-t border-slate-800 bg-slate-900/50 flex gap-3",children:[C,$]}),T[50]=C,T[51]=$,T[52]=I):I=T[52],T[53]!==S||T[54]!==r||T[55]!==I?(R=(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-slate-900 border border-slate-700 rounded-2xl w-full max-w-md shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[r,S,I]})}),T[53]=S,T[54]=r,T[55]=I,T[56]=R):R=T[56],R}function I(){let e=(0,a.useRouter)(),[n,c]=(0,t.useState)(!0),[p,j]=(0,t.useState)(null),[N,w]=(0,t.useState)(!1),[y,k]=(0,t.useState)(!1),[S,C]=(0,t.useState)(!1),[I,R]=(0,t.useState)(!1),[T,O]=(0,t.useState)(!1),[F,P]=(0,t.useState)(!1),[M,E]=(0,t.useState)(!1),[A,z]=(0,t.useState)(!1),[q,L]=(0,t.useState)([]),[D,U]=(0,t.useState)([]),[Z,B]=(0,t.useState)([]),[J,V]=(0,t.useState)([]),[G,K]=(0,t.useState)(null),[H,W]=(0,t.useState)(null),[Q,X]=(0,t.useState)(null),[Y,ee]=(0,t.useState)(!1),[es,et]=(0,t.useState)(null),[ea,el]=(0,t.useState)(null),[er,en]=(0,t.useState)(null),[ei,ec]=(0,t.useState)(null),ed=p?.avatar_url||r.AVATAR_OPTIONS[0];async function eo(e){if(Q)try{let s=await (0,l.api)(`/api/friends/invite-battle/${Q.id}`,{method:"POST",body:JSON.stringify({settings:e})});if(s.ok)alert("å·²ç™¼é€ç´„æˆ°é‚€è«‹ï¼"),z(!1),X(null);else{let e=await s.json();alert(e.error||"ç™¼é€é‚€è«‹å¤±æ•—")}}catch(e){console.error("Challenge error:",e)}}async function ex(s){try{let t=await (0,l.api)(`/api/friends/accept-battle-invite/${s}`,{method:"POST"});if(t.ok){let s=await t.json();e.push(`/battle?id=${s.battleId}`)}else alert("æ¥å—é‚€è«‹å¤±æ•—")}catch(e){console.error("Accept invite error:",e)}}async function em(e){try{await (0,l.api)(`/api/friends/reject-battle-invite/${e}`,{method:"POST"}),V(s=>s.filter(s=>s.id!==e))}catch(e){console.error("Reject invite error:",e)}}async function eh(){try{localStorage.getItem("token")&&await (0,l.api)("/api/users/logout",{method:"POST"})}catch(e){console.error("Logout error:",e)}finally{localStorage.removeItem("token"),localStorage.removeItem("user"),e.replace("/")}}function ef(e){j(e),localStorage.setItem("user",JSON.stringify(e))}async function ep(e){try{let s=await (0,l.api)(`/api/friends/user/${e}`);s.ok&&(K(await s.json()),C(!0))}catch(e){console.error("Failed to fetch user detail:",e)}}async function eu(e){try{let s=await (0,l.api)(`/api/friends/add-friend/${e}`,{method:"POST"});if(s.ok){alert("å¥½å‹è«‹æ±‚å·²ç™¼é€ï¼");let e=await (0,l.api)("/api/friends/online-users");e.ok&&U(await e.json())}else{let e=await s.json();alert(e.error||"ç™¼é€å¤±æ•—")}}catch(e){console.error("Failed to send friend request:",e)}}async function eb(e){try{if((await (0,l.api)(`/api/friends/accept-friend/${e}`,{method:"POST"})).ok){let[e,s,t]=await Promise.all([(0,l.api)("/api/friends/my-friends"),(0,l.api)("/api/friends/pending-requests"),(0,l.api)("/api/friends/online-users")]);e.ok&&L(await e.json()),s.ok&&B(await s.json()),t.ok&&U(await t.json())}}catch(e){console.error("Failed to accept friend request:",e)}}async function eg(e){try{if((await (0,l.api)(`/api/friends/reject-friend/${e}`,{method:"DELETE"})).ok){let e=await (0,l.api)("/api/friends/pending-requests");e.ok&&B(await e.json())}}catch(e){console.error("Failed to reject friend request:",e)}}async function ej(e){if(confirm("ç¢ºå®šè¦åˆªé™¤é€™ä½å¥½å‹å—ï¼Ÿ"))try{if((await (0,l.api)(`/api/friends/remove-friend/${e}`,{method:"DELETE"})).ok){let s=await (0,l.api)("/api/friends/my-friends");s.ok&&L(await s.json()),H&&H.id===e&&(O(!1),W(null))}}catch(e){console.error("Failed to remove friend:",e)}}async function eN(s){try{let t;ee(!0),et(s),el("waiting");let a=await (0,l.api)("/api/matchmaking/queue/join",{method:"POST",body:JSON.stringify({mode:s})});if(!a.ok)throw Error("Failed to join queue");let r=await a.json();"matched"===r.status?(el("matched"),en(r.battleId),ec(r.opponent),setTimeout(()=>e.push(`/battle?id=${r.battleId}`),3e3)):(t=setInterval(async()=>{try{let s=await (0,l.api)("/api/matchmaking/queue/status");if(!s.ok)return void clearInterval(t);let a=await s.json();"matched"===a.status&&(clearInterval(t),el("matched"),en(a.battleId),ec(a.opponent),setTimeout(()=>e.push(`/battle?id=${a.battleId}`),3e3))}catch(e){console.error("Error polling match status:",e),clearInterval(t)}},2e3),window.matchPollInterval=t)}catch(e){console.error("Failed to start matching:",e),ee(!1),et(null),el(null),alert("åŒ¹é…å¤±æ•—ï¼Œè«‹é‡è©¦")}}async function ev(){try{await (0,l.api)("/api/matchmaking/queue/leave",{method:"POST"}),window.matchPollInterval&&clearInterval(window.matchPollInterval),ee(!1),et(null),el(null)}catch(e){console.error("Failed to cancel matching:",e)}}async function ew(e){try{if((await (0,l.api)(`/api/friends/add-friend/${e}`,{method:"POST"})).ok){alert("å¥½å‹è«‹æ±‚å·²ç™¼é€ï¼");let s=await (0,l.api)("/api/friends/pending-requests");s.ok&&B(await s.json()),G&&G.id===e&&ep(e)}}catch(e){console.error("Failed to add friend:",e)}}return(0,t.useEffect)(()=>{if(localStorage.getItem("token")){let e=localStorage.getItem("user");e&&j(JSON.parse(e)),(0,l.api)("/api/users/me").then(e=>{if(e.ok)return e.json();throw Error("Failed to fetch user")}).then(e=>{j(e),localStorage.setItem("user",JSON.stringify(e))}).catch(e=>{console.error(e)}).finally(()=>{c(!1)})}else e.replace("/")},[e]),(0,t.useEffect)(()=>{if(!localStorage.getItem("token"))return;(0,l.api)("/api/friends/ping",{method:"POST"});let e=setInterval(()=>{(0,l.api)("/api/friends/ping",{method:"POST"})},2e4);return()=>clearInterval(e)},[]),(0,t.useEffect)(()=>{if(!p)return;async function e(){try{let[e,s,t,a]=await Promise.all([(0,l.api)("/api/friends/my-friends"),(0,l.api)("/api/friends/online-users"),(0,l.api)("/api/friends/pending-requests"),(0,l.api)("/api/friends/battle-invites")]);e.ok&&L(await e.json()),s.ok&&U(await s.json()),t.ok&&B(await t.json()),a.ok&&V(await a.json())}catch(e){console.error("Failed to load friends and users:",e)}}e();let s=setInterval(e,3e4);return()=>clearInterval(s)},[p]),n?(0,s.jsx)("div",{className:"min-h-screen bg-[#0f172a] flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):(0,s.jsxs)("div",{className:"flex flex-col h-screen bg-[#0f172a] text-slate-200 overflow-hidden",children:[(0,s.jsx)(i,{friendRequestsCount:Z.length+J.length,showFriendRequests:I,setShowFriendRequests:R,handleLogout:eh,onOpenLeaderboard:()=>P(!0),onOpenTutorial:()=>E(!0)}),(0,s.jsxs)("main",{className:"flex flex-1 overflow-hidden",children:[(0,s.jsx)(d,{user:p,selectedAvatar:ed,setShowAvatarPicker:w,openProfileEdit:function(){k(!0)},startMatching:eN,isMatching:Y}),(0,s.jsx)(x,{user:p}),(0,s.jsx)(o,{friends:q,onlineUsers:D,openChat:function(e){W(e),O(!0)},viewUserDetail:ep,removeFriend:ej,sendFriendRequest:eu})]}),(0,s.jsx)(m,{showAvatarPicker:N,setShowAvatarPicker:w,currentAvatar:ed,onUpdate:ef}),(0,s.jsx)(h,{showProfileEdit:y,setShowProfileEdit:k,user:p,onUpdate:ef}),(0,s.jsx)(f,{showUserDetail:S,setShowUserDetail:C,selectedUser:G,addFriend:ew,removeFriend:ej,onChallenge:function(e){let s=q.find(s=>s.id===e)||D.find(s=>s.id===e)||(G&&G.id===e?G:null);s?X(s):X({id:e,username:"Unknown"}),z(!0)}}),(0,s.jsx)(u,{showFriendRequests:I,setShowFriendRequests:R,friendRequests:Z,acceptFriendRequest:eb,rejectFriendRequest:eg,battleInvites:J,acceptBattleInvite:ex,rejectBattleInvite:em}),(0,s.jsx)(b,{showChat:T,setShowChat:O,chatFriend:H,user:p}),(0,s.jsx)(g,{isMatching:Y,matchStatus:ea,matchMode:es,cancelMatching:ev,opponent:ei}),(0,s.jsx)(v,{show:F,onClose:()=>P(!1)}),(0,s.jsx)(_,{show:M,onClose:()=>E(!1)}),(0,s.jsx)($,{show:A,onClose:()=>z(!1),onConfirm:eo,friendName:Q?.username||"Friend"})]})}e.s(["default",()=>I],15452)}]);