(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,o)=>{t.exports=e.r(76562)},54858,e=>{"use strict";async function t(e,o={}){let a=localStorage.getItem("token"),l={"Content-Type":"application/json",...o.headers};a&&(l.Authorization=`Bearer ${a}`);let r=e.startsWith("/")?e:`/${e}`,n=await fetch(`https://zhuyin-battle.marmot0814.com${r}`,{...o,headers:l});return(401===n.status||403===n.status)&&(localStorage.removeItem("token"),localStorage.removeItem("user"),"/"!==window.location.pathname&&"/lobby"!==window.location.pathname&&(window.location.href="/")),n}e.s(["api",()=>t])},31713,e=>{"use strict";var t=e.i(43476),o=e.i(932),a=e.i(71645),l=e.i(93936),r=e.i(18566),n=e.i(54858);function i(e){let l,r,n,i,c,m,h,u=(0,o.c)(17),{text:g,phoneticMap:d,phoneticDelay:f,charDelay:p,className:x}=e;u[0]!==d?(l=void 0===d?{}:d,u[0]=d,u[1]=l):l=u[1];let b=l,y=void 0===f?600:f,w=void 0===p?40:p;u[2]===Symbol.for("react.memo_cache_sentinel")?(r=[],u[2]=r):r=u[2];let[j,S]=(0,a.useState)(r),[v,N]=(0,a.useState)(!0);u[3]!==w||u[4]!==y||u[5]!==b||u[6]!==g?(n=()=>{let e=!0;S([]),async function(){for(let t=0;t<g.length&&e;t++){let e=g.charAt(t),o=b[e];o?(S(e=>[...e,o]),await new Promise(e=>setTimeout(e,y)),S(t=>{let o=[...t];return o[o.length-1]=e,o})):S(t=>[...t,e]),await new Promise(e=>setTimeout(e,w))}}();let t=setInterval(()=>N(s),500);return()=>{e=!1,clearInterval(t)}},i=[g,b,y,w],u[3]=w,u[4]=y,u[5]=b,u[6]=g,u[7]=n,u[8]=i):(n=u[7],i=u[8]),(0,a.useEffect)(n,i),u[9]!==j?(c=j.join(""),u[9]=j,u[10]=c):c=u[10];let k=v?"inline-block ml-1 text-indigo-300":"inline-block ml-1 text-transparent";return u[11]!==k?(m=(0,t.jsx)("span",{className:k,children:"|"}),u[11]=k,u[12]=m):m=u[12],u[13]!==x||u[14]!==c||u[15]!==m?(h=(0,t.jsxs)("p",{className:x,children:[c,m]}),u[13]=x,u[14]=c,u[15]=m,u[16]=h):h=u[16],h}function s(e){return!e}function c(){let e,s,c,h,u,g,d,f,p,x=(0,o.c)(14);x[0]===Symbol.for("react.memo_cache_sentinel")?(e={注:"ㄓㄨˋ",音:"ㄧㄣ",對:"ㄉㄨㄟˋ",戰:"ㄓㄢˋ",與:"ㄩˇ",世:"ㄕˋ",界:"ㄐㄧㄝˋ",各:"ㄍㄜˋ",地:"ㄉㄧˋ",玩:"ㄨㄢˊ",家:"ㄐㄧㄚ",一:"ㄧ",較:"ㄐㄧㄠˋ",高:"ㄍㄠ",下:"ㄒㄧㄚˋ",成:"ㄔㄥˊ",為:"ㄨㄟˊ",大:"ㄉㄚˋ",師:"ㄕ"},x[0]=e):e=x[0];let b=e,y=(0,r.useRouter)(),[w,j]=(0,a.useState)(!0);x[1]!==y?(s=()=>{localStorage.getItem("token")?y.replace("/lobby"):j(!1)},c=[y],x[1]=y,x[2]=s,x[3]=c):(s=x[2],c=x[3]),(0,a.useEffect)(s,c),x[4]!==y?(h={onSuccess:async e=>{try{let t=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${e.access_token}`}}),o=await t.json(),a=await (0,n.api)("/api/users/google-login",{method:"POST",body:JSON.stringify({googleUser:o})}),l=await a.json();l.needsCharacterCreation?(localStorage.setItem("pendingEmail",l.email),y.replace("/create-character")):l.token?(localStorage.setItem("token",l.token),localStorage.setItem("user",JSON.stringify(l.user)),y.replace("/lobby")):(console.error("Login failed:",l.error),alert("登入失敗，請稍後再試"))}catch(e){console.error("Login Failed:",e),alert("登入失敗，請稍後再試")}},onError:m},x[4]=y,x[5]=h):h=x[5];let S=(0,l.useGoogleLogin)(h);if(w){let e;return x[6]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("div",{className:"min-h-screen bg-[#0f172a] flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}),x[6]=e):e=x[6],e}return x[7]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsxs)("h1",{className:"text-6xl font-black text-white tracking-tighter italic",children:["注音 ",(0,t.jsx)("span",{className:"text-indigo-500",children:"對戰"})]}),g=(0,t.jsx)(i,{text:"注音對戰！與世界各地玩家一較高下，成為注音大師！",phoneticMap:b,phoneticDelay:100,charDelay:150,className:"text-slate-400 text-lg"}),x[7]=u,x[8]=g):(u=x[7],g=x[8]),x[9]!==S?(d=()=>S(),x[9]=S,x[10]=d):d=x[10],x[11]===Symbol.for("react.memo_cache_sentinel")?(f=(0,t.jsx)("img",{src:"https://www.google.com/favicon.ico",className:"w-6 h-6",alt:"google"}),x[11]=f):f=x[11],x[12]!==d?(p=(0,t.jsx)("main",{className:"min-h-screen bg-[#0f172a] flex flex-col items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"text-center space-y-6",children:[u,g,(0,t.jsx)("div",{className:"mt-8 flex justify-center",children:(0,t.jsxs)("button",{onClick:d,className:"flex items-center gap-3 bg-white hover:bg-slate-100 text-slate-900 px-8 py-4 rounded-2xl font-bold text-xl transition-all active:scale-95 shadow-2xl",children:[f,"使用 Google 帳號登入"]})})]})}),x[12]=d,x[13]=p):p=x[13],p}function m(e){console.error("Google Login Error:",e),alert("Google 登入失敗")}e.s(["default",()=>c])}]);