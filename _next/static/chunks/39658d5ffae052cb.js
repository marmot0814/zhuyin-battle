(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,l)=>{t.exports=e.r(76562)},54858,e=>{"use strict";async function t(e,l={}){let r=localStorage.getItem("token"),a={"Content-Type":"application/json",...l.headers};r&&(a.Authorization=`Bearer ${r}`);let o=e.startsWith("/")?e:`/${e}`,s=await fetch(`https://zhuyin-battle.marmot0814.com${o}`,{...l,headers:a});return(401===s.status||403===s.status)&&(localStorage.removeItem("token"),localStorage.removeItem("user"),"/"!==window.location.pathname&&"/lobby"!==window.location.pathname&&(window.location.href="/")),s}e.s(["api",()=>t])},60576,e=>{"use strict";var t=e.i(43476),l=e.i(71645),r=e.i(18566),a=e.i(54858);function o(){let e=(0,r.useRouter)(),[o,s]=(0,l.useState)(""),[i,n]=(0,l.useState)(""),[c,d]=(0,l.useState)(""),[h,m]=(0,l.useState)(0),[u,x]=(0,l.useState)(!1),[b,g]=(0,l.useState)(!1),p=Array.from({length:100},(e,t)=>t);(0,l.useEffect)(()=>{let t=localStorage.getItem("pendingEmail");t?(s(t),m(Math.floor(100*Math.random()))):e.replace("/")},[e]);let w=e=>`https://api.dicebear.com/7.x/avataaars/svg?seed=${e}`,f=async()=>{if(!i.trim())return void alert("請輸入角色名稱");if(i.length>20)return void alert("角色名稱不能超過 20 個字元");if(c.length>100)return void alert("自我介紹不能超過 100 個字元");g(!0);try{let t=await (0,a.api)("/api/users/create-character",{method:"POST",body:JSON.stringify({email:o,username:i.trim(),avatar_url:w(h),bio:c.trim()})}),l=await t.json();l.token?(localStorage.setItem("token",l.token),localStorage.setItem("user",JSON.stringify(l.user)),localStorage.removeItem("pendingEmail"),e.replace("/lobby")):(alert(l.error||"創建角色失敗，請稍後再試"),g(!1))}catch(e){console.error("Create character error:",e),alert("創建角色失敗，請稍後再試"),g(!1)}};return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-8 max-w-2xl w-full shadow-2xl border border-white/20",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-white mb-2 text-center",children:"創建你的角色"}),(0,t.jsx)("p",{className:"text-white/70 text-center mb-8",children:"設定你的名字、頭貼和自我介紹"}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-white font-semibold mb-3",children:"頭貼"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("img",{src:w(h),alt:"Avatar",className:"w-24 h-24 rounded-full bg-white/20 border-4 border-white/30"}),(0,t.jsx)("button",{onClick:()=>x(!u),className:"px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold transition-colors",children:u?"收起頭貼選單":"選擇頭貼"})]}),u&&(0,t.jsx)("div",{className:"mt-4 bg-white/5 rounded-xl p-4 max-h-96 overflow-y-auto",children:(0,t.jsx)("div",{className:"grid grid-cols-8 gap-3",children:p.map(e=>(0,t.jsx)("button",{onClick:()=>{m(e),x(!1)},className:`w-12 h-12 rounded-full transition-all hover:scale-110 ${h===e?"ring-4 ring-yellow-400 scale-110":"ring-2 ring-white/20"}`,children:(0,t.jsx)("img",{src:w(e),alt:`Avatar ${e}`,className:"w-full h-full rounded-full"})},e))})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-white font-semibold mb-2",children:["角色名稱 ",(0,t.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:i,onChange:e=>n(e.target.value),placeholder:"輸入你的角色名稱",maxLength:20,className:"w-full px-4 py-3 bg-white/10 border border-white/30 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,t.jsxs)("div",{className:"text-right text-white/50 text-sm mt-1",children:[i.length,"/20"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-white font-semibold mb-2",children:"自我介紹"}),(0,t.jsx)("textarea",{value:c,onChange:e=>d(e.target.value),placeholder:"介紹一下自己吧...",maxLength:100,rows:3,className:"w-full px-4 py-3 bg-white/10 border border-white/30 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 resize-none"}),(0,t.jsxs)("div",{className:"text-right text-white/50 text-sm mt-1",children:[c.length,"/100"]})]}),(0,t.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,t.jsx)("button",{onClick:()=>{localStorage.removeItem("pendingEmail"),e.replace("/")},className:"flex-1 px-6 py-4 bg-white/10 hover:bg-white/20 text-white rounded-lg font-semibold transition-colors border border-white/30",disabled:b,children:"取消"}),(0,t.jsx)("button",{onClick:f,disabled:b||!i.trim(),className:"flex-1 px-6 py-4 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white rounded-lg font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:b?"創建中...":"完成創建"})]})]})]})})}e.s(["default",()=>o])}]);